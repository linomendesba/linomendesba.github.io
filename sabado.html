<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deep Analytics Pro</title>

<style>
:root {
    --bg-main:#1c1f26;
    --bg-card:#252a33;
    --border:#3d4452;
    --accent:#1fac89;
    --text:#e0e0e0;
    --text-dim:#888;
    --danger:#ff4444;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
    background:var(--bg-main);
    color:var(--text);
    font-family:Consolas, monospace;
    padding:20px
}

.container{max-width:1400px;margin:auto}

/* ===================== */
/* REMO√á√ÉO TOTAL DE ZOOM */
/* ===================== */

.stat-card:hover,
.card:hover,
.btn-liga:hover,
.chart-bar:hover,
.sequence-dot:hover,
.comparison-item:hover,
.heatmap-cell:hover,
.suggestion-item:hover,
.target-item:hover{
    transform:none!important;
}

.chart-bar:hover{opacity:.85}
.sequence-dot:hover,
.heatmap-cell:hover{filter:brightness(1.1)}

/* ===================== */

.stats-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:15px;margin-bottom:20px
}

.stat-card{
    background:var(--bg-card);
    border:1px solid var(--border);
    border-radius:8px;
    padding:18px;
    text-align:center
}

.stat-label{font-size:.7rem;color:var(--text-dim)}
.stat-value{font-size:1.8rem;color:var(--accent);font-weight:bold}

#menu{display:flex;gap:10px;margin-bottom:20px}
.btn-liga{
    flex:1;
    background:#2d343e;
    color:#aaa;
    border:none;
    padding:12px;
    border-radius:6px;
    cursor:pointer
}
.btn-liga.active{background:var(--accent);color:#0f1a16;font-weight:bold}

.controls{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:15px;
    background:var(--bg-card);
    padding:15px;
    border-radius:8px;
    margin-bottom:20px
}

select,input{
    background:var(--bg-main);
    border:1px solid var(--border);
    color:#fff;
    padding:10px;
    border-radius:6px
}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.card{
    background:var(--bg-card);
    border:1px solid var(--border);
    border-radius:8px;
    padding:20px
}
.card.full-width{grid-column:1/-1}

h2{
    font-size:.9rem;
    text-transform:uppercase;
    color:var(--accent);
    border-bottom:1px solid var(--border);
    padding-bottom:10px;
    margin-bottom:15px;
    text-align:center
}

/* ======= GR√ÅFICO ======= */
.chart-container{
    height:220px;
    display:flex;
    align-items:flex-end;
    gap:4px;
    background:var(--bg-main);
    padding:15px;
    border-radius:6px
}

.chart-bar{
    flex:1;
    background:linear-gradient(to top,var(--accent),#2cd9b3);
    border-radius:4px 4px 0 0;
    min-height:20px;
    position:relative
}

.chart-bar-label{
    position:absolute;
    bottom:-20px;
    font-size:.65rem;
    color:var(--text-dim);
    left:50%;
    transform:translateX(-50%)
}

.chart-bar-value{
    position:absolute;
    top:-18px;
    font-size:.65rem;
    color:var(--accent);
    font-weight:bold;
    left:50%;
    transform:translateX(-50%)
}

@media(max-width:1000px){
    .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="container">

<div class="stats-grid">
    <div class="stat-card"><div class="stat-label">Jogos</div><div id="stat-total" class="stat-value">0</div></div>
    <div class="stat-card"><div class="stat-label">Taxa</div><div id="stat-taxa" class="stat-value">0%</div></div>
    <div class="stat-card"><div class="stat-label">Melhor Hora</div><div id="stat-horario" class="stat-value">--</div></div>
</div>

<div id="menu"></div>

<div class="controls">
    <select id="select-mercado" onchange="carregar()">
        <option value="over2_5" selected>Over 2.5</option>
        <option value="under2_5">Under 2.5</option>
        <option value="ambasMarcam">Ambas Sim</option>
    </select>

    <select id="select-horas" onchange="carregar()">
        <option value="12">√öltimas 12h</option>
        <option value="24" selected>√öltimas 24h</option>
        <option value="48">√öltimas 48h</option>
    </select>
</div>

<div class="card full-width">
    <h2>üìà Tend√™ncia por Hor√°rio (<span id="grafico-periodo"></span>)</h2>
    <div id="chart-container" class="chart-container"></div>
</div>

</div>

<script>
const API="https://betstat.site";
const LIGAS=["Ta√ßa Gl√≥ria Eterna","Copa Am√©rica","Euro"];
let ligaAtual=LIGAS[0];

const REGRAS={
    over2_5:g=>(g[0]+g[1])>2.5,
    under2_5:g=>(g[0]+g[1])<2.5,
    ambasMarcam:g=>g[0]>0&&g[1]>0
};

async function carregar(){
    const mercado=document.getElementById("select-mercado").value;
    const horas=parseInt(document.getElementById("select-horas").value);
    document.getElementById("grafico-periodo").innerText=horas+"h";

    const res=await fetch(API+"/resultados/"+encodeURIComponent(ligaAtual));
    const dados=await res.json();

    atualizarGrafico(dados,mercado,horas);
}

/* ===== GR√ÅFICO CORRETO POR DATA + HORA ===== */
function atualizarGrafico(dados,mercadoKey,horasLimit){
    const c=document.getElementById("chart-container");
    c.innerHTML="";

    const agora=new Date();
    const intervalos=[];

    for(let i=horasLimit-1;i>=0;i--){
        const d=new Date(agora.getTime()-i*3600000);
        const ini=new Date(d);ini.setMinutes(0,0,0);
        const fim=new Date(d);fim.setMinutes(59,59,999);

        intervalos.push({
            label:d.getHours()+"h",
            ini,fim,total:0,greens:0
        });
    }

    dados.forEach(j=>{
        const dj=new Date(j.data);
        intervalos.forEach(int=>{
            if(dj>=int.ini&&dj<=int.fim){
                int.total++;
                const g=j.ft.split(" x ").map(Number);
                if(REGRAS[mercadoKey](g))int.greens++;
            }
        });
    });

    intervalos.forEach(int=>{
        const p=int.total?int.greens/int.total*100:0;
        const bar=document.createElement("div");
        bar.className="chart-bar";
        bar.style.height=Math.max(p*1.5,20)+"px";
        bar.innerHTML=`<span class="chart-bar-value">${p.toFixed(0)}%</span>
                       <span class="chart-bar-label">${int.label}</span>`;
        c.appendChild(bar);
    });
}

/* MENU */
const menu=document.getElementById("menu");
LIGAS.forEach(l=>{
    const b=document.createElement("button");
    b.className="btn-liga"+(l===ligaAtual?" active":"");
    b.innerText=l;
    b.onclick=()=>{ligaAtual=l;document.querySelectorAll(".btn-liga").forEach(x=>x.classList.remove("active"));b.classList.add("active");carregar();}
    menu.appendChild(b);
});

carregar();
</script>
</body>
</html>
