<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Deep Analytics - Virtual Pro</title>
    <style>
        body { background: #1c1f26; color: #e0e0e0; font-family: 'Consolas', monospace; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #252a33; border: 1px solid #3d4452; border-radius: 4px; padding: 20px; }
        
        /* Indicador de Sa√∫de da Liga */
        .gauge-container { text-align: center; padding: 20px; }
        .gauge-bar { height: 20px; background: #121418; border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .gauge-fill { height: 100%; width: 50%; transition: 1s; }
        
        /* Lista de Alvos */
        .target-item { border-left: 4px solid #ff9000; background: #1c1f26; margin-bottom: 10px; padding: 10px; }
        .tag { font-size: 0.7em; padding: 2px 5px; border-radius: 3px; background: #3d4452; color: #ff9000; }
        
        .btn-liga { background: #2d343e; color: #888; border: none; padding: 10px; cursor: pointer; margin-right: 5px; }
        .btn-liga.active { background: #ff9000; color: #000; font-weight: bold; }
        h2 { font-size: 1rem; color: #ff9000; text-transform: uppercase; border-bottom: 1px solid #3d4452; padding-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div id="menu" style="margin-bottom: 20px;"></div>

    <div class="grid">
        <div class="card">
            <h2>üìä Term√¥metro de Pagamento (√öltimos 20)</h2>
            <div class="gauge-container">
                <div id="status-text" style="font-size: 1.2em; font-weight: bold;">ANALISANDO...</div>
                <div class="gauge-bar">
                    <div id="gauge-fill" class="gauge-fill"></div>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 0.8em; color: #888;">
                    <span>SEGURANDO (UNDER)</span>
                    <span>PAGANDO (OVER)</span>
                </div>
            </div>
            <p style="font-size: 0.8em; color: #666;">Se o term√¥metro estiver muito na direita, a liga vai "fechar" em breve. Se estiver na esquerda, a "chuva de gols" est√° vindo.</p>
        </div>

        <div class="card">
            <h2>üéØ Alvos: Recupera√ß√£o de Favoritos</h2>
            <div id="alvos-list"></div>
        </div>
    </div>
</div>

<script>
const LIGAS = ["Ta√ßa Gl√≥ria Eterna", "Copa Am√©rica", "Euro", "Campeonato Italiano", "Copa das Estrelas", "Brasileir√£o Betano"];
let ligaAtual = LIGAS[0];
const API = "https://betstat.site";

async function carregar() {
    const url = encodeURIComponent(ligaAtual);
    const [prox, odds, res] = await Promise.all([
        fetch(`${API}/proximos/${url}`).then(r => r.json()),
        fetch(`${API}/odds/${url}`).then(r => r.json()),
        fetch(`${API}/resultados/${url}`).then(r => r.json())
    ]);

    // 1. L√ìGICA DO TERM√îMETRO (An√°lise de Ciclo Econ√¥mico)
    const ultimos20 = res.slice(0, 20);
    const overs = ultimos20.filter(j => {
        const g = j.ft.split(' x ').map(Number);
        return (g[0]+g[1]) > 2.5;
    }).length;

    const percentual = (overs / 20) * 100;
    const fill = document.getElementById('gauge-fill');
    const txt = document.getElementById('status-text');
    
    fill.style.width = percentual + '%';
    if(percentual > 60) {
        fill.style.background = '#ff4444';
        txt.innerText = "LIGA SATURADA (RISCO DE UNDER)";
    } else if(percentual < 40) {
        fill.style.background = '#00ff88';
        txt.innerText = "LIGA COMPRIMIDA (CHANCE DE OVER)";
    } else {
        fill.style.background = '#ff9000';
        txt.innerText = "LIGA EST√ÅVEL";
    }

    // 2. L√ìGICA DE ALVOS (Times grandes que "devem" gols)
    const lista = document.getElementById('alvos-list');
    lista.innerHTML = '';
    
    prox.slice(0, 4).forEach(jogo => {
        const odd = odds.find(o => o.match_id == jogo.event_id);
        if(!odd) return;

        // Se o time de casa tem odd de favorito mas n√£o marcou nos √∫ltimos 2 jogos
        const ultimosCasa = res.filter(r => r.time_a === jogo.team_home || r.time_b === jogo.team_home).slice(0, 2);
        const marcou = ultimosCasa.some(r => {
            const g = r.ft.split(' x ').map(Number);
            return (r.time_a === jogo.team_home && g[0] > 0) || (r.time_b === jogo.team_home && g[1] > 0);
        });

        if(!marcou && parseFloat(odd.odds_casa_vence) < 2.0) {
            lista.innerHTML += `
                <div class="target-item">
                    <span class="tag">RECUPERA√á√ÉO DE GOL</span>
                    <div style="margin: 5px 0;"><strong>${jogo.team_home}</strong> vs ${jogo.team_visit}</div>
                    <div style="font-size: 0.8em; color: #888;">Odd Casa: ${odd.odds_casa_vence} | Time seco h√° 2 jogos</div>
                </div>
            `;
        }
    });
    if(lista.innerHTML === '') lista.innerHTML = "Aguardando anomalias de mercado...";
}

// Menu e Init
const menu = document.getElementById('menu');
LIGAS.forEach(l => {
    const b = document.createElement('button');
    b.className = `btn-liga ${l === ligaAtual ? 'active' : ''}`;
    b.innerText = l;
    b.onclick = () => {
        document.querySelectorAll('.btn-liga').forEach(x => x.classList.remove('active'));
        b.classList.add('active');
        ligaAtual = l;
        carregar();
    };
    menu.appendChild(b);
});
setInterval(carregar, 30000);
carregar();
</script>
</body>
</html>