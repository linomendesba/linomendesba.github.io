<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Sniper Virtual - Betano</title>
    <style>
        :root {
            --bg: #1c1f26; --card: #252a33; --accent: #ff9000;
            --green: #00ff88; --red: #ff4444; --text: #e0e0e0;
        }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
        
        /* Menu e Filtros */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .btn-liga { background: #2d343e; border: none; color: #888; padding: 10px 18px; border-radius: 6px; cursor: pointer; transition: 0.3s; }
        .btn-liga.active { background: var(--accent); color: #000; font-weight: bold; }

        /* Grade Principal */
        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; border: 1px solid #2d343e; }

        /* Ideia 3: Tabela de Minutos */
        .minuto-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 5px; }
        .minuto-cell { background: #1c1f26; padding: 10px 5px; text-align: center; border-radius: 4px; font-size: 0.8em; border: 1px solid #3d4452; }
        .minuto-cell.hot { background: rgba(0, 255, 136, 0.2); border-color: var(--green); color: var(--green); }

        /* Ideia 2: Sniper de Zebra */
        .zebra-card { background: #121418; padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid var(--red); }
        .zebra-card.high-value { border-left-color: var(--green); }
        .zebra-badge { float: right; font-size: 0.7em; padding: 3px 7px; border-radius: 3px; background: #3d4452; }

        h2 { font-size: 1.1em; color: var(--accent); margin-top: 0; display: flex; align-items: center; gap: 10px; }
    </style>
</head>
<body>

<div class="header">
    <h1>SNIPER <span style="color:var(--accent)">VIRTUAL</span></h1>
    <div id="menu-ligas" style="display: flex; gap: 5px;"></div>
</div>

<div class="main-grid">
    <div class="card">
        <h2>ðŸ•’ JANELAS DE PAGAMENTO (Ãšltima 1h)</h2>
        <p style="font-size: 0.8em; color: #888; margin-bottom: 15px;">FrequÃªncia de Over 2.5 por minuto final do jogo.</p>
        <div class="minuto-grid" id="grid-minutos">
            </div>
    </div>

    <div class="card">
        <h2>ðŸŽ¯ SNIPER: GAP DE VALOR (ODDS VS REALIDADE)</h2>
        <div id="zebra-list">
            </div>
    </div>
</div>

<script>
const LIGAS = ["TaÃ§a GlÃ³ria Eterna", "Copa AmÃ©rica", "Euro", "Campeonato Italiano", "Copa das Estrelas", "BrasileirÃ£o Betano"];
let ligaAtual = LIGAS[0];
const API = "https://betstat.site";

async function atualizar() {
    try {
        const url = encodeURIComponent(ligaAtual);
        const [prox, odds, res] = await Promise.all([
            fetch(`${API}/proximos/${url}`).then(r => r.json()),
            fetch(`${API}/odds/${url}`).then(r => r.json()),
            fetch(`${API}/resultados/${url}`).then(r => r.json())
        ]);

        const resultadosInvertidos = [...res].reverse();

        // --- LÃ“GICA 3: MINUTOS DE OURO ---
        const contagemMinutos = {};
        resultadosInvertidos.slice(0, 20).forEach(j => {
            const placar = j.ft.split(' x ').map(Number);
            const totalGols = placar[0] + placar[1];
            if(totalGols > 2.5) {
                const min = j.minuto.toString().padStart(2, '0');
                contagemMinutos[min] = (contagemMinutos[min] || 0) + 1;
            }
        });

        const gridMin = document.getElementById('grid-minutos');
        gridMin.innerHTML = '';
        // Criar lista de minutos padrÃ£o do virtual (de 3 em 3 geralmente)
        for(let i=1; i<60; i+=3) {
            const m = i.toString().padStart(2, '0');
            const freq = contagemMinutos[m] || 0;
            gridMin.innerHTML += `<div class="minuto-cell ${freq > 1 ? 'hot' : ''}">:${m}<br><b>${freq}x</b></div>`;
        }

        // --- LÃ“GICA 2: FAVORITO FALSO ---
        const zebraList = document.getElementById('zebra-list');
        zebraList.innerHTML = '';

        prox.slice(0, 4).forEach(jogo => {
            const odd = odds.find(o => o.match_id == jogo.event_id || o.horario == jogo.time);
            if(!odd) return;

            const oddCasa = parseFloat(odd.odds_casa_vence);
            // Se o time da casa Ã© muito favorito nas odds (< 1.80)
            if(oddCasa < 1.80) {
                // Analisa os Ãºltimos 3 jogos deste time na rota de resultados
                const ultimosDoTime = resultadosInvertidos.filter(r => r.time_a === jogo.team_home || r.time_b === jogo.team_home).slice(0, 3);
                const vitoriasReais = ultimosDoTime.filter(r => {
                    const g = r.ft.split(' x ').map(Number);
                    return (r.time_a === jogo.team_home && g[0] > g[1]) || (r.time_b === jogo.team_home && g[1] > g[0]);
                }).length;

                // Se o favorito nÃ£o ganhou nenhum dos Ãºltimos 3, alerta de Gap de Valor
                if(vitoriasReais === 0) {
                    zebraList.innerHTML += `
                        <div class="zebra-card high-value">
                            <span class="zebra-badge">OPORTUNIDADE DE ZEBRA</span>
                            <div style="font-weight:bold">${jogo.team_home} (Favorito Falso)</div>
                            <div style="font-size:0.8em; color:#aaa">Odd: ${oddCasa} | VitÃ³rias Recentes: 0/3</div>
                            <div style="margin-top:10px; color:var(--green); font-size:0.85em">âž” SugestÃ£o: Dupla HipÃ³tese Fora ou Empate</div>
                        </div>
                    `;
                }
            }
        });
        
        if(zebraList.innerHTML === '') zebraList.innerHTML = '<p style="color:#666">Nenhum favorito falso detectado agora.</p>';

    } catch(e) { console.error(e); }
}

// Menu
const nav = document.getElementById('menu-ligas');
LIGAS.forEach(l => {
    const b = document.createElement('button');
    b.className = `btn-liga ${l === ligaAtual ? 'active' : ''}`;
    b.innerText = l;
    b.onclick = () => {
        document.querySelectorAll('.btn-liga').forEach(x => x.classList.remove('active'));
        b.classList.add('active');
        ligaAtual = l;
        atualizar();
    };
    nav.appendChild(b);
});

setInterval(atualizar, 30000);
atualizar();
</script>
</body>
</html>