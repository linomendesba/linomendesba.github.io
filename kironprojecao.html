<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
        <script
          async
          src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"
        ></script>
        <title>BetStat</title>
        <!-- Meta tags SEO principais -->
        <meta
          name="description"
          content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes."
        />
        <meta
          name="keywords"
          content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos"
        />
    
        <!-- Open Graph meta tags para redes sociais -->
        <meta
          property="og:title"
          content="BetStat | Plataforma de Análise para Apostas Esportivas"
        />
        <meta
          property="og:description"
          content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano."
        />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.betstat.site/payment.html" />
        <meta property="og:site_name" content="BetStat" />
    
        <!-- Meta tags adicionais -->
        <meta name="robots" content="index, follow" />
        <meta name="author" content="BetStat" />
        <meta name="canonical" href="https://www.betstat.site/payment.html" />
        <script type="module" src="js/firebase-auth.js"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag("js", new Date());
    
          gtag("config", "G-4WT805FFHQ");
        </script>
        <link
          href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
          rel="stylesheet"
        />
      </head>

  <style>
    body {
      font-family: "Roboto", Arial, sans-serif;
      margin: 30px;
      background-color: #1c1f26;
      color: #ffffff;
    }
    .logo2 {
  width: 60px;      /* define a largura fixa */
  height: auto;     /* mantém a proporção da imagem */
}

    .espaco {
  width: 50px;  /* Largura da div */
  height: 50px;  /* Altura da div */
}


    option:hover {
      background-color: #ff8000;
      color: #ffffff;
    }

    button {
        background-color: #00b07c;
        color: rgb(30 35 48);
      font-family: "Roboto", Arial, sans-serif;
      border: none;
      padding: 5px 8px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
      margin: 10px;
    }

    button:hover {
      background-color: #0f1013;
    }

    option {
      background-color: #1c1f26;
      color: #ffffff;
    }

    select {
      width: 100%;
      padding: 5px;
      border-radius: 5px;
      background-color: #1c1f26;
      color: #ffffff;
      font-family: "Roboto", Arial, sans-serif;
      font-size: 14px;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }


    .logo {
      height: 30px;
    }

    .selectors-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-seletor {
      display: flex;
      align-items: center;
      color: #ffffff;
      font-weight: 500;
    }

    .nav-seletor select {
      padding: 0.5rem ;
      border-radius: 6px;
      background-color: #1c1f26;
      color: var(--text-color);
      border: 1px solid #ffffff9f;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .logout-btn {
      background-color: #1c1f26;; /* Fundo vermelho */
      color: white; /* Texto branco */
      padding: 8px 10px; /* Espaçamento interno */
      font-size: 14px; /* Tamanho da fonte */
      border-radius: 5px; /* Cantos arredondados */
      cursor: pointer; /* Cursor de botão */
      border: 1px solid #ffffff81;
    }

    .logout-btn:hover {
      background-color: #720000; /* Cor ao passar o mouse */
    }

    :root {
    --primary-bg: #1c1f26;
    --secondary-bg: #2a2e35;
    --accent-color: #006149;
    --text-primary: #ffffff;
    --text-secondary: #b0b8c1;
    --border-color: #404a52;
    --shadow-color: rgba(0, 0, 0, 0.3);
    --fibonacci-color: #FFD700;
}

.container {
            max-width: 1800px;
            margin: 0 auto;
            background-color: #2b3039;
            padding: 30px;
            border-radius: 12px;
            margin-top: 120px;
        }

        h1 {
            text-align: center;
            color: #00b07c;
            margin-bottom: 30px;
            font-size: 36px;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            justify-content: space-between;
        }

        .control-group {
            flex: 1;
            min-width: 250px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #f0f0f0;
            font-size: 16px;
            letter-spacing: 0.2px;
            transition: color 0.3s ease;
        }

        .control-group:hover label {
            color: #00b07c;
        }





        .loading {
            text-align: center;
            padding: 18px;
            background-color: #252a3a;
            color: #f0f0f0;
            border: 2px solid #00b07c;
            border-radius: 8px;
            margin: 30px 0;
            font-size: 18px;
            font-weight: 500;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .projections {
            margin-top: 30px;
        }

        .projections h2 {
            color: #00d494;
            font-size: 15px;
            margin-bottom: 25px;
            white-space: pre-line;
            text-align: center;
            font-weight: 700;
            line-height: 1.5;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .hour-block {
            margin-bottom: 30px;
            border-radius: 10px;
            padding: 20px;
        }


        .hour-block h3 {
            color: #f9f9f9;
            font-size: 22px;
            margin-bottom: 15px;
            border-bottom: 2px solid #23262c;
            padding-bottom: 10px;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .projection-item {
            background-color: #23262c;
            padding: 14px 18px;
            margin: 8px 0;
            border-radius: 8px;
            font-size: 18px;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
        }



        .projection-item::before {
            content: "•";
            color: #00d494;
            margin-right: 10px;
            font-size: 24px;
        }

        .emoji {
            margin-right: 8px;
            font-size: 20px;
        }

        .minutes-list {
            margin-left: 10px;
        }

        .separator {
            text-align: center;
            color: #00b07c;
            margin: 20px 0;
            font-size: 16px;
            position: relative;
        }

        .separator::before, .separator::after {
            content: "";
            display: inline-block;
            width: 40%;
            height: 1px;
            background-color: rgba(0, 176, 124, 0.4);
            position: absolute;
            top: 50%;
        }

        .separator::before {
            left: 0;
        }

        .separator::after {
            right: 0;
        }

        .no-results {
            text-align: center;
            color: #f0f0f0;
            font-size: 18px;
            padding: 30px;
            background-color: #252a3a;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid rgba(0, 176, 124, 0.4);
        }

        @media (max-width: 1200px) {
            .container {
                padding: 20px;
            }
            
            .control-group {
                min-width: 200px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 28px;
            }
            
            .controls {
                gap: 15px;
            }
            
            .control-group {
                min-width: 100%;
            }
        }


        .btn-projecoes {
    background: linear-gradient(45deg, #01805a, #00b07c);
    color: #252a3a;
    border: none;
    padding: 12px 20px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease-in-out;
  }

  .btn-projecoes:hover {
    background: linear-gradient(45deg, #01805a, #00b07c);
    transform: scale(1.05);
  }

  .btn-projecoes:active {
    transform: scale(0.98);
  }

  </style>

<div id="header"></div>

<div class="container">

    
    <div class="controls">
        <div class="control-group">
            <label for="leagueSelect">Selecione uma Liga:</label>
            <select id="leagueSelect">
                <option value="" selected>Escolha uma liga</option>
                <option value="all">Todas as Ligas</option>
                <option value="resultados/kiron/England">Kiron England</option>
                <option value="resultados/kiron/Italy">Kiron Italy</option>
                <option value="resultados/kiron/Spain">Kiron Spain</option>
            </select>
        </div>

        <div class="control-group">
            <label for="marketSelect">Selecione o Mercado:</label>
            <select id="marketSelect">
                <option value="casa">Casa Vence</option>
                <option value="fora">Fora Vence</option>
                <option value="empate">Empate FT</option>
                <option value="over1.5">Over 1.5</option>
                <option value="over2.5" selected>Over 2.5</option>
                <option value="over3.5">Over 3.5</option>
                <option value="ambas">Ambas Sim</option>
                <option value="ambasnao">Ambas Não</option>
                <option value="under15">Under 1.5</option>
                <option value="under25">Under 2.5</option>
                <option value="zerog">Exatamente 0 Gol</option>
                <option value="umg">Exatamente 1 Gol</option>
                <option value="doisg">Exatamente 2 Gols</option>
                <option value="tresg">Exatamente 3 Gols</option>
                <option value="quatrog">Exatamente 4 Gols</option>
                <option value="cincog">5 ou Mais Gols</option>
            </select>
        </div>

        <div class="control-group">
            <label for="rangeSelect">Quantidade de Gales:</label>
            <select id="rangeSelect">
                <option value="1">1 Gale</option>
                <option value="2">2 Gales</option>
                <option value="3" selected>3 Gales</option>
                <option value="4">4 Gales</option>
                <option value="5">5 Gales</option>
            </select>
        </div>

        <div class="control-group">
            <label for="hourSelect">Selecione o Horário (Opcional):</label>
            <select id="hourSelect">
                <option value="" selected>Todas as Horas</option>
                <script>
                    for (let h = 0; h < 24; h++) {
                        const hour = String(h).padStart(2, '0');
                        document.write(`<option value="${hour}">${hour}:00</option>`);
                    }
                </script>
            </select>
        </div>

        <div class="control-group">
            <label for="gameLimitSelect">Quantidade de Jogos:</label>
            <select id="gameLimitSelect">
                <option value="todos" selected>Todos os Jogos</option>
                <option value="480">Últimas 24 Horas</option>
                <option value="960">Últimas 48 Horas</option>
                <option value="1440">Últimas 72 Horas</option>
                <option value="1920">Últimas 96 Horas</option>
            </select>
        </div>
    </div>

    <button class="btn-projecoes" onclick="generateList()">Gerar Lista de Projeções</button>

    <div id="loading" class="loading" style="display: none;">Carregando dados... Por favor aguarde</div>
    <div id="projections" class="projections"></div>
</div>

    <script>
let cachedData = {};
let allProjectionsData = {}; // Armazena todas as projeções para comparação

function showLoading(show) {
    document.getElementById("loading").style.display = show ? "block" : "none";
}

function fetchApiData(league) {
    showLoading(true);
    const apiUrl = `https://betstat.site/${league}`;
    console.log(`Buscando dados em: ${apiUrl}`);
    fetch(apiUrl)
        .then(response => {
            console.log(`Status da resposta: ${response.status}`);
            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
            return response.json();
        })
        .then(data => {
            cachedData[league] = data;
            console.log(`Dados recebidos para ${league}:`, data);
            if (!data || data.length === 0) {
                alert(`Nenhum dado encontrado para ${league}`);
            }
            processApiData(data, league);
            showLoading(false);
        })
        .catch(error => {
            console.error("Erro ao buscar dados:", error);
            console.error("URL tentada:", apiUrl);
            showLoading(false);
            alert(`Erro ao buscar dados da API: ${error.message}\nURL: ${apiUrl}`);
        });
}

function fetchAllLeagues() {
    const leagueSelect = document.getElementById("leagueSelect");
    const leagues = Array.from(leagueSelect.options)
        .map(option => option.value)
        .filter(value => value && value !== "all");
    
    console.log("Ligas selecionadas para buscar:", leagues);
    
    showLoading(true);
    Promise.all(leagues.map(league => {
        if (cachedData[league]) {
            return Promise.resolve(cachedData[league]);
        }
        const url = `https://betstat.site/${league}`;
        console.log(`Buscando: ${url}`);
        return fetch(url)
            .then(res => {
                if (!res.ok) throw new Error(`Erro ${res.status} em ${league}`);
                return res.json();
            })
            .catch(err => {
                console.error(`Erro ao buscar ${league}:`, err);
                return []; // Retorna array vazio em caso de erro
            });
    }))
    .then(results => {
        leagues.forEach((league, index) => {
            if (results[index] && results[index].length > 0) {
                cachedData[league] = results[index];
            }
        });
        console.log("Dados recebidos para todas as ligas:", results);
        processAllLeagues(leagues);
        showLoading(false);
    })
    .catch(error => {
        console.error("Erro ao buscar todas as ligas:", error);
        showLoading(false);
        alert("Erro ao buscar dados de todas as ligas: " + error.message);
    });
}

function generateList() {
    const leagueSelect = document.getElementById("leagueSelect").value;
    if (!leagueSelect) {
        alert("Por favor, selecione uma liga.");
        return;
    }
    if (leagueSelect === "all") {
        fetchAllLeagues();
    } else if (cachedData[leagueSelect]) {
        processApiData(cachedData[leagueSelect], leagueSelect);
    } else {
        fetchApiData(leagueSelect);
    }
}

function processApiData(data, league) {
    const market = document.getElementById("marketSelect").value;
    const range = parseInt(document.getElementById("rangeSelect").value, 10);
    const selectedHour = document.getElementById("hourSelect").value;
    const gameLimit = document.getElementById("gameLimitSelect").value;
    const limitedData = gameLimit === "todos" ? data : data.slice(-parseInt(gameLimit, 10));
    const projections = analyzeProjections(limitedData, market, range, league, selectedHour);
    displayProjections(projections);
}

function processAllLeagues(leagues) {
    const market = document.getElementById("marketSelect").value;
    const range = parseInt(document.getElementById("rangeSelect").value, 10);
    const selectedHour = document.getElementById("hourSelect").value;
    const gameLimit = document.getElementById("gameLimitSelect").value;
    let allProjections = {};

    leagues.forEach(league => {
        const limitedData = gameLimit === "todos" ? cachedData[league] : cachedData[league].slice(-parseInt(gameLimit, 10));
        const projections = analyzeProjections(limitedData, market, range, league, selectedHour);
        Object.keys(projections).forEach(hour => {
            if (!allProjections[hour]) allProjections[hour] = {};
            allProjections[hour][league] = projections[hour][league];
        });
    });
    displayProjections(allProjections);
}

/* === CÁLCULO DE ESTATÍSTICAS AVANÇADAS === */
function calculateAdvancedStats(games, market, sequence) {
    const stats = {
        totalGames: games.length,
        greens: 0,
        reds: 0,
        avgGoals: 0,
        lastOccurrence: null,
        consistency: 0,
        trend: 'stable',
        recentPerformance: []
    };

    let totalGoals = 0;
    let results = [];
    
    games.forEach((game, index) => {
        const [g1, g2] = extractGoalsFromScore(game.ft);
        totalGoals += (g1 + g2);
        
        const isGreen = checkMarketGreen(g1, g2, market, game.ht);
        results.push(isGreen ? 1 : 0);
        
        if (isGreen) {
            stats.greens++;
            if (!stats.lastOccurrence) {
                stats.lastOccurrence = index;
            }
        } else {
            stats.reds++;
        }
    });

    stats.avgGoals = games.length > 0 ? (totalGoals / games.length).toFixed(1) : 0;
    stats.hitRate = games.length > 0 ? Math.round((stats.greens / games.length) * 100) : 0;
    
    // Últimos 5 jogos para tendência
    const recent5 = results.slice(-5);
    stats.recentPerformance = recent5;
    const recentHitRate = recent5.length > 0 ? (recent5.filter(r => r === 1).length / recent5.length) * 100 : 0;
    
    // Calcular tendência
    if (recentHitRate > stats.hitRate + 10) {
        stats.trend = 'up';
    } else if (recentHitRate < stats.hitRate - 10) {
        stats.trend = 'down';
    }
    
    // Calcular consistência (desvio padrão)
    if (results.length > 1) {
        const mean = results.reduce((a, b) => a + b, 0) / results.length;
        const variance = results.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / results.length;
        stats.consistency = Math.round((1 - Math.sqrt(variance)) * 100);
    }
    
    return stats;
}

function checkMarketGreen(g1, g2, market, placarht) {
    return (
        (market === "over2.5" && (g1 + g2) > 2) ||
        (market === "over1.5" && (g1 + g2) > 1) ||
        (market === "over3.5" && (g1 + g2) > 3) ||
        (market === "ambas" && g1 > 0 && g2 > 0) ||
        (market === "ambasnao" && (g1 === 0 || g2 === 0)) ||
        (market === "under15" && (g1 + g2) < 2) ||
        (market === "under25" && (g1 + g2) < 3) ||
        (market === "zerog" && (g1 + g2) === 0) ||
        (market === "umg" && (g1 + g2) === 1) ||
        (market === "doisg" && (g1 + g2) === 2) ||
        (market === "tresg" && (g1 + g2) === 3) ||
        (market === "quatrog" && (g1 + g2) === 4) ||
        (market === "cincog" && (g1 + g2) >= 5) ||
        (market === "casa" && g1 > g2) ||
        (market === "fora" && g1 < g2) ||
        (market === "empate" && g1 === g2) ||
        (market === "OUT" && placarht === "OUT")
    );
}

/* === CÁLCULO DA FORÇA DO SINAL MELHORADO === */
function calculateSignalStrength(galePercents, market, advancedStats) {
    // Força base: média ponderada dos gales
    const weights = [0.4, 0.3, 0.2]; // SG=40%, G1=30%, G2=20%
    let weightedSum = 0;
    let totalWeight = 0;
    
    for (let i = 0; i < galePercents.length && i < weights.length; i++) {
        weightedSum += galePercents[i] * weights[i];
        totalWeight += weights[i];
    }
    
    let forcaBase = totalWeight > 0 ? weightedSum / totalWeight : 0;
    
    // Ajustes baseados em estatísticas avançadas
    // +10% se consistência alta (>80%)
    if (advancedStats.consistency > 80) {
        forcaBase *= 1.10;
    }
    
    // +5% se tendência positiva
    if (advancedStats.trend === 'up') {
        forcaBase *= 1.05;
    }
    
    // -5% se tendência negativa
    if (advancedStats.trend === 'down') {
        forcaBase *= 0.95;
    }
    
    // +5% se média de gols alta (>2.5 para overs)
    if ((market.includes('over') || market === 'ambas') && advancedStats.avgGoals > 2.5) {
        forcaBase *= 1.05;
    }
    
    return Math.min(Math.round(forcaBase), 100); // Cap em 100%
}

/* === CÁLCULO DE PROBABILIDADE POR GALE === */
function calculateGaleProbabilities(galePercents) {
    return {
        sg: galePercents[0] || 0,
        g1: galePercents[1] || 0,
        g2: galePercents[2] || 0
    };
}

/* === ANÁLISE PRINCIPAL === */
function analyzeProjections(data, market, range, league, selectedHour) {
    const gamesByHour = {};
    const gamesByMinute = {}; // Para estatísticas avançadas
    
    data.forEach(game => {
        const hora = String(game.hora).padStart(2, '0');
        const minuto = String(game.minuto).padStart(2, '0');
        const horario = `${hora}:${minuto}`;
        if (selectedHour && hora !== selectedHour) return;
        if (!gamesByHour[hora]) gamesByHour[hora] = [];
        if (!gamesByMinute[minuto]) gamesByMinute[minuto] = [];
        
        gamesByHour[hora].push({ time: horario, ft: game.ft, ht: game.ht });
        gamesByMinute[minuto].push({ ft: game.ft, ht: game.ht });
    });

    const results = {};
    const galeHits = {};
    const totals = {};

    Object.keys(gamesByHour).forEach(hour => {
        gamesByHour[hour].sort((a, b) => a.time.localeCompare(b.time));

        gamesByHour[hour].forEach(g => {
            const min = g.time.split(':')[1];
            if (!galeHits[min]) galeHits[min] = Array(range).fill(0);
            if (!totals[min]) totals[min] = 0;
        });

        gamesByHour[hour].forEach((game, index) => {
            const minuto = game.time.split(':')[1];
            totals[minuto]++;

            let greenFound = false;
            for (let i = 0; i < range && (index + i) < gamesByHour[hour].length; i++) {
                const check = gamesByHour[hour][index + i];
                const [g1, g2] = extractGoalsFromScore(check.ft);
                const placarht = check.ht || "";

                const isGreen = checkMarketGreen(g1, g2, market, placarht);

                if (isGreen && !greenFound) {
                    galeHits[minuto][i]++;
                    greenFound = true;
                }
            }
        });

        const sequences = [];
        const used = new Set();

        for (let i = 0; i < gamesByHour[hour].length; i++) {
            const min = gamesByHour[hour][i].time.split(':')[1];
            const totalHits = galeHits[min].reduce((a, b) => a + b, 0);
            if (totalHits === totals[min] && !used.has(min)) {
                const seq = [min];
                let cur = parseInt(min);
                
                // Para ligas Kiron: 30 jogos/hora = intervalo de 2 minutos
                const minuteInterval = 2;
                
                for (let j = 1; j < range; j++) {
                    cur = (cur + minuteInterval) % 60;
                    seq.push(String(cur).padStart(2, '0'));
                    used.add(String(cur).padStart(2, '0'));
                }
                
                const percents = galeHits[min].map(h => totals[min] ? Math.round((h / totals[min]) * 100) : 0);
                seq.galePercents = percents;
                
                // Estatísticas avançadas
                const advancedStats = calculateAdvancedStats(gamesByMinute[min] || [], market, seq);
                seq.advancedStats = advancedStats;
                
                const forcaSinal = calculateSignalStrength(percents, market, advancedStats);
                seq.forcaSinal = forcaSinal;
                
                const galeProbabilities = calculateGaleProbabilities(percents);
                seq.galeProbabilities = galeProbabilities;
                
                // Últimos jogos para exibição
                seq.lastGames = (gamesByMinute[min] || []).slice(-5);
                
                sequences.push(seq);
                used.add(min);
            }
        }

        if (sequences.length > 0) {
            if (!results[hour]) results[hour] = {};
            results[hour][league] = sequences;
        }
    });

    return results;
}

function extractGoalsFromScore(scoreString) {
    if (!scoreString || typeof scoreString !== 'string') return [0, 0];
    const scoreParts = scoreString.split('x').map(part => part.trim());
    if (scoreParts.length === 2) {
        const team1Goals = parseInt(scoreParts[0], 10) || 0;
        const team2Goals = parseInt(scoreParts[1], 10) || 0;
        return [team1Goals, team2Goals];
    }
    return [0, 0];
}

/* === EMOJIS E CLASSIFICAÇÃO === */
function getSignalEmoji(percent) {
    if (percent >= 85) return '🟢';
    if (percent >= 40) return '🟡';
    return '🟠';
}

function getSignalStrength(percent) {
    if (percent >= 85) return 'Excelente';
    if (percent >= 40) return 'Bom';
    return 'Regular';
}

function getSignalColor(percent) {
    if (percent >= 85) return '#00ff00';
    if (percent >= 40) return '#ffff00';
    return '#ff9500';
}

function getTrendEmoji(trend) {
    if (trend === 'up') return '📈';
    if (trend === 'down') return '📉';
    return '';
}

/* === BARRA DE PROGRESSO VISUAL === */
function createProgressBar(percent) {
    const filled = Math.round(percent / 10);
    const empty = 10 - filled;
    return `[${'█'.repeat(filled)}${'░'.repeat(empty)}] ${percent}%`;
}

/* === NOME DAS LIGAS - APENAS KIRON === */
function getLeagueName(league) {
    // Se a liga contém '/', pega apenas a última parte
    if (league.includes('/')) {
        const parts = league.split('/');
        return parts[parts.length - 1]; // Retorna: England, Italy ou Spain
    }
    
    return decodeURIComponent(league).toUpperCase();
}

/* === EXPORTAR RESULTADOS === */
function exportResults(projections) {
    let text = "=== PROJEÇÕES DE SINAIS - KIRON ===\n\n";
    
    Object.keys(projections).sort((a, b) => a - b).forEach(hour => {
        text += `\n📍 HORA: ${String(hour).padStart(2, '0')}\n`;
        text += "=".repeat(50) + "\n";
        
        Object.keys(projections[hour]).forEach(league => {
            const leagueName = getLeagueName(league);
            
            projections[hour][league].forEach(seq => {
                const minutes = seq.slice(0, 3).join(' ');
                const force = seq.forcaSinal;
                const emoji = getSignalEmoji(force);
                const strength = getSignalStrength(force);
                const probs = seq.galeProbabilities;
                
                text += `\n${emoji} ${leagueName}\n`;
                text += `   Minutos: ${minutes}\n`;
                text += `   Força: ${force}% (${strength})\n`;
                text += `   SG: ${probs.sg}% | G1: ${probs.g1}% | G2: ${probs.g2}%\n`;
            });
        });
    });
    
    return text;
}

/* === FILTRAR PROJEÇÕES POR FORÇA === */
function filterByStrength(projections, minStrength) {
    const filtered = {};
    
    Object.keys(projections).forEach(hour => {
        Object.keys(projections[hour]).forEach(league => {
            const sequences = projections[hour][league].filter(seq => seq.forcaSinal >= minStrength);
            
            if (sequences.length > 0) {
                if (!filtered[hour]) filtered[hour] = {};
                filtered[hour][league] = sequences;
            }
        });
    });
    
    return filtered;
}

/* === ENCONTRAR MELHORES SINAIS === */
function findTopSignals(projections, topN = 3) {
    const allSignals = [];
    
    Object.keys(projections).forEach(hour => {
        Object.keys(projections[hour]).forEach(league => {
            projections[hour][league].forEach(seq => {
                allSignals.push({
                    hour,
                    league,
                    sequence: seq,
                    force: seq.forcaSinal
                });
            });
        });
    });
    
    return allSignals.sort((a, b) => b.force - a.force).slice(0, topN);
}

/* === DISPLAY FINAL MELHORADO === */
function displayProjections(projections) {
    const projectionsDiv = document.getElementById("projections");
    const marketText = document.getElementById("marketSelect").options[document.getElementById("marketSelect").selectedIndex].text;
    const range = document.getElementById("rangeSelect").value;
    projectionsDiv.innerHTML = "";

    if (Object.keys(projections).length === 0) {
        const noResults = document.createElement("p");
        noResults.className = "no-results";
        noResults.textContent = "Nenhuma projeção encontrada para os critérios selecionados.";
        projectionsDiv.appendChild(noResults);
        return;
    }

    // Armazena projeções globalmente
    allProjectionsData = projections;

    // Header com controles
    const header = document.createElement("div");
    header.style.marginBottom = "20px";
    header.innerHTML = `
        <h2>PROJEÇÕES KIRON - ${range} GALES - Mercado: ${marketText}</h2>
        <div style="display: flex; gap: 15px; margin: 15px 0; flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: 5px;">
                <input type="checkbox" id="filterGoodSignals" onchange="applyFilters()">
                Mostrar apenas sinais Bons/Ótimos
            </label>
        </div>
    `;
    projectionsDiv.appendChild(header);

    // Top 3 melhores sinais
    const topSignals = findTopSignals(projections, 3);
    if (topSignals.length > 0) {
        const topSection = document.createElement("div");
        topSection.style.cssText = "background: linear-gradient(135deg, #1c1f26 0%, #005540 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.3);";
        topSection.innerHTML = `<h3 style="margin: 0 0 15px 0; color: white;">⭐ TOP 3 MELHORES SINAIS</h3>`;

        
        topSignals.forEach((signal, index) => {
            const leagueName = getLeagueName(signal.league);
            const minutes = signal.sequence.slice(0, range).join(' ');
            const emoji = getSignalEmoji(signal.force);
            
            topSection.innerHTML += `
                <div style="background: rgba(0, 217, 255, 0.1); padding: 10px; margin: 8px 0; border-radius: 8px; border-left: 3px solid #00d9ff; color: #e0e0e0;">
                    <strong style="color: #00d9ff;">#${index + 1}</strong> ${emoji} ${leagueName} - Hora ${String(signal.hour).padStart(2, '0')} - Minutos: ${minutes}
                    <br><span style="font-size: 14px;">Força: ${signal.force}% | ${getSignalStrength(signal.force)}</span>
                </div>
            `;
        });
        
        projectionsDiv.appendChild(topSection);
    }

    // Container para projeções
    const projectionsContainer = document.createElement("div");
    projectionsContainer.id = "projectionsContainer";
    projectionsDiv.appendChild(projectionsContainer);

    renderProjections(projections, projectionsContainer, range, marketText);
}

function renderProjections(projections, container, range, marketText) {
    container.innerHTML = "";
    
    Object.keys(projections).sort((a, b) => a - b).forEach(hour => {
        const hourBlock = document.createElement("div");
        hourBlock.className = "hour-block";

        const hourTitle = document.createElement("h3");
        hourTitle.textContent = `Hora: ${String(hour).padStart(2, '00')}`;
        hourBlock.appendChild(hourTitle);

        Object.keys(projections[hour]).forEach(league => {
            const leagueName = getLeagueName(league);

            projections[hour][league].forEach(sequence => {
                const mainLine = document.createElement("div");
                mainLine.className = "projection-item";
                mainLine.style.cssText = "margin-bottom: 4px; cursor: pointer; transition: all 0.3s;";
                mainLine.onclick = () => toggleDetails(mainLine);

                const minutesText = sequence.slice(0, range).join(' ');
                const forcaSinal = sequence.forcaSinal || 0;
                const emoji = getSignalEmoji(forcaSinal);
                const isBest = forcaSinal >= 90;
                
                mainLine.innerHTML = `
                    <span class="emoji">🏆</span> ${leagueName} ${isBest ? '⭐' : ''}
                    <span class="minutes-list">⏰ ${minutesText}</span> → ${marketText}
                `;

                // Linha de força do sinal
                const statsLine = document.createElement("div");
                statsLine.style.cssText = "margin-left: 30px; font-size: 14px; color: #b0b8c1; margin-bottom: 5px;";

                const galeProbabilities = sequence.galeProbabilities || {};
                const advStats = sequence.advancedStats || {};
                
                let galeTexts = '';
                if (range >= 1 && galeProbabilities.sg !== undefined) {
                    galeTexts += `SG: ${galeProbabilities.sg}%`;
                }
                if (range >= 2 && galeProbabilities.g1 !== undefined) {
                    galeTexts += ` | G1: ${galeProbabilities.g1}%`;
                }
                if (range >= 3 && galeProbabilities.g2 !== undefined) {
                    galeTexts += ` | G2: ${galeProbabilities.g2}%`;
                }

                const strength = getSignalStrength(forcaSinal);
                const color = getSignalColor(forcaSinal);
                const progressBar = createProgressBar(forcaSinal);
                const trendEmoji = getTrendEmoji(advStats.trend);

                statsLine.innerHTML = `
                    ${emoji} <span style="color: ${color}; font-weight: bold;">${progressBar}</span> - ${strength} ${trendEmoji}
                    <br><span style="font-size: 12px;">${galeTexts}</span>
                `;

                // Detalhes expandíveis (ocultos inicialmente)
                const detailsLine = document.createElement("div");
                detailsLine.className = "details-section";
                detailsLine.style.cssText = "display: none; margin-left: 30px; margin-top: 8px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px; font-size: 13px;";
                
                detailsLine.innerHTML = `
                    <div style="margin-bottom: 5px;"><strong>📊 Estatísticas Avançadas:</strong></div>
                    <div>• Taxa de acerto: ${advStats.hitRate || 0}% (${advStats.greens || 0}✅ / ${advStats.reds || 0}❌)</div>
                    <div>• Média de gols: ${advStats.avgGoals || 0} gols/jogo</div>
                    <div>• Consistência: ${advStats.consistency || 0}%</div>
                    <div>• Tendência: ${trendEmoji} ${advStats.trend === 'up' ? 'Melhorando' : advStats.trend === 'down' ? 'Piorando' : 'Estável'}</div>
                    ${sequence.lastGames && sequence.lastGames.length > 0 ? `
                    <div style="margin-top: 8px;"><strong>📜 Últimos 5 jogos:</strong></div>
                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-top: 5px;">
                        ${sequence.lastGames.map(g => {
                            const [g1, g2] = extractGoalsFromScore(g.ft);
                            const market = document.getElementById("marketSelect").value;
                            const isGreen = checkMarketGreen(g1, g2, market, g.ht);
                            return `<span style="padding: 3px 8px; background: ${isGreen ? '#2d5016' : '#5c1a1a'}; border-radius: 3px;">${g.ft} ${isGreen ? '✅' : '❌'}</span>`;
                        }).join('')}
                    </div>
                    ` : ''}
                `;

                hourBlock.appendChild(mainLine);
                hourBlock.appendChild(statsLine);
                hourBlock.appendChild(detailsLine);
            });
        });

        container.appendChild(hourBlock);

        const separator = document.createElement("p");
        separator.className = "separator";
        separator.textContent = "•";
        container.appendChild(separator);
    });
}

function toggleDetails(element) {
    const detailsSection = element.nextElementSibling.nextElementSibling;
    if (detailsSection && detailsSection.className === 'details-section') {
        detailsSection.style.display = detailsSection.style.display === 'none' ? 'block' : 'none';
    }
}

function applyFilters() {
    const filterGood = document.getElementById("filterGoodSignals")?.checked || false;
    
    let filtered = allProjectionsData;
    
    // Filtrar apenas bons/ótimos
    if (filterGood) {
        filtered = filterByStrength(filtered, 45);
    }
    
    const container = document.getElementById("projectionsContainer");
    const marketText = document.getElementById("marketSelect").options[document.getElementById("marketSelect").selectedIndex].text;
    const range = document.getElementById("rangeSelect").value;
    
    if (container) {
        renderProjections(filtered, container, range, marketText);
    }
}

function copyResults() {
    const text = exportResults(allProjectionsData);
    navigator.clipboard.writeText(text).then(() => {
        alert("✅ Resultados copiados para a área de transferência!");
    }).catch(err => {
        console.error("Erro ao copiar:", err);
        alert("❌ Erro ao copiar resultados.");
    });
}
    </script>

    <script>
              // Bloqueia o menu de contexto (clique direito)
      document.addEventListener("contextmenu", function(e) {
    e.preventDefault();
});

// Bloqueia atalhos de teclado comuns para ferramentas de desenvolvimento
document.addEventListener("keydown", function(e) {
    // F12
    if (e.key === "F12") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + I
    if (e.ctrlKey && e.shiftKey && e.key === "I") {
        e.preventDefault();
    }
    
    // Ctrl + U (ver código fonte)
    if (e.ctrlKey && e.key === "u") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + J (console)
    if (e.ctrlKey && e.shiftKey && e.key === "J") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + C (inspeção de elementos)
    if (e.ctrlKey && e.shiftKey && e.key === "C") {
        e.preventDefault();
    }
    
    // Ctrl + S (salvar página)
    if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
    }
    
    // Ctrl + P (imprimir)
    if (e.ctrlKey && e.key === "p") {
        e.preventDefault();
    }
});



// Detecta abertura de ferramentas de desenvolvimento
const devtools = { open: false };
const element = new Image();
Object.defineProperty(element, 'id', {
    get: function () {
        devtools.open = true;
    }
});

// Adiciona detecção alternativa de devtools
(function() {
    const threshold = 160;
    const checkDevTools = function() {
        if ((window.outerWidth - window.innerWidth) > threshold || 
            (window.outerHeight - window.innerHeight) > threshold) {
            devtools.open = true;
        }
    };
    
    window.addEventListener('resize', checkDevTools);
    setInterval(checkDevTools, 500);
})();

// Monitoramento contínuo
console.log('%c', element);
setInterval(function() {
    if (devtools.open) {
        document.body.innerHTML = '<h1>Acesso não autorizado detectado</h1>';
        // Ou redirecionar:
        // window.location.href = 'about:blank';
        devtools.open = false;
    }
}, 1000);

// Impede seleção de texto
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});

// Impede arrastar e soltar
document.addEventListener('dragstart', function(e) {
    e.preventDefault();
});

// Ofusca console
console.log = function() {};
console.debug = function() {};
console.info = function() {};
    </script>


<script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });
  </script>
  <script src="redirecionar.js"></script>
  </body>
</html>
