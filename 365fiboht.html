<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="style.css" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>    
        <title>BetStat</title>
                    <!-- Meta tags SEO principais -->
    <meta name="description" content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes.">
    <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos">
    
    <!-- Open Graph meta tags para redes sociais -->
    <meta property="og:title" content="BetStat | Plataforma de Análise para Apostas Esportivas">
    <meta property="og:description" content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.betstat.site/payment.html">
    <meta property="og:site_name" content="BetStat">
    
    <!-- Meta tags adicionais -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="BetStat">
    <meta name="canonical" href="https://www.betstat.site/payment.html">
        <script type="module">
            // Importa as funções necessárias do Firebase
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
            import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
    
            // Configurações do Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyDmLGMBnUa2YOdP0b-zlZepXjm-zlV477A",
                authDomain: "linoautenticador.firebaseapp.com",
                projectId: "linoautenticador",
                storageBucket: "linoautenticador.firebasestorage.app",
                messagingSenderId: "946057648829",
                appId: "1:946057648829:web:ac5c2b1ba66e651f9d75d4",
                measurementId: "G-4WT805FFHQ"
            };
    
            // Inicializa o Firebase
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
    
            // Verifica se o usuário está autenticado
            onAuthStateChanged(auth, (user) => {
                if (!user) {
                    // Se não estiver autenticado, redireciona para a página de login
                    window.location.href = "auth.html"; 
                } 
            });
    
            // Função para sair
            window.logout = function() {
                signOut(auth).then(() => {
                    alert("Você saiu com sucesso!");
                    window.location.href = "auth.html"; // Redireciona para a página de login
                }).catch((error) => {
                    alert("Erro ao sair: " + error.message);
                });
            };
        </script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
    
            gtag('config', 'G-4WT805FFHQ');
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
        
    </head>

    <style>
                h1, h2, label {
            color: #1fad8b;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        .control-panel {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            margin-top: 60px;
        }
        select {
            padding: 8px 12px;
            background-color: #292d36;
            color: #e0e0e0;
            border: 1px solid #1fad8b;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        select:hover {
            border-color: #34d8ab;
        }
        select:focus {
            outline: none;
            border-color: #1fad8b;
        }
        .chart-container {
            background-color: #292d36;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 40px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        .chart-container h2 {
            font-size: 18px;
            margin-bottom: 10px;
            text-align: center;
        }
        canvas {
            border-radius: 4px;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        input[type="checkbox"] {
            cursor: pointer;
        }
    </style>
    
<body>
  <body>
    <header>
      <div class="header-container">
        <img src="img/logo.png" alt="Logo" class="logo" />
        <div class="selectors-container">
          <div class="nav-seletor">
            <label for="ligas"></label>
            <select id="ligas" onchange="redirecionar(this)">
              <option value="">Betano</option>
              <option value="index.html">Taça Glória Eterna</option>
              <option value="copa_america.html">Copa América</option>
              <option value="euro.html">Euro</option>
              <option value="campeonato_italiano.html">
                Campeonato Italiano
              </option>
              <option value="copa_das_estrelas.html">Copa das Estrelas</option>
              <option value="BritishDerbies.html">British Derbies</option>
              <option value="LigaEspanhola.html">Liga Espanhola</option>
              <option value="ScudettoItaliano.html">Scudetto Italiano</option>
            </select>
          </div>
  
          <div class="nav-seletor">
            <label for="ligas"></label>
            <select id="ligas" onchange="redirecionar(this)">
              <option value="">Bet365</option>
              <option value="365copa.html">Copa do Mundo</option>
              <option value="365euro.html">Euro Cup</option>
              <option value="365premier.html">Premier League</option>
              <option value="365super.html">Super Liga</option>
              <option value="365express.html">Express(BETA)</option>
            </select>
          </div>
  
          <div class="nav-seletor" id="seletor-redes">
              <label for="redes"></label>
              <select id="redes" onchange="redirecionar(this)">
                <option value="">Avançado</option>
            
                <!-- Sequência isolada -->
                <option value="https://www.betstat.site/sequencia.html">Sequência</option>
            
                <!-- Separator -->
                <option disabled>──────────</option>
            
                <!-- Restante das opções -->
                <optgroup label="Bet365">
                  <option value="https://www.betstat.site/365buscador.html">Buscador</option>
                  <option value="https://www.betstat.site/porcentagem365.html">Porcentagem</option>
                  <option value="https://www.betstat.site/365macro.html">Macro</option>
                  <option value="https://www.betstat.site/mult365.html">MultiLiga</option>
                  <option value="https://www.betstat.site/365fixo.html">Hora Fixa</option>
                  <option value="https://www.betstat.site/365fiboexato.html">Fibo Exato</option>
                  <option value="https://www.betstat.site/365fiboht.html">Fibo HT</option>
                  <option value="https://www.betstat.site/365gols.html">Gols Pró</option>
                </optgroup>
            
                <option disabled>──────────</option>
            
                <optgroup label="Betano">
                  <option value="https://www.betstat.site/betanobuscador.html">Buscador</option>
                  <option value="https://www.betstat.site/multbetano.html">MultiLiga</option>
                  <option value="https://www.betstat.site/porcentagembetano.html">Porcentagem</option>
                  <option value="https://www.betstat.site/macrobetano.html">Macro</option>
                  <option value="https://www.betstat.site/betanofixo.html">Hora Fixa</option>
                  <option value="https://www.betstat.site/betanofiboexato.html">Fibo Exato</option>
                </optgroup>
              </select>
            </div>
        </div>
      </div>
  
      <div class="nav-seletor">
        <label for="redes"></label>
        <select id="redes" onchange="redirecionar(this)">
          <option value="">Extras</option>
          <option value="https://www.betstat.site/tv/">Ao vivo</option>
          <option value="https://www.betstat.site/central/">
            Cental Tipster
          </option>
          <option value="blog.html">Blog</option>
        </select>
      </div>
  
      <button class="logout-btn" onclick="logout()">Sair</button>
    </header>

    <div class="control-panel">
        <div>
            <label for="pointsSelector">Jogos</label>
            <select id="pointsSelector">
                <option value="20">20</option>
                <option value="40">40</option>
                <option value="60">60</option>
                <option value="80">80</option>
                <option value="100">100</option>
                <option value="120">120</option>
                <option value="140">140</option>
                <option value="160">160</option>
                <option value="180">180</option>
                <option value="200">200</option>
                <option value="220">220</option>
                <option value="240">240</option>
                <option value="480">480</option>
            </select>
        </div>
        
        <div>
            <label for="averageSelector">Base</label>
            <select id="averageSelector">
                <option value="19">20</option>
                <option value="39">40</option>
                <option value="59">60</option>
                <option value="79">80</option>
                <option value="99">100</option>
                <option value="119">120</option>
                <option value="239">240</option>
                <option value="479">480</option>        
                <option value="959">960</option>
            </select>
        </div>

        <div class="checkbox-container">
            <input type="checkbox" id="fibonacciToggle">
            <label for="fibonacciToggle">Ativar Fibonacci</label>
        </div>
    </div>

    <div class="chart-container">
        <h2>Copa do Mundo</h2>
        <canvas id="copaChart" width="400" height="130"></canvas>
    </div>
    <div class="chart-container">
        <h2>Euro Cup</h2>
        <canvas id="euroChart" width="400" height="130"></canvas>
    </div>
    <div class="chart-container">
        <h2>Premier League</h2>
        <canvas id="premierChart" width="400" height="130"></canvas>
    </div>
    <div class="chart-container">
        <h2>Super Liga</h2>
        <canvas id="superChart" width="400" height="130"></canvas>
    </div>

    <script src="redirecionar.js"></script>
    
    <script>
            // Bloqueia o menu de contexto (clique direito)
document.addEventListener("contextmenu", function(e) {
    e.preventDefault();
});

// Bloqueia atalhos de teclado comuns para ferramentas de desenvolvimento
document.addEventListener("keydown", function(e) {
    // F12
    if (e.key === "F12") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + I
    if (e.ctrlKey && e.shiftKey && e.key === "I") {
        e.preventDefault();
    }
    
    // Ctrl + U (ver código fonte)
    if (e.ctrlKey && e.key === "u") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + J (console)
    if (e.ctrlKey && e.shiftKey && e.key === "J") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + C (inspeção de elementos)
    if (e.ctrlKey && e.shiftKey && e.key === "C") {
        e.preventDefault();
    }
    
    // Ctrl + S (salvar página)
    if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
    }
    
    // Ctrl + P (imprimir)
    if (e.ctrlKey && e.key === "p") {
        e.preventDefault();
    }
});

// Detecta abertura de ferramentas de desenvolvimento
const devtools = { open: false };
const element = new Image();
Object.defineProperty(element, 'id', {
    get: function () {
        devtools.open = true;
    }
});

// Adiciona detecção alternativa de devtools
(function() {
    const threshold = 160;
    const checkDevTools = function() {
        if ((window.outerWidth - window.innerWidth) > threshold || 
            (window.outerHeight - window.innerHeight) > threshold) {
            devtools.open = true;
        }
    };
    
    window.addEventListener('resize', checkDevTools);
    setInterval(checkDevTools, 500);
})();

// Monitoramento contínuo
console.log('%c', element);
setInterval(function() {
    if (devtools.open) {
        document.body.innerHTML = '<h1>Acesso não autorizado detectado</h1>';
        // Ou redirecionar:
        // window.location.href = 'about:blank';
        devtools.open = false;
    }
}, 1000);

// Impede seleção de texto
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});

// Impede arrastar e soltar
document.addEventListener('dragstart', function(e) {
    e.preventDefault();
});

// Ofusca console
console.log = function() {};
console.debug = function() {};
console.info = function() {};
    </script>
    <script>
                let euroChart, copaChart, superChart, premierChart;
        let numPoints = 20;
        let averagePoints = 19;
        let showFibonacciLines = false; // Variável para controlar a exibição das linhas de Fibonacci
        const leagues = ['Euro', 'Copa', 'Super', 'Premier'];
        const chartInstances = {};
        let chartData = {};

        const statsChartVisibleDatasets = {
            '0-0': false,
            '1-0': false,
            '0-1': false,
            '1-1': false,
            '2-0': false,
            '0-2': false,
            'OUT': false,
            'OverHT': true,
            'UnderHT': true,    
            'Casa HT': false,              
            'Empate HT': false,
            'Fora HT': false,               
            'Gols HT': true,                
        };

        function updateStatsChart(chart, newData) {
            if (chart) {
                chart.data.labels = newData.labels;
                chart.data.datasets[0].data = newData.ambasMarcam;
                chart.data.datasets[1].data = newData.over25;
                chart.data.datasets[2].data = newData.under15;
                chart.data.datasets[3].data = newData.over35;
                chart.data.datasets[4].data = newData.mais5;
                chart.data.datasets[5].data = newData.casavence;
                chart.data.datasets[6].data = newData.foravence;
                chart.data.datasets[7].data = newData.golsVisitante;
                chart.data.datasets[8].data = newData.golsCasa;
                chart.data.datasets[9].data = newData.casaht;
                chart.data.datasets[10].data = newData.empateht;
                chart.data.datasets[11].data = newData.foraht;
                chart.data.datasets[12].data = newData.golsht;        
                chart.update('none');
            }
        }

        function formatHtResult(ht) {
            if (ht === 'OUT') return 'OUT';
            if (ht && ht.includes(' x ')) {
                const parts = ht.split(' x ');
                if (parts.length === 2) {
                    return `${parts[0]}-${parts[1]}`;
                }
            }
            return ht;
        }

        function processApiData(data, league) {
            const sortedData = [...data].sort((a, b) => {
                const dateA = new Date(a.data);
                const dateB = new Date(b.data);
                if (dateA.getTime() !== dateB.getTime()) return dateA - dateB;
                if (a.hora !== b.hora) return a.hora - b.hora;
                return a.minuto - b.minuto;
            });

            const slicedData = sortedData.slice(-numPoints - averagePoints);
            chartData[league] = slicedData; // Armazena os dados para o tooltip

            let labels = [];
            let gols = [];
            let golsCasa = [];
            let golsVisitante = [];
            let ambasMarcam = [];
            let over25 = [];
            let over35 = [];
            let under15 = [];
            let mais5 = [];
            let casavence = [];
            let foravence = [];
            let casaht = [];
            let foraht = [];
            let empateht = [];           
            let golsht = [];

            for (let i = averagePoints; i < slicedData.length; i++) {
                let golsSum = 0;
                let golsCasaSum = 0;
                let golsVisitanteSum = 0;
                let ambasSum = 0;
                let overSum = 0;
                let underSum = 0;
                let over35Sum = 0;
                let over5Sum = 0;
                let casavenceSum = 0;
                let foravenceSum = 0;
                let casahtSum = 0;            
                let forahtSum = 0;
                let empatehtSum = 0;
                let golshtSum = 0;    

                for (let j = Math.max(0, i - averagePoints); j <= i; j++) {
                    const match = slicedData[j];
                    const ftScore = match.ft;
                    const htScore = formatHtResult(match.ht);
                    
                    let ftScoreParts = [0, 0];
                    if (ftScore && ftScore.includes(' x ')) {
                        ftScoreParts = ftScore.split(' x ').map(num => parseInt(num, 10));
                    }
                    
                    golsSum += ftScoreParts[0] + ftScoreParts[1];
                    golsCasaSum += (htScore === '0-0' || htScore === '1-0' || htScore === '0-1') ? 1 : 0;
                    golsVisitanteSum += (htScore === '1-1' || htScore === '2-0' || htScore === '0-2' || htScore === 'OUT') ? 1 : 0;
                    ambasSum += (htScore === '0-0') ? 1 : 0;
                    overSum += (htScore === '0-1') ? 1 : 0;
                    underSum += (htScore === '1-0') ? 1 : 0;
                    over35Sum += (htScore === '1-1') ? 1 : 0;
                    over5Sum += (htScore === '0-2') ? 1 : 0;
                    casavenceSum += (htScore === '2-0') ? 1 : 0;
                    foravenceSum += (htScore === 'OUT') ? 1 : 0;
                    
                    if (htScore !== 'OUT' && htScore.includes('-')) {
                        const [homeGoals, awayGoals] = htScore.split('-').map(num => parseInt(num, 10));
                        casahtSum += (homeGoals > awayGoals) ? 1 : 0;
                        forahtSum += (homeGoals < awayGoals) ? 1 : 0;
                        empatehtSum += (homeGoals === awayGoals) ? 1 : 0;
                        golshtSum += homeGoals + awayGoals;
                    } else if (htScore === 'OUT') {
                        golshtSum += 3;
                    }
                }

                const match = slicedData[i];
                labels.push(`${match.hora}:${match.minuto.toString().padStart(2, '0')}`);
                
                gols.push(golsSum / (averagePoints+1)*100);
                golsCasa.push((golsCasaSum) / (averagePoints+1)*100);
                golsVisitante.push(golsVisitanteSum / (averagePoints+1)*100);
                ambasMarcam.push(ambasSum / (averagePoints+1)*100);
                over25.push(overSum / (averagePoints+1)*100);
                under15.push(underSum / (averagePoints+1)*100);
                over35.push(over35Sum / (averagePoints+1)*100);
                mais5.push(over5Sum / (averagePoints+1)*100);
                casavence.push(casavenceSum / (averagePoints+1)*100);
                foravence.push(foravenceSum / (averagePoints+1)*100);
                foraht.push(forahtSum / (averagePoints+1)*100);            
                casaht.push(casahtSum / (averagePoints+1)*100);            
                empateht.push(empatehtSum / (averagePoints+1)*100);            
                golsht.push(golshtSum);
            }

            return { labels, ambasMarcam, over25, over35, under15, mais5, casavence, foravence, golsVisitante, golsCasa, foraht, casaht, empateht, golsht };
        }

        Chart.register(ChartDataLabels);

        // Plugin para desenhar as linhas de Fibonacci
        const fibonacciLinesPlugin = {
            id: 'fibonacciLines',
            afterDraw: (chart) => {
                if (!showFibonacciLines) return; // Não desenha as linhas se o Fibonacci estiver desativado

                const ctx = chart.ctx;
                const yAxis = chart.scales.y;
                const fibonacciLevels = [0, 23.6, 38.2, 50, 61.8, 100]; // Níveis de Fibonacci ajustados

                // Obter os valores mínimo e máximo do eixo Y
                const yMin = yAxis.min;
                const yMax = yAxis.max;

                // Mapear os níveis de Fibonacci para a escala do eixo Y
                const range = yMax - yMin;
                const normalizedLevels = fibonacciLevels.map(level => yMin + (level / 100) * range);

                ctx.save();
                normalizedLevels.forEach((level, index) => {
                    const y = yAxis.getPixelForValue(level);
                    // Desenhar a linha
                    ctx.beginPath();
                    ctx.moveTo(chart.chartArea.left, y);
                    ctx.lineTo(chart.chartArea.right, y);
                    ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)'; // Verde para as linhas de Fibonacci
                    ctx.lineWidth = 1;
                    ctx.stroke();

                    // Adicionar o texto do nível de Fibonacci no lado direito
                    ctx.fillStyle = '#b0b0b0';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'right';
                    // Ajustar a posição do texto para evitar sobreposição e corte
                    const textY = y - (index === 0 ? -10 : 5); // Ajuste para a linha de 100% (index 0)
                    ctx.fillText(`${fibonacciLevels[index]}%`, chart.chartArea.right - 5, textY);
                });
                ctx.restore();
            }
        };

        function createStatsChart(ctx, labels, data, league) {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                    {
                        label: '0-0',
                        data: data.ambasMarcam,
                        borderColor: '#1E88E5',
                        backgroundColor: '#1E88E5',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#1E88E5',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['0-0']
                    },
                    {
                        label: '0-1',
                        data: data.over25,
                        borderColor: '#D81B60',
                        backgroundColor: '#D81B60',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#D81B60',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['0-1']
                    },
                    {
                        label: '1-0',
                        data: data.under15,
                        borderColor: '#43A047',
                        backgroundColor: '#43A047',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#43A047',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['1-0']
                    },
                    {
                        label: '1-1',
                        data: data.over35,
                        borderColor: '#F4511E',
                        backgroundColor: '#F4511E',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#F4511E',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['1-1']
                    },
                    {
                        label: '0-2',
                        data: data.mais5,
                        borderColor: '#8E24AA',
                        backgroundColor: '#8E24AA',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#8E24AA',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['0-2']
                    },
                    {
                        label: '2-0',
                        data: data.casavence,
                        borderColor: '#FDD835',
                        backgroundColor: '#FDD835',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#FDD835',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['2-0']
                    },
                    {
                        label: 'OUT',
                        data: data.foravence,
                        borderColor: '#546E7A',
                        backgroundColor: '#546E7A',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#546E7A',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['OUT']
                    },
                    {
                        label: 'OverHT',
                        data: data.golsVisitante,
                        borderColor: '#FFB300',
                        backgroundColor: '#FFB300',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#FFB300',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['OverHT']
                    },
                    {
                        label: 'UnderHT',
                        data: data.golsCasa,
                        borderColor: '#00897B',
                        backgroundColor: '#00897B',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#00897B',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['UnderHT']
                    },
                    {
                        label: 'Casa HT',
                        data: data.casaht,
                        borderColor: '#3949AB',
                        backgroundColor: '#3949AB',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#3949AB',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['Casa HT']
                    },
                    {
                        label: 'Empate HT',
                        data: data.empateht,
                        borderColor: '#FF6F00',
                        backgroundColor: '#FF6F00',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#FF6F00',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['Empate HT']
                    },
                    {
                        label: 'Fora HT',
                        data: data.foraht,
                        borderColor: '#C2185B',
                        backgroundColor: '#C2185B',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#C2185B',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['Fora HT']
                    },
                    {
                        label: 'Gols HT',
                        data: data.golsht,
                        borderColor: '#7CB342',
                        backgroundColor: '#7CB342',
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: '#7CB342',
                        fill: false,
                        hidden: !statsChartVisibleDatasets['Gols HT']
                    }
                    ]
                },
                options: {
                    responsive: true,            
                    layout: {
                        padding: {
                            top: 20 // Adiciona espaço extra na parte superior para evitar corte
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#e0e0e0',
                                font: {
                                    size: 12
                                }
                            },
                            onClick: function(e, legendItem, legend) {
                                const dataset = legendItem.datasetIndex;
                                const ci = legend.chart;
                                const meta = ci.getDatasetMeta(dataset);
                                meta.hidden = !meta.hidden;
                                statsChartVisibleDatasets[legendItem.text] = !meta.hidden;
                                ci.update();
                            }
                        },
                        datalabels: {
                            display: false,
                            color: '#ffffff',
                            align: 'top',
                            anchor: 'end',
                            offset: 4,
                            font: {
                                weight: 'bold',
                                size: 11
                            },
                            formatter: function(value) {
                                return Math.round(value);
                            },
                            padding: {
                                top: 4
                            },
                            textStrokeColor: '#000000',
                            textStrokeWidth: 2,
                            borderRadius: 4                    
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#1fad8b',
                            bodyColor: '#e0e0e0',
                            borderColor: '#1fad8b',
                            borderWidth: 1,
                            callbacks: {
                                title: function(tooltipItems) {
                                    const league = leagues.find(l => chartInstances[l] === tooltipItems[0].chart);
                                    const index = tooltipItems[0].dataIndex + averagePoints;
                                    const match = chartData[league][index];
                                    return `${match.hora}:${match.minuto.toString().padStart(2, '0')}`;
                                },
                                label: function(tooltipItem) {
                                    const league = leagues.find(l => chartInstances[l] === tooltipItem.chart);
                                    const index = tooltipItem.dataIndex + averagePoints;
                                    const match = chartData[league][index];
                                    const ftScore = match.ft || 'N/A';
                                    const htScore = formatHtResult(match.ht) || 'N/A';
                                    return [
                                        `FT: ${ftScore}`,
                                        `HT: ${htScore}`,
                                        `${tooltipItem.dataset.label}: ${Math.round(tooltipItem.raw)}`
                                    ];
                                }
                            }
                        }
                    },    
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Hora',
                                color: '#1fad8b',
                                font: {
                                    size: 14
                                }
                            },
                            ticks: {
                                color: '#b0b0b0',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                borderDash: [5, 5]
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Estatísticas',
                                color: '#1fad8b',
                                font: {
                                    size: 14
                                }
                            },
                            beginAtZero: false,
                            ticks: {
                                color: '#b0b0b0'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                borderDash: [5, 5]
                            },
                            afterFit: function(scale) {
                                // Adiciona espaço extra no topo para evitar corte da linha de 100%
                                scale.paddingTop = 20;
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels, fibonacciLinesPlugin]
            });
        }

        function updateCharts() {
            const timestamp = new Date().getTime();
            leagues.forEach(league => {
                const apiUrl = `https://betstat.site/api/resultados/${league}?timestamp=${timestamp}`;
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        const processedData = processApiData(data, league);
                        const chartId = `${league.toLowerCase()}Chart`;
                        if (!chartInstances[league]) {
                            const ctx = document.getElementById(chartId).getContext('2d');
                            chartInstances[league] = createStatsChart(ctx, processedData.labels, processedData, league);
                        } else {
                            updateStatsChart(chartInstances[league], processedData);
                        }
                    })
                    .catch(error => {
                        console.error(`Error fetching data for ${league}:`, error);
                    });
            });
        }

        // Função para atualizar a exibição das linhas de Fibonacci
        function toggleFibonacciLines() {
            showFibonacciLines = document.getElementById('fibonacciToggle').checked;
            leagues.forEach(league => {
                if (chartInstances[league]) {
                    chartInstances[league].update();
                }
            });
        }

        document.getElementById('pointsSelector').addEventListener('change', function(event) {
            numPoints = parseInt(event.target.value, 10);
            updateCharts();
        });

        document.getElementById('averageSelector').addEventListener('change', function(event) {
            averagePoints = parseInt(event.target.value, 10);
            updateCharts();
        });

        document.getElementById('fibonacciToggle').addEventListener('change', function() {
            toggleFibonacciLines();
        });

        window.onload = function() {
            updateCharts();
        };

        setInterval(updateCharts, 3000);
    </script>

</body>
</html>
