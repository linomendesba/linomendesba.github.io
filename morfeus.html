<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>
  <title>BetStat</title>

  <meta name="description" content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano." />
  <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas" />
  <meta property="og:title" content="BetStat | Plataforma de Análise para Apostas Esportivas" />
  <meta property="og:description" content="Transforme suas apostas com análises precisas e estatísticas confiáveis." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.betstat.site/payment.html" />
  <meta property="og:site_name" content="BetStat" />
  <meta name="robots" content="index, follow" />

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag("js", new Date());
    gtag("config", "G-4WT805FFHQ");
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
  --primary-color: #1fac89;
  --primary-hover: #189976;
  --primary-dark: #01684f;
  --bg-color: #1c1f26;
  --text-color: #ffffff;
  --text-muted: #9ca3af;
  --container-bg: #2a2f3a;
  --border-color: rgba(31, 172, 137, 0.2);
  --border-muted: rgba(255, 255, 255, 0.1);
  --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.25);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Inter', sans-serif;
  background: var(--bg-color);
  color: var(--text-color);
  line-height: 1.6;
  min-height: 100vh;
}

.container { max-width:1500px; margin:0 auto; padding:3rem 2rem; }

.title {
  font-size:3rem; font-weight:700;
  background:linear-gradient(135deg, var(--primary-color), var(--primary-hover));
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  margin-bottom:0.75rem;
}

.analysis-card {
  background:var(--container-bg);
  border:1px solid var(--border-muted);
  border-radius:16px;
  padding:2.5rem;
  box-shadow:var(--shadow-lg);
}

.section { margin-bottom:2.5rem; }
.section-title {
  font-size:1.125rem; font-weight:600;
  margin-bottom:1.25rem;
  display:flex; align-items:center; gap:0.5rem;
}
.section-title::before {
  content:''; width:4px; height:20px;
  background:linear-gradient(180deg, var(--primary-color), var(--primary-hover));
  border-radius:2px;
}

.btn-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); gap:0.875rem; }

.btn {
  background:var(--bg-color); color:var(--text-muted);
  border:1.5px solid var(--border-muted);
  padding:0.875rem 1.25rem; border-radius:10px;
  font-size:0.9rem; font-weight:500; cursor:pointer;
  transition:var(--transition);
}
.btn:hover { color:var(--text-color); border-color:var(--primary-color); }
.btn.active {
  background:linear-gradient(135deg, var(--primary-color), var(--primary-hover));
  color:var(--text-color); border-color:var(--primary-color);
}

.actions { display:flex; gap:1rem; margin-top:2.5rem; }
.action-btn {
  flex:1; padding:1.125rem 2rem; border:none; border-radius:12px;
  font-size:1rem; font-weight:600; cursor:pointer;
}
.btn-clear { background:transparent; color:var(--text-muted); border:2px solid var(--border-muted); }
.btn-generate {
  background:linear-gradient(135deg, var(--primary-dark), var(--primary-color));
  color:var(--text-color);
}

.result-container {
  margin-top:2.5rem; background:var(--container-bg);
  border:1px solid var(--border-color); border-radius:16px;
  padding:2.5rem; display:none;
}

.result-title { font-size:1.5rem; font-weight:700; margin-bottom:1rem; }
.result-content { white-space:pre-wrap; font-size:1rem; line-height:1.8; }

.loading { display:flex; align-items:center; gap:0.875rem; color:var(--primary-color); }
.spinner {
  width:24px; height:24px;
  border:3px solid rgba(31,172,137,0.2);
  border-top-color:var(--primary-color);
  border-radius:50%; animation:spin 0.8s linear infinite;
}
@keyframes spin { to { transform:rotate(360deg); } }

.error {
  background:rgba(239,68,68,0.1);
  border:1px solid #ef4444;
  color:#ef4444;
  padding:1.5rem;
  border-radius:12px;
  margin-top:1rem;
}
</style>

<body>
  <div id="header"></div>
  <br><br>

  <div class="container">
    <div class="analysis-card">

      <div class="section">
        <h2 class="section-title">Casa de Aposta</h2>
        <div class="btn-grid" id="casas-group">
          <button class="btn" data-value="betano">Betano</button>
          <button class="btn" data-value="kiron">Kiron</button>
          <button class="btn" data-value="estrela">Estrelabet</button>
          <button class="btn" data-value="bet365">Bet365</button>
        </div>
      </div>

      <div class="section" id="liga-section" style="display:none;">
        <h2 class="section-title">Liga</h2>
        <div class="btn-grid" id="ligas-group"></div>
      </div>

      <div class="section">
        <h2 class="section-title">Mercado da Análise</h2>
        <div class="btn-grid" id="mercados-group">
          <button class="btn" data-value="casaVence">Casa Vence</button>
          <button class="btn" data-value="foraVence">Fora Vence</button>
          <button class="btn" data-value="empate">Empate</button>
          <button class="btn" data-value="over1.5">Over 1.5</button>
          <button class="btn" data-value="over2.5">Over 2.5</button>
          <button class="btn" data-value="over3.5">Over 3.5</button>
          <button class="btn" data-value="under1.5">Under 1.5</button>
          <button class="btn" data-value="under2.5">Under 2.5</button>
          <button class="btn" data-value="under3.5">Under 3.5</button>
          <button class="btn" data-value="ambasMarcam">Ambas Sim</button>
          <button class="btn" data-value="ambasNaoMarcam">Ambas Não</button>
          <button class="btn" data-value="over5">5+ Gols</button>
          <button class="btn" data-value="exact1">1 Gol Exato</button>
          <button class="btn" data-value="exact2">2 Gols Exatos</button>
          <button class="btn" data-value="exact3">3 Gols Exatos</button>
          <button class="btn" data-value="exact4">4 Gols Exatos</button>
        </div>
      </div>

      <div class="section">
        <h2 class="section-title">Estratégia Martingale</h2>
        <div class="btn-grid" id="martingale-group">
          <button class="btn" data-value="0">Nenhum</button>
          <button class="btn" data-value="1">1 Cobertura</button>
          <button class="btn" data-value="2">2 Coberturas</button>
          <button class="btn" data-value="3">3 Coberturas</button>
        </div>
      </div>

      <div class="section">
        <h2 class="section-title">Período de Análise</h2>
        <div class="btn-grid" id="periodo-group">
          <button class="btn" data-value="120">6 Horas</button>
          <button class="btn" data-value="240">12 Horas</button>
          <button class="btn" data-value="480">24 Horas</button>
          <button class="btn" data-value="960">48 Horas</button>
          <button class="btn" data-value="1440">72 Horas</button>
        </div>
      </div>

      <div class="actions">
        <button class="action-btn btn-clear" onclick="limparAnalise()">Nova Análise</button>
        <button class="action-btn btn-generate" onclick="gerarAnalise()">Gerar Relatório</button>
      </div>

      <div class="result-container" id="result-container">
        <h3 class="result-title" id="result-title"></h3>
        <div class="result-content" id="result-content"></div>
      </div>

    </div>
  </div>

  <script>
const casasConfig = {
  'betano': { name: 'Betano', ligas: [{ name: 'Clássicos da América', value: 'Taça Glória Eterna' }, 'Copa América', 'Euro', 'Campeonato Italiano', 'Copa das Estrelas', 'Brasileirão Betano'] },
  'kiron': { name: 'Kiron', ligas: ['England', 'Italy', 'Spain'], path: 'kiron' },
  'estrela': { name: 'Estrelabet', ligas: ['Copa do Mundo', 'Ligas dos Campeões', 'América Latina'], path: 'estrela' },
  'bet365': { name: 'Bet365', ligas: ['Copa', 'Euro', 'Super', 'Premier'], path: 'bet365' }
};

document.querySelectorAll('.btn-grid').forEach(group => {
  group.addEventListener('click', e => {
    if (!e.target.classList.contains('btn')) return;
    const active = group.querySelector('.btn.active');
    if (active) active.classList.remove('active');
    e.target.classList.add('active');
    if (group.id === 'casas-group') mostrarLigas(e.target.dataset.value);
  });
});

function mostrarLigas(casa) {
  const section = document.getElementById('liga-section');
  const group = document.getElementById('ligas-group');
  if (!casasConfig[casa]) { section.style.display = 'none'; return; }
  group.innerHTML = '';
  casasConfig[casa].ligas.forEach(item => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    if (typeof item === 'object') {
      btn.dataset.value = item.value;
      btn.textContent = item.name;
    } else {
      btn.dataset.value = item;
      btn.textContent = item;
    }
    group.appendChild(btn);
  });
  section.style.display = 'block';
}

function getSelectedValue(id) {
  const active = document.getElementById(id)?.querySelector('.btn.active');
  return active ? active.dataset.value : null;
}
function getSelectedText(id) {
  const active = document.getElementById(id)?.querySelector('.btn.active');
  return active ? active.innerText : null;
}

function limparAnalise() {
  document.querySelectorAll('.btn.active').forEach(b => b.classList.remove('active'));
  document.getElementById('liga-section').style.display = 'none';
  document.getElementById('result-container').style.display = 'none';
}

/* === Worker (cole aqui o ANALYZE_WORKER_SRC completo do seu código original) === */
const ANALYZE_WORKER_SRC = `...`; // ← Substitua por todo o código do worker que estava no seu arquivo original

let ANALYZE_WORKER = null;
function getAnalyzeWorker() {
  if (!ANALYZE_WORKER) {
    const blob = new Blob([ANALYZE_WORKER_SRC], {type: "application/javascript"});
    ANALYZE_WORKER = new Worker(URL.createObjectURL(blob));
  }
  return ANALYZE_WORKER;
}

function analyzeInWorker(dados, opts) {
  return new Promise((resolve, reject) => {
    const w = getAnalyzeWorker();
    const id = Math.random().toString(36).slice(2);
    const handler = ev => {
      if (ev.data.id !== id) return;
      w.removeEventListener('message', handler);
      if (ev.data.ok) resolve(ev.data.result);
      else reject(ev.data.error || 'Erro no worker');
    };
    w.addEventListener('message', handler);
    w.postMessage({cmd: 'analyze', id, payload: {dados, ...opts}});
  });
}

/* Demais funções (calcularRankingTimes, buscarDadosAPI, mapMercado, checkMarket, calculateMarketAnalysis, gerarRelatorioEstatistico) permanecem iguais às que eu enviei antes */

async function gerarAnalise() {
  const MAX = 6, COOLDOWN = 3;
  const now = new Date();
  const today = now.toISOString().split('T')[0];
  let usage = JSON.parse(localStorage.getItem('analysisUsage')) || {date:today, count:0, lastAnalysis:null};
  if (usage.date !== today) usage = {date:today, count:0, lastAnalysis:null};

  if (usage.count >= MAX) return alert('Limite de 6 análises por dia atingido.');
  if (usage.lastAnalysis) {
    const diff = (now - new Date(usage.lastAnalysis)) / 60000;
    if (diff < COOLDOWN) return alert(`Aguarde ${Math.ceil(COOLDOWN-diff)} minuto(s).`);
  }

  const casa = getSelectedValue('casas-group');
  const liga = getSelectedValue('ligas-group');
  const mercado = getSelectedValue('mercados-group');
  const mercadoTxt = getSelectedText('mercados-group');
  const martingale = parseInt(getSelectedValue('martingale-group') || '0');
  const martingaleTxt = getSelectedText('martingale-group');
  const periodo = getSelectedValue('periodo-group');

  if (!casa || !liga || !mercado || !periodo) return alert('Selecione todos os campos obrigatórios.');

  const btn = document.querySelector('.btn-generate');
  const container = document.getElementById('result-container');
  const title = document.getElementById('result-title');
  const content = document.getElementById('result-content');

  btn.disabled = true;
  btn.innerHTML = '<div class="spinner"></div> Processando...';
  container.style.display = 'block';
  content.textContent = '';

  try {
    console.log('1. Iniciando busca de dados...');
    title.innerHTML = `<div class="loading"><div class="spinner"></div>Coletando ${periodo} jogos...</div>`;
    const dados = await buscarDadosAPI(casa, liga, parseInt(periodo));
    console.log('Dados recebidos:', dados.totalJogos);

    console.log('2. Calculando ranking...');
    title.innerHTML = '<div class="loading"><div class="spinner"></div>Calculando ranking...</div>';
    dados.ranking = calcularRankingTimes(dados.dadosCru.map(j => ({time_a: j[3], time_b: j[4], ft: `${j[0]} x ${j[1]}`})), mercado);

    console.log('3. Analisando padrões...');
    title.innerHTML = '<div class="loading"><div class="spinner"></div>Buscando padrões...</div>';
    const workerRes = await analyzeInWorker(dados.dadosCru, {tiros: martingale+1, market: mercado, combinado: true});
    dados.padroesEncontrados = workerRes.resultados;

    console.log('4. Análise de mercado...');
    const searched = mapMercado(mercado);
    const lines = casa === 'kiron' ? 30 : 20;
    dados.marketAnalysis = calculateMarketAnalysis(dados, searched, dados.totalJogos, lines, martingale+1);

    console.log('5. Gerando relatório...');
    title.innerHTML = '✓ Relatório Gerado';
    const params = {mercado: mercadoTxt, periodo: periodo+' jogos', martingale: martingaleTxt || 'Nenhum', observacao: ''};
    content.textContent = gerarRelatorioEstatistico(dados, params);

    usage.count++;
    usage.lastAnalysis = now.toISOString();
    localStorage.setItem('analysisUsage', JSON.stringify(usage));

  } catch (err) {
    console.error('ERRO:', err);
    title.innerHTML = '✖ Erro';
    content.innerHTML = `<div class="error"><strong>Erro:</strong> ${err.message}<br><br>Abra o Console (F12) para detalhes.</div>`;
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'Gerar Relatório';
  }
}

document.addEventListener("contextmenu", e => e.preventDefault());
document.addEventListener("keydown", e => {
  if (e.key==="F12" || (e.ctrlKey && e.shiftKey && (e.key==="I"||e.key==="J"||e.key==="C")) || (e.ctrlKey && (e.key==="u"||e.key==="s"||e.key==="p"))) e.preventDefault();
});
  </script>

  <script>
    fetch('header.html').then(r => r.text()).then(html => document.getElementById('header').innerHTML = html);
  </script>
  <script src="redirecionar.js"></script>
</body>
</html>