<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>    
        <title>BetStat</title>
                    <!-- Meta tags SEO principais -->
    <meta name="description" content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes.">
    <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos">
    
    <!-- Open Graph meta tags para redes sociais -->
    <meta property="og:title" content="BetStat | Plataforma de Análise para Apostas Esportivas">
    <meta property="og:description" content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.betstat.site/payment.html">
    <meta property="og:site_name" content="BetStat">
    
    <!-- Meta tags adicionais -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="BetStat">
    <meta name="canonical" href="https://www.betstat.site/payment.html">
        <script type="module">
            // Importa as funções necessárias do Firebase
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
            import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
    
            // Configurações do Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyDmLGMBnUa2YOdP0b-zlZepXjm-zlV477A",
                authDomain: "linoautenticador.firebaseapp.com",
                projectId: "linoautenticador",
                storageBucket: "linoautenticador.firebasestorage.app",
                messagingSenderId: "946057648829",
                appId: "1:946057648829:web:ac5c2b1ba66e651f9d75d4",
                measurementId: "G-4WT805FFHQ"
            };
    
            // Inicializa o Firebase
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
    
            // Verifica se o usuário está autenticado
            onAuthStateChanged(auth, (user) => {
                if (!user) {
                    // Se não estiver autenticado, redireciona para a página de login
                    window.location.href = "auth.html"; 
                } 
            });
    
            // Função para sair
            window.logout = function() {
                signOut(auth).then(() => {
                    alert("Você saiu com sucesso!");
                    window.location.href = "auth.html"; // Redireciona para a página de login
                }).catch((error) => {
                    alert("Erro ao sair: " + error.message);
                });
            };
        </script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
    
            gtag('config', 'G-4WT805FFHQ');
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
        
    </head>

    <style>

body {
      font-family: "Roboto", Arial, sans-serif;
      margin: 30px;
      background-color: #1c1f26;
      color: #ffffff;
    }

    .espaco {
  width: 50px;  /* Largura da div */
  height: 50px;  /* Altura da div */
}


    option:hover {
      background-color: #ff8000;
      color: #ffffff;
    }

    canvas {
    cursor: pointer;
}

    button {
      background-color: #1c1f26;
      color: rgb(255, 255, 255);
      font-family: "Roboto", Arial, sans-serif;
      border: none;
      padding: 5px 8px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
      margin: 10px;
    }

    button:hover {
      background-color: #0f1013;
    }

    option {
      background-color: #1c1f26;
      color: #ffffff;
    }

    select {
      width: 100%;
      padding: 5px;
      border-radius: 5px;
      background-color: #1c1f26;
      color: #ffffff;
      font-family: "Roboto", Arial, sans-serif;
      font-size: 14px;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    header {
        background: #005540;
      width: 100vw;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      height: 60px;
    }

    .header-container {
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      padding: 0 20px;
      justify-content: space-between;
    }

    .logo {
      height: 40px;
    }

    .selectors-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-seletor {
      display: flex;
      align-items: center;
      color: #ffffff;
      font-weight: 500;
    }

    .nav-seletor select {
      padding: 0.5rem ;
      border-radius: 6px;
      background-color: #1c1f26;
      color: var(--text-color);
      border: 1px solid #ffffff9f;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .logout-btn {
      background-color: #1c1f26;; /* Fundo vermelho */
      color: white; /* Texto branco */
      padding: 8px 10px; /* Espaçamento interno */
      font-size: 14px; /* Tamanho da fonte */
      border-radius: 5px; /* Cantos arredondados */
      cursor: pointer; /* Cursor de botão */
      border: 1px solid #ffffff81;
    }

    .logout-btn:hover {
      background-color: #720000; /* Cor ao passar o mouse */
    }

    h1, h2, label {
            color: #1fad8b;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
        }
        .control-panel {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        select {
            padding: 8px 12px;
            background-color: #292d36;
            color: #e0e0e0;
            border: 1px solid #1fad8b;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        select:hover {
            border-color: #34d8ab;
        }
        select:focus {
            outline: none;
            border-color: #1fad8b;
        }
        .chart-container {
            background-color: #292d36;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 40px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        .chart-container h2 {
            font-size: 18px;
            margin-bottom: 10px;
            text-align: center;
        }
        canvas {
            border-radius: 4px;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        input[type="checkbox"] {
            cursor: pointer;
        }
        /* Accordion Styles */
        .accordion {
            margin-bottom: 10px;
        }
        .accordion-header {
            background-color: #292d36;
            color: #1fad8b;
            padding: 10px;
            cursor: pointer;
            border: 1px solid #1fad8b;
            border-radius: 4px;
            font-size: 18px;
            text-align: center;
        }
        .accordion-header:hover {
            background-color: #34383f;
        }
        .accordion-content {
            display: none; /* Hidden by default */
            padding: 10px;
        }
        .accordion-content.active {
            display: block;
        }
    </style>
    
<body>
  <body>
    <div id="header"></div>
    <br>
<br>
<br>

<div class="control-panel">
    <div>
        <label for="pointsSelector">Jogos</label>
        <select id="pointsSelector">
            <option value="20">20</option>
            <option value="40">40</option>
            <option value="60">60</option>
            <option value="80">80</option>
            <option value="100">100</option>
            <option value="120">120</option>
            <option value="140">140</option>
            <option value="160">160</option>
            <option value="180">180</option>
            <option value="200">200</option>
        </select>
    </div>
    
    <div>
        <label for="averageSelector">Base</label>
        <select id="averageSelector">
            <option value="19">20</option>
            <option value="39">40</option>
            <option value="59">60</option>
            <option value="79">80</option>
            <option value="99">100</option>
            <option value="119">120</option>
        </select>
    </div>

    <div class="checkbox-container">
        <input type="checkbox" id="fibonacciToggle">
        <label for="fibonacciToggle">Ativar Fibonacci</label>
    </div>

    <div class="checkbox-container">
        <input type="checkbox" id="dataLabelsToggle">
        <label for="dataLabelsToggle">Ativar Rótulos</label>
    </div>
</div>

<!-- Accordion for Copa América -->
<div class="accordion">
    <div class="accordion-header">Copa América</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Copa América</h2>
            <canvas id="copaAmericaChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Taça Glória Eterna -->
<div class="accordion">
    <div class="accordion-header">Taça Glória Eterna</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Taça Glória Eterna</h2>
            <canvas id="tacaGloriaChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Euro -->
<div class="accordion">
    <div class="accordion-header">Euro</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Euro</h2>
            <canvas id="euroChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Campeonato Italiano -->
<div class="accordion">
    <div class="accordion-header">Campeonato Italiano</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Campeonato Italiano</h2>
            <canvas id="campeonatoItalianoChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Copa das Estrelas -->
<div class="accordion">
    <div class="accordion-header">Copa das Estrelas</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Copa das Estrelas</h2>
            <canvas id="copaEstrelasChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for British Derbies -->
<div class="accordion">
    <div class="accordion-header">British Derbies</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>British Derbies</h2>
            <canvas id="britishDerbiesChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Liga Espanhola -->
<div class="accordion">
    <div class="accordion-header">Liga Espanhola</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Liga Espanhola</h2>
            <canvas id="ligaEspanholaChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>

<!-- Accordion for Scudetto Italiano -->
<div class="accordion">
    <div class="accordion-header">Scudetto Italiano</div>
    <div class="accordion-content">
        <div class="chart-container">
            <h2>Scudetto Italiano</h2>
            <canvas id="scudettoItalianoChart" width="400" height="130"></canvas>
        </div>
    </div>
</div>


    <script>
        let copaAmericaChart, tacaGloriaChart, euroChart, campeonatoItalianoChart, copaEstrelasChart, britishDerbiesChart, ligaEspanholaChart, scudettoItalianoChart;
        let numPoints = 20;
        let averagePoints = 19;
        let showFibonacciLines = false;
        let showDataLabels = false; // Default: data labels off
        const leagues = ['CopaAmerica', 'TacaGloria', 'Euro', 'CampeonatoItaliano', 'CopaEstrelas', 'BritishDerbies', 'LigaEspanhola', 'ScudettoItaliano'];
        const chartInstances = {};
        let chartData = {};

        const statsChartVisibleDatasets = {
            '0-0': false,
            '1-0': false,
            '0-1': false,
            '1-1': false,
            '2-0': false,
            '0-2': false,
            'OUT': false,
            'OverHT': true,
            'UnderHT': true,
            'Casa HT': false,
            'Empate HT': false,
            'Fora HT': false,
            'Gols HT': true
        };

        function formatHtResult(ht) {
            if (ht === 'OUT') return 'OUT';
            if (ht && ht.includes(' x ')) {
                const parts = ht.split(' x ');
                if (parts.length === 2) {
                    return `${parts[0]}-${parts[1]}`;
                }
            }
            return ht;
        }

        function updateStatsChart(chart, newData) {
            if (chart) {
                chart.data.labels = newData.labels;
                chart.data.datasets[0].data = newData.score00;
                chart.data.datasets[1].data = newData.score10;
                chart.data.datasets[2].data = newData.score01;
                chart.data.datasets[3].data = newData.score11;
                chart.data.datasets[4].data = newData.score20;
                chart.data.datasets[5].data = newData.score02;
                chart.data.datasets[6].data = newData.out;
                chart.data.datasets[7].data = newData.overHT;
                chart.data.datasets[8].data = newData.underHT;
                chart.data.datasets[9].data = newData.casaHT;
                chart.data.datasets[10].data = newData.empateHT;
                chart.data.datasets[11].data = newData.foraHT;
                chart.data.datasets[12].data = newData.golsHT;
                chart.update('none');
            }
        }

        function processApiData(data, league) {
            const sortedData = [...data].sort((a, b) => {
                const dateA = new Date(a.data);
                const dateB = new Date(b.data);
                if (dateA.getTime() !== dateB.getTime()) return dateA - dateB;
                if (a.hora !== b.hora) return a.hora - b.hora;
                return a.minuto - b.minuto;
            });

            const slicedData = sortedData.slice(-numPoints - averagePoints);
            chartData[league] = slicedData;

            let labels = [];
            let score00 = [];
            let score10 = [];
            let score01 = [];
            let score11 = [];
            let score20 = [];
            let score02 = [];
            let out = [];
            let overHT = [];
            let underHT = [];
            let casaHT = [];
            let empateHT = [];
            let foraHT = [];
            let golsHT = [];

            for (let i = averagePoints; i < slicedData.length; i++) {
                let score00Sum = 0;
                let score10Sum = 0;
                let score01Sum = 0;
                let score11Sum = 0;
                let score20Sum = 0;
                let score02Sum = 0;
                let outSum = 0;
                let overHTSum = 0;
                let underHTSum = 0;
                let casaHTSum = 0;
                let empateHTSum = 0;
                let foraHTSum = 0;
                let golsHTSum = 0;

                for (let j = Math.max(0, i - averagePoints); j <= i; j++) {
                    const match = slicedData[j];
                    const htScore = formatHtResult(match.ht);

                    let htScoreParts = [0, 0];
                    if (htScore && htScore !== 'OUT' && htScore.includes('-')) {
                        htScoreParts = htScore.split('-').map(num => parseInt(num, 10));
                    }

                    const totalGolsHT = htScoreParts[0] + htScoreParts[1];

                    score00Sum += (htScore === '0-0') ? 1 : 0;
                    score10Sum += (htScore === '1-0') ? 1 : 0;
                    score01Sum += (htScore === '0-1') ? 1 : 0;
                    score11Sum += (htScore === '1-1') ? 1 : 0;
                    score20Sum += (htScore === '2-0') ? 1 : 0;
                    score02Sum += (htScore === '0-2') ? 1 : 0;
                    outSum += (htScore === 'OUT') ? 1 : 0;
                    overHTSum += (totalGolsHT > 0.5) ? 1 : 0;
                    underHTSum += (totalGolsHT < 0.5) ? 1 : 0;
                    casaHTSum += (htScore !== 'OUT' && htScoreParts[0] > htScoreParts[1]) ? 1 : 0;
                    empateHTSum += (htScore !== 'OUT' && htScoreParts[0] === htScoreParts[1]) ? 1 : 0;
                    foraHTSum += (htScore !== 'OUT' && htScoreParts[0] < htScoreParts[1]) ? 1 : 0;
                    if (htScore !== 'OUT') {
                        golsHTSum += totalGolsHT;
                    } else {
                        golsHTSum += 3; // Match the reference code's logic for 'OUT'
                    }
                }

                const match = slicedData[i];
                labels.push(`${match.hora}:${match.minuto.toString().padStart(2, '0')}`);
                
                const avg = averagePoints + 1;
                score00.push(score00Sum / avg * 100);
                score10.push(score10Sum / avg * 100);
                score01.push(score01Sum / avg * 100);
                score11.push(score11Sum / avg * 100);
                score20.push(score20Sum / avg * 100);
                score02.push(score02Sum / avg * 100);
                out.push(outSum / avg * 100);
                overHT.push(overHTSum / avg * 100);
                underHT.push(underHTSum / avg * 100);
                casaHT.push(casaHTSum / avg * 100);
                empateHT.push(empateHTSum / avg * 100);
                foraHT.push(foraHTSum / avg * 100);
                golsHT.push(golsHTSum); // No percentage normalization for golsHT
            }

            return { 
                labels, score00, score10, score01, score11, score20, score02, out,
                overHT, underHT, casaHT, empateHT, foraHT, golsHT
            };
        }

        Chart.register(ChartDataLabels);

        const fibonacciLinesPlugin = {
            id: 'fibonacciLines',
            afterDraw: (chart) => {
                if (!showFibonacciLines) return;
                const ctx = chart.ctx;
                const yAxis = chart.scales.y;
                const fibonacciLevels = [0, 23.6, 38.2, 50, 61.8, 100];
                const yMin = yAxis.min;
                const yMax = yAxis.max;
                const range = yMax - yMin;
                const normalizedLevels = fibonacciLevels.map(level => yMin + (level / 100) * range);

                ctx.save();
                normalizedLevels.forEach((level, index) => {
                    const y = yAxis.getPixelForValue(level);
                    ctx.beginPath();
                    ctx.moveTo(chart.chartArea.left, y);
                    ctx.lineTo(chart.chartArea.right, y);
                    ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    ctx.fillStyle = '#b0b0b0';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'left'; // Align text to start from the specified x-coordinate
                    const textY = y - (index === 0 ? -10 : 5);
                    const textX = chart.chartArea.right + 10; // Position text 10px to the right of the chart area
                    ctx.fillText(`${fibonacciLevels[index]}%`, textX, textY);
                });
                ctx.restore();
            }
        };

        function createStatsChart(ctx, labels, data, league) {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: '0-0', data: data.score00, borderColor: '#1E88E5', backgroundColor: '#1E88E5', hidden: !statsChartVisibleDatasets['0-0'] },
                        { label: '1-0', data: data.score10, borderColor: '#AB47BC', backgroundColor: '#AB47BC', hidden: !statsChartVisibleDatasets['1-0'] },
                        { label: '0-1', data: data.score01, borderColor: '#78909C', backgroundColor: '#78909C', hidden: !statsChartVisibleDatasets['0-1'] },
                        { label: '1-1', data: data.score11, borderColor: '#2196F3', backgroundColor: '#2196F3', hidden: !statsChartVisibleDatasets['1-1'] },
                        { label: '2-0', data: data.score20, borderColor: '#B0BEC5', backgroundColor: '#B0BEC5', hidden: !statsChartVisibleDatasets['2-0'] },
                        { label: '0-2', data: data.score02, borderColor: '#F44336', backgroundColor: '#F44336', hidden: !statsChartVisibleDatasets['0-2'] },
                        { label: 'OUT', data: data.out, borderColor: '#26A69A', backgroundColor: '#26A69A', hidden: !statsChartVisibleDatasets['OUT'] },
                        { label: 'OverHT', data: data.overHT, borderColor: '#FFEB3B', backgroundColor: '#FFEB3B', hidden: !statsChartVisibleDatasets['OverHT'] },
                        { label: 'UnderHT', data: data.underHT, borderColor: '#00BCD4', backgroundColor: '#00BCD4', hidden: !statsChartVisibleDatasets['UnderHT'] },
                        { label: 'Casa HT', data: data.casaHT, borderColor: '#388E3C', backgroundColor: '#388E3C', hidden: !statsChartVisibleDatasets['Casa HT'] },
                        { label: 'Empate HT', data: data.empateHT, borderColor: '#FF9800', backgroundColor: '#FF9800', hidden: !statsChartVisibleDatasets['Empate HT'] },
                        { label: 'Fora HT', data: data.foraHT, borderColor: '#F06292', backgroundColor: '#F06292', hidden: !statsChartVisibleDatasets['Fora HT'] },
                        { label: 'Gols HT', data: data.golsHT, borderColor: '#D81B60', backgroundColor: '#D81B60', hidden: !statsChartVisibleDatasets['Gols HT'] }
                    ].map(dataset => ({
                        ...dataset,
                        borderWidth: 2,
                        pointRadius: 4,
                        pointBackgroundColor: dataset.borderColor,
                        fill: false
                    }))
                },
                options: {
                    responsive: true,            
                    layout: { 
                        padding: { 
                            top: 30,
                            right: 50 // Add right padding for Fibonacci labels
                        } 
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#e0e0e0', font: { size: 12 } },
                            onClick: function(e, legendItem, legend) {
                                const dataset = legendItem.datasetIndex;
                                const ci = legend.chart;
                                const meta = ci.getDatasetMeta(dataset);
                                meta.hidden = !meta.hidden;
                                statsChartVisibleDatasets[legendItem.text] = !meta.hidden;
                                ci.update();
                            }
                        },
                        datalabels: {
                            display: showDataLabels, // Controlled by the toggle
                            color: '#e0e0e0',
                            font: { size: 10 },
                            formatter: (value) => Math.round(value),
                            anchor: 'end', // Anchor the label to the top of the point
                            align: 'top',  // Position the label above the point
                            offset: 1     // Add distance above the point
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#1fad8b',
                            bodyColor: '#e0e0e0',
                            borderColor: '#1fad8b',
                            borderWidth: 1,
                            callbacks: {
                                title: function(tooltipItems) {
                                    const league = leagues.find(l => chartInstances[l] === tooltipItems[0].chart);
                                    const index = tooltipItems[0].dataIndex + averagePoints;
                                    const match = chartData[league][index];
                                    return `${match.hora}:${match.minuto.toString().padStart(2, '0')}`;
                                },
                                label: function(tooltipItem) {
                                    const league = leagues.find(l => chartInstances[l] === tooltipItem.chart);
                                    const index = tooltipItem.dataIndex + averagePoints;
                                    const match = chartData[league][index];
                                    const ftScore = match.ft || 'N/A';
                                    const htScore = formatHtResult(match.ht) || 'N/A';
                                    return [
                                        `FT: ${ftScore}`,
                                        `HT: ${htScore}`,
                                        `${tooltipItem.dataset.label}: ${Math.round(tooltipItem.raw)}`
                                    ];
                                }
                            }
                        }
                    },    
                    scales: {
                        x: {
                            title: { display: true, text: '', color: '#1fad8b', font: { size: 14 } },
                            ticks: { color: '#b0b0b0', maxRotation: 45, minRotation: 45 },
                            grid: { color: 'rgba(255, 255, 255, 0.1)', borderDash: [5, 5] }
                        },
                        y: {
                            title: { display: true, text: '', color: '#1fad8b', font: { size: 10 } },
                            beginAtZero: false,
                            ticks: { color: '#b0b0b0' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)', borderDash: [5, 5] },
                            afterFit: function(scale) { scale.paddingTop = 20; }
                        }
                    }
                },
                plugins: [ChartDataLabels, fibonacciLinesPlugin]
            });
        }

        function updateCharts() {
            const timestamp = new Date().getTime();
            const apiUrls = {
                'CopaAmerica': `https://betstat.site/resultados/Copa%20America?timestamp=${timestamp}`,
                'TacaGloria': `https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna?timestamp=${timestamp}`,
                'Euro': `https://betstat.site/resultados/Euro?timestamp=${timestamp}`,
                'CampeonatoItaliano': `https://betstat.site/resultados/Campeonato%20Italiano?timestamp=${timestamp}`,
                'CopaEstrelas': `https://betstat.site/resultados/Copa%20das%20estrelas?timestamp=${timestamp}`,
                'BritishDerbies': `https://betstat.site/resultados/British%20Derbies?timestamp=${timestamp}`,
                'LigaEspanhola': `https://betstat.site/resultados/Liga%20Espanhola?timestamp=${timestamp}`,
                'ScudettoItaliano': `https://betstat.site/resultados/Scudetto%20Italiano?timestamp=${timestamp}`
            };

            leagues.forEach(league => {
                const apiUrl = apiUrls[league];
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                        return response.json();
                    })
                    .then(data => {
                        const processedData = processApiData(data, league);
                        const chartId = `${league.toLowerCase()}Chart`;
                        if (!chartInstances[league]) {
                            const ctx = document.getElementById(chartId).getContext('2d');
                            chartInstances[league] = createStatsChart(ctx, processedData.labels, processedData, league);
                        } else {
                            updateStatsChart(chartInstances[league], processedData);
                        }
                    })
                    .catch(error => console.error(`Error fetching data for ${league}:`, error));
            });
        }

        function toggleFibonacciLines() {
            showFibonacciLines = document.getElementById('fibonacciToggle').checked;
            leagues.forEach(league => {
                if (chartInstances[league]) chartInstances[league].update();
            });
        }

        function toggleDataLabels() {
            showDataLabels = document.getElementById('dataLabelsToggle').checked;
            leagues.forEach(league => {
                if (chartInstances[league]) {
                    chartInstances[league].options.plugins.datalabels.display = showDataLabels;
                    chartInstances[league].update();
                }
            });
        }

        // Accordion Toggle Functionality
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                content.classList.toggle('active');
            });
        });

        document.getElementById('pointsSelector').addEventListener('change', function(event) {
            numPoints = parseInt(event.target.value, 10);
            updateCharts();
        });

        document.getElementById('averageSelector').addEventListener('change', function(event) {
            averagePoints = parseInt(event.target.value, 10);
            updateCharts();
        });

        document.getElementById('fibonacciToggle').addEventListener('change', toggleFibonacciLines);

        document.getElementById('dataLabelsToggle').addEventListener('change', toggleDataLabels);

        window.onload = updateCharts;
        setInterval(updateCharts, 3000);
    </script>

</body>
</html>
