<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="img/favicon.ico" type="image/x-icon" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"
    ></script>
    <title>BetStat</title>
    <!-- Meta tags SEO principais -->
    <meta
      name="description"
      content="Transforme suas apostas com BetStat - a √∫nica plataforma especializada em futebol virtual Betano. An√°lises precisas, estat√≠sticas confi√°veis e resultados comprovados para investimentos inteligentes."
    />
    <meta
      name="keywords"
      content="BetStat, apostas esportivas, futebol virtual, Betano, estat√≠sticas apostas, an√°lise apostas, investimentos esportivos"
    />

    <!-- Open Graph meta tags para redes sociais -->
    <meta
      property="og:title"
      content="BetStat | Plataforma de An√°lise para Apostas Esportivas"
    />
    <meta
      property="og:description"
      content="Transforme suas apostas com an√°lises precisas e estat√≠sticas confi√°veis. A √∫nica plataforma especializada em futebol virtual Betano."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.betstat.site/payment.html" />
    <meta property="og:site_name" content="BetStat" />

    <!-- Meta tags adicionais -->
    <meta name="robots" content="index, follow" />
    <meta name="author" content="BetStat" />
    <meta name="canonical" href="https://www.betstat.site/payment.html" />
    <script type="module" src="js/firebase-auth.js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-4WT805FFHQ");
    </script>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>

  <style>
        :root {
            --bg-main: #1c1f26;
            --bg-card: #252a33;
            --border: #3d4452;
            --accent: #1fac89;
            --text: #e0e0e0;
            --text-dim: #888;
            --danger: #ff4444;
            --warning: #ff9966;
            --info: #66ccff;
        }

        * { 
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg-main);
            color: var(--text);
            font-family: 'Consolas', 'Courier New', monospace;
            padding: 20px;
            line-height: 1.5;
        }

        .container { 
            max-width: 100%; 
            margin: 0 auto;
            padding: 0 10px;
        }

        /* Stats Cards no topo */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 18px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-sublabel {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 5px;
        }

        /* Menu de Ligas */
        #menu {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            flex-wrap: nowrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 0;
        }

        .btn-liga {
            background: #2d343e;
            color: #aaa;
            border: none;
            padding: 14px 20px;
            cursor: pointer;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            white-space: nowrap;
            flex: 1;
            text-align: center;
            position: relative;
        }

        .btn-liga:hover { 
            background: #363e4a; 
            color: #eee; 
            transform: translateY(-2px);
        }

        .btn-liga.active {
            background: var(--accent);
            color: #0f1a16;
            font-weight: bold;
            box-shadow: 0 0 16px rgba(31, 172, 137, 0.5);
        }

        /* Controles */
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            background: var(--bg-card);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-size: 0.7rem;
            color: var(--accent);
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 1px;
        }

        select, input {
            background: var(--bg-main);
            color: #fff;
            border: 1px solid var(--border);
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 0.9rem;
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            font-family: inherit;
        }

        select:hover, input:hover {
            border-color: #4a5260;
        }

        select:focus, input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(31,172,137,0.2);
        }

        /* Tabs para compara√ß√£o */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 10px;
        }

        .tab {
            background: transparent;
            border: none;
            color: var(--text-dim);
            padding: 10px 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            color: var(--text);
        }

        .tab.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        /* Grid de Cards */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.25);
            transition: transform 0.2s ease;
            display: flex;
            flex-direction: column;
        }

        .card:hover { 
            transform: translateY(-4px); 
        }

        .card.full-width {
            grid-column: 1 / -1;
        }

        h2 {
            font-size: 1rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1.3px;
            margin: 0 0 18px 0;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
            text-align: center;
        }

        h3 {
            font-size: 0.85rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 15px 0 10px 0;
        }

        /* Gauge */
        .gauge-container { 
            text-align: center; 
            padding: 16px 0;
            flex: 1;
        }

        #status-text {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 16px;
            letter-spacing: 1px;
        }

        .gauge-bar {
            height: 32px;
            background: #16191f;
            border-radius: 16px;
            overflow: hidden;
            margin: 18px 0;
            border: 1px solid var(--border);
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.5);
            position: relative;
        }

        .gauge-fill {
            height: 100%;
            width: 0%;
            transition: width 1.5s cubic-bezier(0.16, 0.8, 0.2, 1);
            background: linear-gradient(90deg, #1fac89 0%, #2cd9b3 100%);
            box-shadow: 0 0 20px rgba(31,172,137,0.6);
        }

        .gauge-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 8px;
        }

        #perc-display {
            color: var(--accent);
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Insights */
        #insight-text {
            font-size: 0.85rem;
            color: var(--text-dim);
            line-height: 1.7;
            margin-top: 18px;
            padding-top: 16px;
            border-top: 1px solid #2e2e2e;
            text-align: left;
        }

        .media-historica {
            display: inline-block;
            background: rgba(31, 172, 137, 0.15);
            color: var(--accent);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        /* Sequ√™ncia visual */
        .sequence-container {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .sequence-dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            transition: transform 0.2s ease;
        }

        .sequence-dot:hover {
            transform: scale(1.3);
        }

        .sequence-dot.green {
            background: var(--accent);
            box-shadow: 0 0 8px rgba(31, 172, 137, 0.5);
        }

        .sequence-dot.red {
            background: var(--danger);
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.5);
        }

        /* Log de Valida√ß√£o */
        #log-lista {
            max-height: 450px;
            overflow-y: auto;
            font-size: 0.88rem;
            padding-right: 8px;
            flex: 1;
        }

        #log-lista::-webkit-scrollbar { 
            width: 7px; 
        }
        
        #log-lista::-webkit-scrollbar-track { 
            background: #16191f; 
            border-radius: 4px;
        }
        
        #log-lista::-webkit-scrollbar-thumb { 
            background: #3d4452; 
            border-radius: 4px; 
        }

        #log-lista::-webkit-scrollbar-thumb:hover { 
            background: #4a5260; 
        }

        .target-item {
            border-left: 4px solid var(--accent);
            background: var(--bg-main);
            margin-bottom: 10px;
            padding: 12px 14px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .target-item:hover { 
            background: #1f242c; 
            transform: translateX(4px);
        }

        .target-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .target-time {
            font-size: 0.75rem;
            color: var(--text-dim);
        }

        .target-teams {
            font-size: 0.9rem;
            color: var(--text);
        }

        .target-result {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .target-score {
            font-size: 1rem;
            font-weight: bold;
        }

        .win-tag { 
            color: var(--accent); 
            font-weight: bold; 
        }
        
        .loss-tag { 
            color: var(--danger); 
            font-weight: bold; 
        }

        .result-badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .badge-win {
            background: rgba(31, 172, 137, 0.2);
            color: var(--accent);
        }

        .badge-loss {
            background: rgba(255, 68, 68, 0.2);
            color: var(--danger);
        }

        /* Gr√°fico simples */
        .chart-container {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            gap: 4px;
            padding: 20px 10px;
            background: var(--bg-main);
            border-radius: 6px;
            margin-top: 15px;
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, var(--accent), #2cd9b3);
            border-radius: 4px 4px 0 0;
            min-height: 20px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .chart-bar:hover {
            opacity: 0.8;
            transform: translateY(-5px);
        }

        .chart-bar-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--text-dim);
            white-space: nowrap;
        }

        .chart-bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--accent);
            font-weight: bold;
        }

        /* Compara√ß√£o de mercados */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .comparison-item {
            background: var(--bg-main);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.2s ease;
        }

        .comparison-item:hover {
            border-color: var(--accent);
            transform: scale(1.05);
        }

        .comparison-name {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-bottom: 8px;
        }

        .comparison-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--accent);
        }

        /* Alertas */
        .alert {
            background: rgba(255, 153, 102, 0.1);
            border-left: 4px solid var(--warning);
            padding: 12px 16px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.85rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .alert.info {
            background: rgba(102, 204, 255, 0.1);
            border-left-color: var(--info);
        }

        .alert.success {
            background: rgba(31, 172, 137, 0.1);
            border-left-color: var(--accent);
        }

        /* Heatmap */
        .heatmap {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 4px;
            margin-top: 15px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .heatmap-cell:hover {
            transform: scale(1.2);
            z-index: 10;
        }

        /* Sugest√µes */
        .suggestions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .suggestion-item {
            background: var(--bg-main);
            padding: 14px;
            border-radius: 6px;
            border-left: 4px solid var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .suggestion-item:hover {
            transform: translateX(5px);
            background: #1f242c;
        }

        .suggestion-market {
            font-weight: bold;
            color: var(--text);
        }

        .suggestion-confidence {
            background: rgba(31, 172, 137, 0.2);
            color: var(--accent);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .grid { 
                grid-template-columns: 1fr; 
            }
            
            #menu {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 768px) {
            .controls { 
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .btn-liga {
                padding: 10px 15px;
                font-size: 0.85rem;
            }
        }
  </style>

  <body>
    <body>
        <div id="header"></div>

        <br>
        <br>
        <br>
        <br>
        
<div class="container">
    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Total de Jogos</div>
            <div class="stat-value" id="stat-total">0</div>
            <div class="stat-sublabel">Per√≠odo selecionado</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Taxa de Acerto</div>
            <div class="stat-value" id="stat-taxa">0%</div>
            <div class="stat-sublabel">Green rate</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Melhor Hor√°rio</div>
            <div class="stat-value" id="stat-horario">--:--</div>
            <div class="stat-sublabel">Maior assertividade</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Sequ√™ncia Atual</div>
            <div class="stat-value" id="stat-sequencia">0</div>
            <div class="stat-sublabel" id="stat-sequencia-tipo">Analisando...</div>
        </div>
    </div>

    <!-- Menu de Ligas -->
    <div id="menu"></div>

    <!-- Controles -->
    <div class="controls">
        <div class="control-group">
            <label>Mercado Alvo</label>
            <select id="select-mercado" onchange="carregar()">
                <option value="ambasMarcam">Ambas Sim</option>
                <option value="ambasNaoMarcam">Ambas N√£o</option>
                <option value="casaVence">Casa vence</option>
                <option value="foraVence">Fora vence</option>
                <option value="empate">Empate</option>
                <option value="over1_5">Over 1.5</option>
                <option value="under1_5">Under 1.5</option>
                <option value="over2_5" selected>Over 2.5</option>
                <option value="under2_5">Under 2.5</option>
                <option value="over3_5">Over 3.5</option>
                <option value="under3_5">Under 3.5</option>
                <option value="over5">Over 5+</option>
                <option value="exato0">Exato 0</option>
                <option value="exato1">Exato 1</option>
                <option value="exato2">Exato 2</option>
                <option value="exato3">Exato 3</option>
                <option value="exato4">Exato 4</option>
            </select>
        </div>

        <div class="control-group">
            <label>Per√≠odo de Minera√ß√£o</label>
            <select id="select-horas" onchange="carregar()">
                <option value="12">√öltimas 12 horas</option>
                <option value="24" selected>√öltimas 24 horas</option>
                <option value="48">√öltimas 48 horas</option>
                <option value="72">√öltimas 72 horas</option>
            </select>
        </div>

        <div class="control-group">
            <label>Filtrar por Time</label>
            <input type="text" id="filtro-time" placeholder="Digite o nome do time..." oninput="aplicarFiltros()">
        </div>

        <div class="control-group">
            <label>Mostrar Apenas</label>
            <select id="filtro-resultado" onchange="aplicarFiltros()">
                <option value="todos">Todos os Resultados</option>
                <option value="greens">Apenas Greens</option>
                <option value="reds">Apenas Reds</option>
            </select>
        </div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" onclick="mudarTab('analise')">üìä An√°lise Principal</button>
        <button class="tab" onclick="mudarTab('comparacao')">üîç Compara√ß√£o</button>
        <button class="tab" onclick="mudarTab('sugestoes')">üí° Sugest√µes</button>
        <button class="tab" onclick="mudarTab('heatmap')">üî• Heatmap</button>
    </div>

    <!-- Conte√∫do da Tab An√°lise -->
    <div id="tab-analise" class="tab-content">
        <div class="grid">
            <div class="card">
                <h2>Sa√∫de do Mercado: <span id="label-mercado"></span></h2>
                <div class="gauge-container">
                    <div id="status-text">PROCESSANDO</div>
                    <div class="gauge-bar">
                        <div id="gauge-fill" class="gauge-fill"></div>
                    </div>
                    <div class="gauge-labels">
                        <span>Frequ√™ncia Baixa</span>
                        <span id="perc-display">0%</span>
                        <span>Frequ√™ncia Alta</span>
                    </div>
                </div>
                
                <h3>Sequ√™ncia das √öltimas 15 Partidas</h3>
                <div class="sequence-container" id="sequence-display"></div>
                
                <p id="insight-text"></p>
                <div id="alerts-container"></div>
            </div>

            <div class="card">
                <h2>Resultados ao vivo</h2>
                <div id="log-lista"></div>
            </div>
        </div>

        <!-- Gr√°fico de Tend√™ncia -->
        <div class="card full-width">
            <h2>üìà Tend√™ncia por Hor√°rio - <span id="grafico-periodo"></span></h2>
            <div class="chart-container" id="chart-container"></div>
        </div>
    </div>

    <!-- Conte√∫do da Tab Compara√ß√£o -->
    <div id="tab-comparacao" class="tab-content" style="display: none;">
        <div class="card full-width">
            <h2>üîç Compara√ß√£o de Mercados</h2>
            <div class="comparison-grid" id="comparison-grid"></div>
        </div>
    </div>

    <!-- Conte√∫do da Tab Sugest√µes -->
    <div id="tab-sugestoes" class="tab-content" style="display: none;">
        <div class="card full-width">
            <h2>üí° Sugest√µes Inteligentes</h2>
            <div class="suggestions" id="suggestions-container"></div>
        </div>
    </div>

    <!-- Conte√∫do da Tab Heatmap -->
    <div id="tab-heatmap" class="tab-content" style="display: none;">
        <div class="card full-width">
            <h2>üî• Heatmap de Hor√°rios - <span id="heatmap-mercado"></span></h2>
            <p style="text-align: center; color: var(--text-dim); margin-bottom: 15px;">
                Quanto mais verde, maior a taxa de acerto naquele hor√°rio
            </p>
            <div class="heatmap" id="heatmap-container"></div>
        </div>
    </div>
</div>

    <script>
// Configura√ß√£o de ligas: [Nome para exibi√ß√£o, Nome na API]
const LIGAS = [
    { display: "Cl√°ssicos da Am√©rica", api: "Ta√ßa Gl√≥ria Eterna" },
    { display: "Copa Am√©rica", api: "Copa Am√©rica" },
    { display: "Euro", api: "Euro" },
    { display: "Campeonato Italiano", api: "Campeonato Italiano" },
    { display: "Copa das Estrelas", api: "Copa das Estrelas" },
    { display: "Brasileir√£o Betano", api: "Brasileir√£o Betano" }
];
let ligaAtualIndex = 0; // Usar √≠ndice ao inv√©s do objeto
const API = "https://betstat.site";
let dadosGlobais = [];
let cacheLocal = {};

const MEDIAS_HISTORICAS = {
    ambasMarcam: 45,
    ambasNaoMarcam: 55,
    casaVence: 42,
    foraVence: 28,
    empate: 30,
    over1_5: 72,
    under1_5: 28,
    over2_5: 58,
    under2_5: 42,
    over3_5: 35,
    under3_5: 65,
    over5: 8,
    exato0: 12,
    exato1: 18,
    exato2: 25,
    exato3: 20,
    exato4: 12
};

const REGRAS = { 
    ambasMarcam: function(g) { return g[0] > 0 && g[1] > 0; },
    ambasNaoMarcam: function(g) { return g[0] === 0 || g[1] === 0; },
    casaVence: function(g) { return g[0] > g[1]; },
    foraVence: function(g) { return g[1] > g[0]; },
    empate: function(g) { return g[0] === g[1]; },
    over1_5: function(g) { return (g[0]+g[1]) > 1.5; },
    under1_5: function(g) { return (g[0]+g[1]) < 1.5; },
    over2_5: function(g) { return (g[0]+g[1]) > 2.5; },
    under2_5: function(g) { return (g[0]+g[1]) < 2.5; },
    over3_5: function(g) { return (g[0]+g[1]) > 3.5; },
    under3_5: function(g) { return (g[0]+g[1]) < 3.5; },
    over5: function(g) { return (g[0]+g[1]) > 5; },
    exato0: function(g) { return (g[0]+g[1]) === 0; },
    exato1: function(g) { return (g[0]+g[1]) === 1; },
    exato2: function(g) { return (g[0]+g[1]) === 2; },
    exato3: function(g) { return (g[0]+g[1]) === 3; },
    exato4: function(g) { return (g[0]+g[1]) === 4; }
};

// Fun√ß√£o auxiliar para obter liga atual
function getLigaAtual() {
    return LIGAS[ligaAtualIndex];
}

// Fun√ß√£o auxiliar para criar timestamp do jogo baseado em data + hora + minuto
function obterTimestampJogo(jogo) {
    // A data vem em UTC (ex: "2025-08-14T03:00:00.000Z")
    // Mas hora e minuto s√£o locais, ent√£o precisamos ajustar
    const dataBase = new Date(jogo.data);
    
    // Criar nova data com hora e minuto do jogo
    const dataJogo = new Date(dataBase);
    dataJogo.setHours(parseInt(jogo.hora));
    dataJogo.setMinutes(parseInt(jogo.minuto));
    dataJogo.setSeconds(0);
    dataJogo.setMilliseconds(0);
    
    return dataJogo.getTime();
}

// Fun√ß√£o principal de carregamento
async function carregar(forcar) {
    const selectMercado = document.getElementById('select-mercado');
    const mercadoKey = selectMercado.value;
    const mercadoTxt = selectMercado.options[selectMercado.selectedIndex].text;
    const horasLimit = parseInt(document.getElementById('select-horas').value);
    
    const ligaAtual = getLigaAtual();
    
    document.getElementById('label-mercado').innerText = mercadoTxt;
    document.getElementById('heatmap-mercado').innerText = mercadoTxt;
    document.getElementById('grafico-periodo').innerText = '√öltimas ' + horasLimit + ' horas';
    
    try {
        // Verificar cache - usando nome da API
        const cacheKey = ligaAtual.api + '_' + horasLimit;
        let res;
        
        if (!forcar && cacheLocal[cacheKey] && (Date.now() - cacheLocal[cacheKey].timestamp < 60000)) {
            res = cacheLocal[cacheKey].data;
        } else {
            // Usar o nome correto da API para a requisi√ß√£o
            const response = await fetch(API + '/resultados/' + encodeURIComponent(ligaAtual.api));
            res = await response.json();
            cacheLocal[cacheKey] = { data: res, timestamp: Date.now() };
        }
        
        const agora = Date.now();
        const limite = agora - (horasLimit * 60 * 60 * 1000);

        const filtrados = res.filter(function(j) {
            const timestampJogo = obterTimestampJogo(j);
            return timestampJogo >= limite && timestampJogo <= agora;
        }).sort(function(a, b) {
            // Ordenar do mais recente para o mais antigo
            return obterTimestampJogo(b) - obterTimestampJogo(a);
        });

        dadosGlobais = filtrados.length > 0 ? filtrados : res.slice(0, 20);
        
        atualizarStats(dadosGlobais, mercadoKey);
        atualizarGauge(dadosGlobais, mercadoKey, mercadoTxt, horasLimit);
        atualizarSequencia(dadosGlobais, mercadoKey);
        atualizarLog(dadosGlobais, mercadoKey);
        atualizarGrafico(dadosGlobais, mercadoKey, horasLimit);
        atualizarComparacao(dadosGlobais);
        atualizarSugestoes(dadosGlobais);
        atualizarHeatmap(dadosGlobais, mercadoKey);
        gerarAlertas(dadosGlobais, mercadoKey, mercadoTxt);

    } catch(e) {
        console.error("Erro na leitura da API", e);
        document.getElementById('insight-text').innerText = "Erro ao carregar dados da API. Verifique a conex√£o.";
    }
}

// Atualizar estat√≠sticas do topo
function atualizarStats(dados, mercadoKey) {
    const total = dados.length;
    const greens = dados.filter(function(j) {
        const g = j.ft.split(' x ').map(Number);
        return REGRAS[mercadoKey](g);
    }).length;
    
    const percentual = total > 0 ? (greens / total * 100) : 0;
    
    document.getElementById('stat-total').innerText = total;
    document.getElementById('stat-taxa').innerText = percentual.toFixed(1) + '%';
    
    // Melhor hor√°rio
    const horarios = {};
    dados.forEach(function(j) {
        const hora = j.hora;
        if (!horarios[hora]) horarios[hora] = { total: 0, greens: 0 };
        horarios[hora].total++;
        const g = j.ft.split(' x ').map(Number);
        if (REGRAS[mercadoKey](g)) horarios[hora].greens++;
    });
    
    let melhorHora = '--';
    let melhorTaxa = 0;
    for (let hora in horarios) {
        const taxa = (horarios[hora].greens / horarios[hora].total) * 100;
        if (taxa > melhorTaxa) {
            melhorTaxa = taxa;
            melhorHora = hora + ':00';
        }
    }
    
    document.getElementById('stat-horario').innerText = melhorHora;
    
    // Sequ√™ncia atual
    let sequencia = 0;
    let tipo = '';
    const ultimos = dados.slice(0, 20);
    
    for (let i = 0; i < ultimos.length; i++) {
        const g = ultimos[i].ft.split(' x ').map(Number);
        const bateu = REGRAS[mercadoKey](g);
        
        if (i === 0) {
            tipo = bateu ? 'green' : 'red';
            sequencia = 1;
        } else {
            const anterior = REGRAS[mercadoKey](ultimos[i-1].ft.split(' x ').map(Number));
            if (bateu === anterior) {
                sequencia++;
            } else {
                break;
            }
        }
    }
    
    document.getElementById('stat-sequencia').innerText = sequencia;
    document.getElementById('stat-sequencia-tipo').innerText = tipo === 'green' ? 'Greens seguidos' : 'Reds seguidos';
    document.getElementById('stat-sequencia-tipo').style.color = tipo === 'green' ? 'var(--accent)' : 'var(--danger)';
}

// Atualizar gauge
function atualizarGauge(dados, mercadoKey, mercadoTxt, horasLimit) {
    const total = dados.length;
    const greens = dados.filter(function(j) {
        const g = j.ft.split(' x ').map(Number);
        return REGRAS[mercadoKey](g);
    }).length;

    const percentual = total > 0 ? (greens / total * 100) : 0;
    const mediaHistorica = MEDIAS_HISTORICAS[mercadoKey] || 50;

    document.getElementById('gauge-fill').style.width = percentual + '%';
    document.getElementById('perc-display').innerText = percentual.toFixed(1) + '%';

    const txt = document.getElementById('status-text');
    const insight = document.getElementById('insight-text');

    if(percentual > 55) {
        txt.innerText = "MERCADO SATURADO";
        txt.style.color = "#ff9966";
        insight.innerHTML = 'O mercado de <strong>' + mercadoTxt + '</strong> apresenta volume <strong>acima da m√©dia</strong> nas √∫ltimas ' + horasLimit + 'h (' + percentual.toFixed(1) + '% vs m√©dia hist√≥rica de <span class="media-historica">' + mediaHistorica + '%</span>). No futebol virtual, o algoritmo tende a buscar equil√≠brio. Expectativa de corre√ß√£o para mercados opostos em sequ√™ncia.';
    } else if(percentual < 40) {
        txt.innerText = "MERCADO COMPRIMIDO";
        txt.style.color = "#66ccff";
        insight.innerHTML = 'Baixa ocorr√™ncia de <strong>' + mercadoTxt + '</strong> detectada (' + percentual.toFixed(1) + '% vs m√©dia hist√≥rica de <span class="media-historica">' + mediaHistorica + '%</span>). O algoritmo do futebol virtual busca reequil√≠brio, aumentando a probabilidade de sequ√™ncia positiva para este mercado nas pr√≥ximas partidas.';
    } else {
        txt.innerText = "MERCADO EST√ÅVEL";
        txt.style.color = "#1fac89";
        insight.innerHTML = 'Frequ√™ncia normalizada para <strong>' + mercadoTxt + '</strong> (' + percentual.toFixed(1) + '% pr√≥ximo da m√©dia hist√≥rica de <span class="media-historica">' + mediaHistorica + '%</span>). O padr√£o do algoritmo est√° dentro do esperado. Recomenda-se an√°lise individual dos confrontos considerando o hist√≥rico recente e os padr√µes espec√≠ficos da liga virtual.';
    }
}

// Atualizar sequ√™ncia visual
function atualizarSequencia(dados, mercadoKey) {
    const container = document.getElementById('sequence-display');
    const ultimos = dados.slice(0, 15);
    
    container.innerHTML = ultimos.map(function(j) {
        const g = j.ft.split(' x ').map(Number);
        const bateu = REGRAS[mercadoKey](g);
        return '<div class="sequence-dot ' + (bateu ? 'green' : 'red') + '" title="' + j.time_a + ' √ó ' + j.time_b + ' - ' + j.ft + '"></div>';
    }).join('');
}

// Atualizar log
function atualizarLog(dados, mercadoKey) {
    aplicarFiltros();
}

// Aplicar filtros no log
function aplicarFiltros() {
    const mercadoKey = document.getElementById('select-mercado').value;
    const filtroTime = document.getElementById('filtro-time').value.toLowerCase();
    const filtroResultado = document.getElementById('filtro-resultado').value;
    
    let dadosFiltrados = dadosGlobais.filter(function(j) {
        // Filtro por time
        if (filtroTime && !j.time_a.toLowerCase().includes(filtroTime) && !j.time_b.toLowerCase().includes(filtroTime)) {
            return false;
        }
        
        // Filtro por resultado
        if (filtroResultado !== 'todos') {
            const g = j.ft.split(' x ').map(Number);
            const bateu = REGRAS[mercadoKey](g);
            if (filtroResultado === 'greens' && !bateu) return false;
            if (filtroResultado === 'reds' && bateu) return false;
        }
        
        return true;
    });
    
    document.getElementById('log-lista').innerHTML = dadosFiltrados.map(function(j, index) {
        const placar = j.ft.split(' x ').map(Number);
        const bateu = REGRAS[mercadoKey](placar);
        
        // Formatar hora com zero √† esquerda se necess√°rio
        const horaFormatada = String(j.hora).padStart(2, '0');
        const minutoFormatado = String(j.minuto).padStart(2, '0');
        
        return '<div class="target-item" style="animation-delay: ' + (index * 0.05) + 's"><div class="target-info"><span class="target-time">' + horaFormatada + ':' + minutoFormatado + '</span><span class="target-teams">' + j.time_a + ' √ó ' + j.time_b + '</span></div><div class="target-result"><span class="target-score ' + (bateu ? 'win-tag' : 'loss-tag') + '">' + j.ft + '</span><span class="result-badge ' + (bateu ? 'badge-win' : 'badge-loss') + '">' + (bateu ? 'GREEN' : 'RED') + '</span></div></div>';
    }).join('');
}

// Atualizar gr√°fico com horas de datas anteriores - VERS√ÉO FINAL CORRIGIDA
function atualizarGrafico(dados, mercadoKey, horasLimit) {
    const container = document.getElementById('chart-container');
    const agora = Date.now();
    
    // Criar estrutura para armazenar dados por intervalo de hora
    const intervalosPorHora = [];
    
    // Criar array de intervalos de hora (da mais antiga para a mais recente)
    for (let i = horasLimit - 1; i >= 0; i--) {
        const inicioIntervalo = agora - (i * 60 * 60 * 1000);
        const fimIntervalo = agora - ((i - 1) * 60 * 60 * 1000);
        const dataIntervalo = new Date(inicioIntervalo);
        
        intervalosPorHora.push({
            inicio: inicioIntervalo,
            fim: fimIntervalo,
            hora: dataIntervalo.getHours(),
            dia: dataIntervalo.getDate(),
            mes: dataIntervalo.getMonth() + 1,
            total: 0,
            greens: 0
        });
    }
    
    // Contar jogos por intervalo baseado no timestamp completo
    dados.forEach(function(j) {
        const timestampJogo = obterTimestampJogo(j);
        
        // Encontrar o intervalo correto para este jogo
        for (let i = 0; i < intervalosPorHora.length; i++) {
            const intervalo = intervalosPorHora[i];
            
            // Verificar se o jogo est√° dentro deste intervalo de hora
            if (timestampJogo >= intervalo.inicio && timestampJogo < intervalo.fim) {
                intervalo.total++;
                const g = j.ft.split(' x ').map(Number);
                if (REGRAS[mercadoKey](g)) intervalo.greens++;
                break;
            }
        }
    });
    
    // Criar barras do gr√°fico
    container.innerHTML = '';
    const hoje = new Date();
    const diaHoje = hoje.getDate();
    const mesHoje = hoje.getMonth() + 1;
    
    intervalosPorHora.forEach(function(intervalo) {
        const perc = intervalo.total > 0 ? (intervalo.greens / intervalo.total * 100) : 0;
        const bar = document.createElement('div');
        bar.className = 'chart-bar';
        bar.style.height = Math.max((perc * 1.5), 20) + 'px';
        
        // Formatar label
        let label = intervalo.hora + 'h';
        let labelCompleto = String(intervalo.hora).padStart(2, '0') + ':00';
        
        // Adicionar data se for de dia diferente
        if (intervalo.dia !== diaHoje || intervalo.mes !== mesHoje) {
            label = intervalo.dia + '/' + intervalo.mes + ' ' + intervalo.hora + 'h';
            labelCompleto = intervalo.dia + '/' + intervalo.mes + ' ' + String(intervalo.hora).padStart(2, '0') + ':00';
        }
        
        bar.innerHTML = '<span class="chart-bar-value">' + perc.toFixed(0) + '%</span><span class="chart-bar-label">' + label + '</span>';
        bar.title = labelCompleto + ' - ' + intervalo.greens + '/' + intervalo.total + ' (' + perc.toFixed(1) + '%)';
        container.appendChild(bar);
    });
}

// Atualizar compara√ß√£o de mercados
function atualizarComparacao(dados) {
    const container = document.getElementById('comparison-grid');
    const mercados = ['over2_5', 'under2_5', 'ambasMarcam', 'ambasNaoMarcam', 'casaVence', 'foraVence', 'empate', 'over1_5'];
    const nomes = {
        over2_5: 'Over 2.5',
        under2_5: 'Under 2.5',
        ambasMarcam: 'Ambas Sim',
        ambasNaoMarcam: 'Ambas N√£o',
        casaVence: 'Casa',
        foraVence: 'Fora',
        empate: 'Empate',
        over1_5: 'Over 1.5'
    };
    
    container.innerHTML = mercados.map(function(m) {
        const greens = dados.filter(function(j) {
            const g = j.ft.split(' x ').map(Number);
            return REGRAS[m](g);
        }).length;
        const perc = dados.length > 0 ? (greens / dados.length * 100) : 0;
        
        return '<div class="comparison-item"><div class="comparison-name">' + nomes[m] + '</div><div class="comparison-value">' + perc.toFixed(1) + '%</div></div>';
    }).join('');
}

// Atualizar sugest√µes
function atualizarSugestoes(dados) {
    const container = document.getElementById('suggestions-container');
    const mercados = ['over2_5', 'under2_5', 'ambasMarcam', 'ambasNaoMarcam', 'casaVence', 'foraVence'];
    const nomes = {
        over2_5: 'Over 2.5',
        under2_5: 'Under 2.5',
        ambasMarcam: 'Ambas Marcam',
        ambasNaoMarcam: 'Ambas N√£o Marcam',
        casaVence: 'Casa Vence',
        foraVence: 'Fora Vence'
    };
    
    const sugestoes = mercados.map(function(m) {
        const greens = dados.filter(function(j) {
            const g = j.ft.split(' x ').map(Number);
            return REGRAS[m](g);
        }).length;
        const perc = dados.length > 0 ? (greens / dados.length * 100) : 0;
        const media = MEDIAS_HISTORICAS[m] || 50;
        const diferenca = Math.abs(perc - media);
        
        let confianca = 'Baixa';
        if (diferenca > 20) confianca = 'Alta';
        else if (diferenca > 10) confianca = 'M√©dia';
        
        return { mercado: m, nome: nomes[m], perc: perc, media: media, diferenca: diferenca, confianca: confianca };
    }).sort(function(a, b) { return b.diferenca - a.diferenca; }).slice(0, 3);
    
    container.innerHTML = sugestoes.map(function(s) {
        const tipo = s.perc < s.media ? 'üìâ Comprimido' : 'üìà Saturado';
        const recomendacao = s.perc < s.media ? 'Expectativa de alta' : 'Expectativa de corre√ß√£o';
        
        return '<div class="suggestion-item"><div><div class="suggestion-market">' + s.nome + '</div><div style="font-size: 0.75rem; color: var(--text-dim); margin-top: 4px;">' + tipo + ' - ' + recomendacao + '</div></div><div class="suggestion-confidence">' + s.confianca + '</div></div>';
    }).join('');
}

// Atualizar heatmap
function atualizarHeatmap(dados, mercadoKey) {
    const container = document.getElementById('heatmap-container');
    const horas = {};
    
    for (let h = 0; h < 24; h++) {
        horas[h] = { total: 0, greens: 0 };
    }
    
    dados.forEach(function(j) {
        const hora = parseInt(j.hora);
        horas[hora].total++;
        const g = j.ft.split(' x ').map(Number);
        if (REGRAS[mercadoKey](g)) horas[hora].greens++;
    });
    
    container.innerHTML = '';
    for (let h = 0; h < 24; h++) {
        const perc = horas[h].total > 0 ? (horas[h].greens / horas[h].total * 100) : 0;
        const opacity = perc / 100;
        const cell = document.createElement('div');
        cell.className = 'heatmap-cell';
        cell.style.background = 'rgba(31, 172, 137, ' + opacity + ')';
        cell.style.color = opacity > 0.5 ? '#000' : '#fff';
        cell.innerText = h;
        cell.title = h + ':00 - ' + perc.toFixed(1) + '% (' + horas[h].greens + '/' + horas[h].total + ')';
        container.appendChild(cell);
    }
}

// Gerar alertas inteligentes
function gerarAlertas(dados, mercadoKey, mercadoTxt) {
    const container = document.getElementById('alerts-container');
    const alertas = [];
    
    // Verifica sequ√™ncia longa
    let sequencia = 0;
    let tipo = '';
    const ultimos = dados.slice(0, 20);
    
    for (let i = 0; i < ultimos.length; i++) {
        const g = ultimos[i].ft.split(' x ').map(Number);
        const bateu = REGRAS[mercadoKey](g);
        
        if (i === 0) {
            tipo = bateu ? 'green' : 'red';
            sequencia = 1;
        } else {
            const anterior = REGRAS[mercadoKey](ultimos[i-1].ft.split(' x ').map(Number));
            if (bateu === anterior) {
                sequencia++;
            } else {
                break;
            }
        }
    }
    
    if (sequencia >= 5) {
        const classe = tipo === 'green' ? 'success' : 'info';
        const emoji = tipo === 'green' ? '‚úÖ' : '‚ö†Ô∏è';
        alertas.push('<div class="alert ' + classe + '">' + emoji + ' <strong>Sequ√™ncia Detectada:</strong> ' + sequencia + ' ' + (tipo === 'green' ? 'greens' : 'reds') + ' consecutivos. Probabilidade de invers√£o aumenta.</div>');
    }
    
    // Verifica desvio da m√©dia
    const perc = calcularPercentual(dados, mercadoKey);
    const media = MEDIAS_HISTORICAS[mercadoKey] || 50;
    const diferenca = Math.abs(perc - media);
    
    if (diferenca > 20) {
        alertas.push('<div class="alert">üéØ <strong>Desvio Significativo:</strong> O mercado est√° ' + diferenca.toFixed(1) + '% ' + (perc > media ? 'acima' : 'abaixo') + ' da m√©dia hist√≥rica. Aten√ß√£o redobrada!</div>');
    }
    
    container.innerHTML = alertas.join('');
}

// Calcular percentual
function calcularPercentual(dados, mercadoKey) {
    const total = dados.length;
    const greens = dados.filter(function(j) {
        const g = j.ft.split(' x ').map(Number);
        return REGRAS[mercadoKey](g);
    }).length;
    return total > 0 ? (greens / total * 100) : 0;
}

// Mudar tab
function mudarTab(tab) {
    const tabs = document.querySelectorAll('.tab');
    const contents = document.querySelectorAll('.tab-content');
    
    tabs.forEach(function(t) { t.classList.remove('active'); });
    contents.forEach(function(c) { c.style.display = 'none'; });
    
    event.target.classList.add('active');
    document.getElementById('tab-' + tab).style.display = 'block';
}

// Inicializa√ß√£o
const menu = document.getElementById('menu');
LIGAS.forEach(function(liga, index) {
    const b = document.createElement('button');
    b.className = 'btn-liga' + (index === ligaAtualIndex ? ' active' : '');
    b.textContent = liga.display; // Mostra o nome de exibi√ß√£o
    b.onclick = function() {
        document.querySelectorAll('.btn-liga').forEach(function(x) { 
            x.classList.remove('active'); 
        });
        b.classList.add('active');
        ligaAtualIndex = index; // Armazena apenas o √≠ndice
        carregar();
    };
    menu.appendChild(b);
});

// Auto-atualizar dados
setInterval(function() { carregar(false); }, 30000);

// Carregar inicial
carregar(true);
    </script>

<script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });
  </script>
  <script src="redirecionar.js"></script>

<script>
      // Bloqueia o menu de contexto (clique direito)
      document.addEventListener("contextmenu", function(e) {
    e.preventDefault();
});

// Bloqueia atalhos de teclado comuns para ferramentas de desenvolvimento
document.addEventListener("keydown", function(e) {
    // F12
    if (e.key === "F12") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + I
    if (e.ctrlKey && e.shiftKey && e.key === "I") {
        e.preventDefault();
    }
    
    // Ctrl + U (ver c√≥digo fonte)
    if (e.ctrlKey && e.key === "u") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + J (console)
    if (e.ctrlKey && e.shiftKey && e.key === "J") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + C (inspe√ß√£o de elementos)
    if (e.ctrlKey && e.shiftKey && e.key === "C") {
        e.preventDefault();
    }
    
    // Ctrl + S (salvar p√°gina)
    if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
    }
    
    // Ctrl + P (imprimir)
    if (e.ctrlKey && e.key === "p") {
        e.preventDefault();
    }
});

// Detecta abertura de ferramentas de desenvolvimento
const devtools = { open: false };
const element = new Image();
Object.defineProperty(element, 'id', {
    get: function () {
        devtools.open = true;
    }
});

// Adiciona detec√ß√£o alternativa de devtools
(function() {
    const threshold = 160;
    const checkDevTools = function() {
        if ((window.outerWidth - window.innerWidth) > threshold || 
            (window.outerHeight - window.innerHeight) > threshold) {
            devtools.open = true;
        }
    };
    
    window.addEventListener('resize', checkDevTools);
    setInterval(checkDevTools, 500);
})();

// Monitoramento cont√≠nuo
console.log('%c', element);
setInterval(function() {
    if (devtools.open) {
        document.body.innerHTML = '<h1>Acesso n√£o autorizado detectado</h1>';
        // Ou redirecionar:
        // window.location.href = 'about:blank';
        devtools.open = false;
    }
}, 1000);

// Impede sele√ß√£o de texto
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});

// Impede arrastar e soltar
document.addEventListener('dragstart', function(e) {
    e.preventDefault();
});

// Ofusca console
console.log = function() {};
console.debug = function() {};
console.info = function() {};
  </script>




  </body>
</html>
