<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <link rel="stylesheet" href=tips.css />">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
        <script
          async
          src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"
        ></script>
        <title>BetStat</title>
        <!-- Meta tags SEO principais -->
        <meta
          name="description"
          content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes."
        />
        <meta
          name="keywords"
          content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos"
        />
    
        <!-- Open Graph meta tags para redes sociais -->
        <meta
          property="og:title"
          content="BetStat | Plataforma de Análise para Apostas Esportivas"
        />
        <meta
          property="og:description"
          content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano."
        />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.betstat.site/payment.html" />
        <meta property="og:site_name" content="BetStat" />
    
        <!-- Meta tags adicionais -->
        <meta name="robots" content="index, follow" />
        <meta name="author" content="BetStat" />
        <meta name="canonical" href="https://www.betstat.site/payment.html" />
        <script type="module">
          import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
          import {
            getAuth,
            onAuthStateChanged,
            signOut,
          } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
    
          const firebaseConfig = {
            apiKey: "AIzaSyDmLGMBnUa2YOdP0b-zlZepXjm-zlV477A",
            authDomain: "linoautenticador.firebaseapp.com",
            projectId: "linoautenticador",
            storageBucket: "linoautenticador.firebasestorage.app",
            messagingSenderId: "946057648829",
            appId: "1:946057648829:web:ac5c2b1ba66e651f9d75d4",
            measurementId: "G-4WT805FFHQ",
          };
    
          const app = initializeApp(firebaseConfig);
          const auth = getAuth(app);
    
          onAuthStateChanged(auth, (user) => {
            if (!user) {
              window.location.href = "auth.html";
            }
          });
    
          window.logout = function () {
            signOut(auth)
              .then(() => {
                alert("Você saiu com sucesso!");
                window.location.href = "auth.html";
              })
              .catch((error) => {
                alert("Erro ao sair: " + error.message);
              });
          };
        </script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag("js", new Date());
    
          gtag("config", "G-4WT805FFHQ");
        </script>
        <link
          href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
          rel="stylesheet"
        />
      </head>

  <style>


  </style>

<div id="header"></div>

<div class="container">

    
    <div class="controls">
        <div class="control-group">
            <label for="leagueSelect">Selecione uma Liga:</label>
            <select id="leagueSelect">
                <option value="" selected>Escolha uma liga</option>
                <option value="all">Todas as Ligas</option>
                <option value="Euro">Euro Cup</option>
                <option value="Copa">Copa do Mundo</option>
                <option value="Premier">Premier League</option>
                <option value="Super">Super Liga</option>
            </select>
        </div>

        <div class="control-group">
            <label for="marketSelect">Selecione o Mercado:</label>
            <select id="marketSelect">
                <option value="casa">Casa Vence</option>
                <option value="fora">Fora Vence</option>
                <option value="empate">Empate FT</option>
                <option value="over1.5">Over 1.5</option>
                <option value="over2.5" selected>Over 2.5</option>
                <option value="over3.5">Over 3.5</option>
                <option value="ambas">Ambas Sim</option>
                <option value="ambasnao">Ambas Não</option>
                <option value="under15">Under 1.5</option>
                <option value="under25">Under 2.5</option>
                <option value="zerog">Exatamente 0 Gol</option>
                <option value="umg">Exatamente 1 Gol</option>
                <option value="doisg">Exatamente 2 Gols</option>
                <option value="tresg">Exatamente 3 Gols</option>
                <option value="quatrog">Exatamente 4 Gols</option>
                <option value="cincog">5 ou Mais Gols</option>
            </select>
        </div>

        <div class="control-group">
            <label for="rangeSelect">Quantidade de Gales:</label>
            <select id="rangeSelect">
                <option value="1">1 Gale</option>
                <option value="2">2 Gales</option>
                <option value="3" selected>3 Gales</option>
                <option value="4">4 Gales</option>
                <option value="5">5 Gales</option>
            </select>
        </div>

        <div class="control-group">
            <label for="hourSelect">Selecione o Horário (Opcional):</label>
            <select id="hourSelect">
                <option value="" selected>Todas as Horas</option>
                <script>
                    for (let h = 0; h < 24; h++) {
                        const hour = String(h).padStart(2, '0');
                        document.write(`<option value="${hour}">${hour}:00</option>`);
                    }
                </script>
            </select>
        </div>

        <div class="control-group">
            <label for="gameLimitSelect">Quantidade de Jogos:</label>
            <select id="gameLimitSelect">
                <option value="todos" selected>Todos os Jogos</option>
                <option value="480">Últimas 24 Horas</option>
                <option value="960">Últimas 48 Horas</option>
                <option value="1440">Últimas 72 Horas</option>
                <option value="1920">Últimas 96 Horas</option>
            </select>
        </div>
    </div>

    <button class="btn-projecoes" onclick="generateList()">Gerar Lista de Projeções</button>

    <div id="loading" class="loading" style="display: none;">Carregando dados... Por favor aguarde</div>
    <div id="projections" class="projections"></div>
</div>

    <script>
        let cachedData = {};

function showLoading(show) {
    document.getElementById("loading").style.display = show ? "block" : "none";
}

function fetchApiData(league) {
    showLoading(true);
    const apiUrl = `https://betstat.site/api/resultados/${league}`;
    fetch(apiUrl)
        .then(response => {
            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
            return response.json();
        })
        .then(data => {
            cachedData[league] = data;
            console.log(`Dados recebidos para ${league}:`, data);
            processApiData(data, league);
            showLoading(false);
        })
        .catch(error => {
            console.error("Erro ao buscar dados:", error);
            showLoading(false);
            alert("Erro ao buscar dados da API.");
        });
}

function fetchAllLeagues() {
    const leagues = ["Euro", "Copa", "Premier", "Super"];
    showLoading(true);
    Promise.all(leagues.map(league => 
        cachedData[league] ? Promise.resolve(cachedData[league]) : 
        fetch(`https://betstat.site/api/resultados/${league}`).then(res => res.json())
    ))
    .then(results => {
        leagues.forEach((league, index) => cachedData[league] = results[index]);
        console.log("Dados recebidos para todas as ligas:", results);
        processAllLeagues();
        showLoading(false);
    })
    .catch(error => {
        console.error("Erro ao buscar todas as ligas:", error);
        showLoading(false);
        alert("Erro ao buscar dados de todas as ligas.");
    });
}

function generateList() {
    const leagueSelect = document.getElementById("leagueSelect").value;

    if (!leagueSelect) {
        alert("Por favor, selecione uma liga.");
        return;
    }

    if (leagueSelect === "all") {
        fetchAllLeagues();
    } else if (cachedData[leagueSelect]) {
        processApiData(cachedData[leagueSelect], leagueSelect);
    } else {
        fetchApiData(leagueSelect);
    }
}

function processApiData(data, league) {
    const market = document.getElementById("marketSelect").value;
    const range = parseInt(document.getElementById("rangeSelect").value, 10);
    const selectedHour = document.getElementById("hourSelect").value;
    const gameLimit = document.getElementById("gameLimitSelect").value;
    const limitedData = gameLimit === "todos" ? data : data.slice(-parseInt(gameLimit, 10));
    const projections = analyzeProjections(limitedData, market, range, league, selectedHour);
    displayProjections(projections);
}

function processAllLeagues() {
    const market = document.getElementById("marketSelect").value;
    const range = parseInt(document.getElementById("rangeSelect").value, 10);
    const selectedHour = document.getElementById("hourSelect").value;
    const gameLimit = document.getElementById("gameLimitSelect").value;
    let allProjections = {};
    ["Euro", "Copa", "Premier", "Super"].forEach(league => {
        const limitedData = gameLimit === "todos" ? cachedData[league] : cachedData[league].slice(-parseInt(gameLimit, 10));
        const projections = analyzeProjections(limitedData, market, range, league, selectedHour);
        Object.keys(projections).forEach(hour => {
            if (!allProjections[hour]) allProjections[hour] = {};
            allProjections[hour][league] = projections[hour][league];
        });
    });
    displayProjections(allProjections);
}

function analyzeProjections(data, market, range, league, selectedHour) {
    const gamesByHour = {};
    data.forEach(game => {
        const hora = String(game.hora).padStart(2, '0');
        const minuto = String(game.minuto).padStart(2, '0');
        const horario = `${hora}:${minuto}`;
        if (selectedHour && hora !== selectedHour) return;
        if (!gamesByHour[hora]) gamesByHour[hora] = [];
        gamesByHour[hora].push({ time: horario, ft: game.ft, ht: game.ht });
    });

    const minutesConsistency = {};
    const results = {};

    Object.keys(gamesByHour).forEach(hour => {
        gamesByHour[hour].sort((a, b) => a.time.localeCompare(b.time));
        gamesByHour[hour].forEach((game, index) => {
            const minuto = game.time.split(':')[1];
            let greenFound = false;
            for (let i = 0; i < range && (index + i) < gamesByHour[hour].length; i++) {
                const checkGame = gamesByHour[hour][index + i];
                const [golsEquipe1, golsEquipe2] = extractGoalsFromScore(checkGame.ft);
                const placarht = checkGame.ht || "";

                if (market === "over2.5" && (golsEquipe1 + golsEquipe2) > 2) {
                    greenFound = true;
                    break;
                } else if (market === "over1.5" && (golsEquipe1 + golsEquipe2) > 1) {
                    greenFound = true;
                    break;
                } else if (market === "over3.5" && (golsEquipe1 + golsEquipe2) > 3) {
                    greenFound = true;
                    break;
                } else if (market === "ambas" && golsEquipe1 > 0 && golsEquipe2 > 0) {
                    greenFound = true;
                    break;
                } else if (market === "ambasnao" && (golsEquipe1 === 0 || golsEquipe2 === 0)) {
                    greenFound = true;
                    break;
                } else if (market === "under15" && (golsEquipe1 + golsEquipe2) < 2) {
                    greenFound = true;
                    break;
                } else if (market === "under25" && (golsEquipe1 + golsEquipe2) < 3) {
                    greenFound = true;
                    break;
                } else if (market === "zerog" && (golsEquipe1 + golsEquipe2) === 0) {
                    greenFound = true;
                    break;
                } else if (market === "umg" && (golsEquipe1 + golsEquipe2) === 1) {
                    greenFound = true;
                    break;
                } else if (market === "doisg" && (golsEquipe1 + golsEquipe2) === 2) {
                    greenFound = true;
                    break;
                } else if (market === "tresg" && (golsEquipe1 + golsEquipe2) === 3) {
                    greenFound = true;
                    break;
                } else if (market === "quatrog" && (golsEquipe1 + golsEquipe2) === 4) {
                    greenFound = true;
                    break;
                } else if (market === "cincog" && (golsEquipe1 + golsEquipe2) >= 5) {
                    greenFound = true;
                    break;
                } else if (market === "casa" && (golsEquipe1 > golsEquipe2)) {
                    greenFound = true;
                    break;
                } else if (market === "fora" && (golsEquipe1 < golsEquipe2)) {
                    greenFound = true;
                    break;
                } else if (market === "empate" && (golsEquipe1 === golsEquipe2)) {
                    greenFound = true;
                    break;
                } else if (market === "OUT" && placarht === "OUT") {
                    greenFound = true;
                    break;
                }
            }
            if (!minutesConsistency[minuto]) minutesConsistency[minuto] = { total: 0, greens: 0 };
            minutesConsistency[minuto].total++;
            if (greenFound) minutesConsistency[minuto].greens++;
        });

        const sequences = [];
        const usedMinutes = new Set();
        for (let i = 0; i < gamesByHour[hour].length; i++) {
            const minuto = gamesByHour[hour][i].time.split(':')[1];
            if (minutesConsistency[minuto].greens === minutesConsistency[minuto].total && !usedMinutes.has(minuto)) {
                const sequence = [minuto];
                let currentMinute = parseInt(minuto);
                for (let j = 1; j < range; j++) {
                    currentMinute = (currentMinute + 3) % 60; // Incremento de 3 minutos, ajustando para o ciclo de 60
                    sequence.push(String(currentMinute).padStart(2, '0'));
                    usedMinutes.add(String(currentMinute).padStart(2, '0'));
                }
                sequences.push(sequence);
                usedMinutes.add(minuto);
            }
        }
        if (sequences.length > 0) {
            if (!results[hour]) results[hour] = {};
            results[hour][league] = sequences;
        }
    });

    console.log("Projeções filtradas:", results);
    return results;
}

function extractGoalsFromScore(scoreString) {
    if (!scoreString || typeof scoreString !== 'string') return [0, 0];
    const scoreParts = scoreString.split('x').map(part => part.trim());
    if (scoreParts.length === 2) {
        const team1Goals = parseInt(scoreParts[0], 10) || 0;
        const team2Goals = parseInt(scoreParts[1], 10) || 0;
        return [team1Goals, team2Goals];
    }
    return [0, 0];
}

function displayProjections(projections) {
    const projectionsDiv = document.getElementById("projections");
    const marketText = document.getElementById("marketSelect").options[document.getElementById("marketSelect").selectedIndex].text;
    const range = document.getElementById("rangeSelect").value;
    projectionsDiv.innerHTML = "";

    if (Object.keys(projections).length === 0) {
        const noResults = document.createElement("p");
        noResults.className = "no-results";
        noResults.textContent = "Nenhuma projeção encontrada para os critérios selecionados.";
        projectionsDiv.appendChild(noResults);
        return;
    }

    const header = document.createElement("h2");
    header.textContent = `PROJEÇÕES PARA ${range} GALES\nMercado: ${marketText}`;
    projectionsDiv.appendChild(header);

    Object.keys(projections).sort((a, b) => a - b).forEach(hour => {
        const hourBlock = document.createElement("div");
        hourBlock.className = "hour-block";

        const hourTitle = document.createElement("h3");
        hourTitle.textContent = `⏰ H: ${String(hour).padStart(2, '00')}`;
        hourBlock.appendChild(hourTitle);

        Object.keys(projections[hour]).forEach(league => {
            let leagueName = "";
            switch (league) {
                case "Euro": leagueName = "Euro Cup"; break;
                case "Copa": leagueName = "Copa do Mundo"; break;
                case "Premier": leagueName = "Premier League"; break;
                case "Super": leagueName = "Super Liga"; break;
                default: leagueName = league.toUpperCase();
            }

            projections[hour][league].forEach(sequence => {
                const projLine = document.createElement("div");
                projLine.className = "projection-item";
                const minutesText = sequence.join(' ');

                projLine.innerHTML = `
                    <span class="emoji">🏆</span> ${leagueName} <span class="emoji">🏆</span>
                    <span class="minutes-list">🕒 ${minutesText} 🕒</span>
                    <span class="emoji">⚠️</span> Entrada: ${marketText}
                `;
                hourBlock.appendChild(projLine);
            });
        });

        projectionsDiv.appendChild(hourBlock);

        const separator = document.createElement("p");
        separator.className = "separator";
        separator.textContent = "•";
        projectionsDiv.appendChild(separator);
    });
}
    </script>


    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });
  </script>
  <script src="redirecionar.js"></script>
  </body>
</html>
