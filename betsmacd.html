<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"
    ></script>
    <title>BetStat</title>
    <!-- Meta tags SEO principais -->
    <meta
      name="description"
      content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes."
    />
    <meta
      name="keywords"
      content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos"
    />

    <!-- Open Graph meta tags para redes sociais -->
    <meta
      property="og:title"
      content="BetStat | Plataforma de Análise para Apostas Esportivas"
    />
    <meta
      property="og:description"
      content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.betstat.site/payment.html" />
    <meta property="og:site_name" content="BetStat" />

    <!-- Meta tags adicionais -->
    <meta name="robots" content="index, follow" />
    <meta name="author" content="BetStat" />
    <meta name="canonical" href="https://www.betstat.site/payment.html" />
    <script type="module" src="js/firebase-auth.js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-4WT805FFHQ");
    </script>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>

  <style>
        .histomacd-container {
            max-width: 1900px;
            margin: 0 auto;
        }

        .histomacd-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #252931;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .histomacd-header h1 {
            color: #1fad8b;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .histomacd-controls {
            background: #252931;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .histomacd-controls-wrapper {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .histomacd-control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .histomacd-control-label {
            font-size: 13px;
            color: #aaa;
            font-weight: 600;
        }

        .histomacd-select,
        .histomacd-input-number {
            padding: 10px;
            background: #1c1f26;
            border: 1px solid #333;
            border-radius: 5px;
            color: #e0e0e0;
            font-size: 14px;
            transition: all 0.3s;
        }

        .histomacd-select:focus,
        .histomacd-input-number:focus {
            outline: none;
            border-color: #1fad8b;
            box-shadow: 0 0 0 3px rgba(31, 173, 139, 0.1);
        }

        .histomacd-checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
        }

        .histomacd-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #1fad8b;
        }

        .histomacd-checkbox-label {
            color: #e0e0e0;
            cursor: pointer;
            font-size: 14px;
        }

        .histomacd-league-section {
            background: #252931;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .histomacd-league-title {
            color: #1fad8b;
            font-size: 1.4em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }

        .histomacd-chart-container {
            position: relative;
            height: 350px;
            background: #1c1f26;
            border-radius: 8px;
            padding: 15px;
        }

        .histomacd-canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .histomacd-loading {
            text-align: center;
            padding: 40px;
            color: #1fad8b;
            font-size: 1.1em;
        }

        @media (max-width: 768px) {
            .histomacd-controls-wrapper {
                grid-template-columns: 1fr;
            }

            .histomacd-chart-container {
                height: 300px;
            }

            .histomacd-header h1 {
                font-size: 1.5em;
            }
        }
  </style>

  <body>
    <body>
        <div id="header"></div>

        <br>
        <br>
        <br>
        <br>
        
    <div class="histomacd-container">

        <div class="histomacd-controls">
            <div class="histomacd-controls-wrapper">
                <div class="histomacd-control-group">
                    <label for="histomacdMarketSelector" class="histomacd-control-label">Mercado</label>
                    <select id="histomacdMarketSelector" class="histomacd-select">
                        <option value="ambasMarcam">Ambas Marcam</option>
                        <option value="ambasNaoMarcam">Ambas Não Marcam</option>
                        <option value="casaVence">Casa Vence</option>
                        <option value="foraVence">Fora Vence</option>
                        <option value="empate">Empate</option>
                        <option value="over1.5">Over 1.5</option>
                        <option value="under1.5">Under 1.5</option>
                        <option value="over2.5">Over 2.5</option>
                        <option value="under2.5">Under 2.5</option>
                        <option value="over3.5">Over 3.5</option>
                        <option value="under3.5">Under 3.5</option>
                        <option value="over5">Over 5+</option>
                        <option value="exato0">0 Gol Exato</option>
                        <option value="exato1">1 Gol Exato</option>
                        <option value="exato2">2 Gols Exatos</option>
                        <option value="exato3">3 Gols Exatos</option>
                        <option value="exato4">4 Gols Exatos</option>
                    </select>
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdPointsSelector" class="histomacd-control-label">Período</label>
                    <select id="histomacdPointsSelector" class="histomacd-select">
                        <option value="20">1 Hora</option>
                        <option value="40">2 Horas</option>
                        <option value="60">3 Horas</option>
                        <option value="80">4 Horas</option>
                        <option value="100">5 Horas</option>
                        <option value="120">6 Horas</option>
                        <option value="140">7 Horas</option>
                        <option value="160">8 Horas</option>
                        <option value="180">9 Horas</option>
                        <option value="200">10 Horas</option>
                        <option value="220">11 Horas</option>
                        <option value="240">12 Horas</option>
                        <option value="480">24 Horas</option>
                        <option value="960">48 Horas</option>
                        <option value="1440">72 Horas</option>
                    </select>
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdAverageSelector" class="histomacd-control-label">Média</label>
                    <input type="number" id="histomacdAverageSelector" class="histomacd-input-number" value="19" min="1" max="100">
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdMacdFast" class="histomacd-control-label">MACD Rápido</label>
                    <input type="number" id="histomacdMacdFast" class="histomacd-input-number" value="12" min="1" max="50">
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdMacdSlow" class="histomacd-control-label">MACD Lento</label>
                    <input type="number" id="histomacdMacdSlow" class="histomacd-input-number" value="26" min="1" max="100">
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdMacdSignal" class="histomacd-control-label">MACD Sinal</label>
                    <input type="number" id="histomacdMacdSignal" class="histomacd-input-number" value="9" min="1" max="50">
                </div>

                <div class="histomacd-control-group">
                    <label for="histomacdRsiPeriod" class="histomacd-control-label">Período RSI</label>
                    <input type="number" id="histomacdRsiPeriod" class="histomacd-input-number" value="14" min="1" max="50">
                </div>

                <div class="histomacd-control-group">
                    <div class="histomacd-checkbox-group">
                        <input type="checkbox" id="histomacdShowRSI" class="histomacd-checkbox" checked>
                        <label for="histomacdShowRSI" class="histomacd-checkbox-label">Exibir RSI</label>
                    </div>
                </div>
            </div>
        </div>

        <div id="histomacdChartsContainer"></div>
    </div>

    <script>
            const HISTOMACD_LEAGUES = {
                'Espanha': 'https://betstat.site/resultados/betsson/Espanha',
                'Inglaterra': 'https://betstat.site/resultados/betsson/Inglaterra',
                'Brasil': 'https://betstat.site/resultados/betsson/Brasil'
            };


        let histomacdSettings = {
            numPoints: 20,
            averagePoints: 19,
            macdFast: 12,
            macdSlow: 26,
            macdSignal: 9,
            rsiPeriod: 14,
            showRSI: true,
            selectedMarket: 'ambasMarcam'
        };

        let histomacdChartData = {};
        let histomacdProcessedChartData = {};
        let histomacdIndicatorCharts = {};

        const histomacdMarketKeys = {
            ambasMarcam: 'ambasSim',
            ambasNaoMarcam: 'ambasNao',
            casaVence: 'casaVence',
            foraVence: 'foraVence',
            empate: 'empate',
            'over1.5': 'over15',
            'under1.5': 'under15',
            'over2.5': 'over25',
            'under2.5': 'under25',
            'over3.5': 'over35',
            'under3.5': 'under35',
            over5: 'over45',
            exato0: 'gol0',
            exato1: 'gol1',
            exato2: 'gol2',
            exato3: 'gol3',
            exato4: 'gol4'
        };

        const histomacdKeyToLabel = {
            'ambasSim': 'Ambas Sim',
            'ambasNao': 'Ambas Não',
            'casaVence': 'Casa Vence',
            'empate': 'Empate',
            'foraVence': 'Fora Vence',
            'over15': 'Over 1.5',
            'over25': 'Over 2.5',
            'over35': 'Over 3.5',
            'under15': 'Under 1.5',
            'under25': 'Under 2.5',
            'under35': 'Under 3.5',
            'over45': 'Over 5+',
            'gol0': '0 Gol Exato',
            'gol1': '1 Gol Exato',
            'gol2': '2 Gols Exatos',
            'gol3': '3 Gols Exatos',
            'gol4': '4 Gols Exatos'
        };

        function histomacdFillGaps(data) {
            let filled = [...data];
            let last = null;
            for (let i = 0; i < filled.length; i++) {
                if (filled[i] !== null && filled[i] !== undefined) {
                    last = filled[i];
                } else if (last !== null) {
                    filled[i] = last;
                }
            }
            if (last === null) {
                for (let i = filled.length - 1; i >= 0; i--) {
                    if (filled[i] !== null && filled[i] !== undefined) {
                        last = filled[i];
                    } else if (last !== null) {
                        filled[i] = last;
                    }
                }
            } else {
                for (let i = 0; i < filled.length; i++) {
                    if (filled[i] === null || filled[i] === undefined) filled[i] = last;
                    else break;
                }
            }
            return filled;
        }

        function histomacdFillInitial(array) {
            let first = array.find(v => v !== null && v !== undefined);
            if (first !== undefined) {
                for (let i = 0; i < array.length; i++) {
                    if (array[i] === null || array[i] === undefined) array[i] = first;
                    else break;
                }
            }
            return array;
        }

        function histomacdCalculateEMA(data, period) {
            const k = 2 / (period + 1);
            let ema = new Array(data.length).fill(null);
            let sum = 0;
            let count = 0;
            for (let i = 0; i < data.length; i++) {
                if (data[i] === null || data[i] === undefined) continue;
                sum += data[i];
                count++;
                if (count >= 1) {
                    ema[i] = sum / count;
                    if (count >= period) break;
                }
            }
            for (let i = 0; i < data.length; i++) {
                if (ema[i] !== null) {
                    for (let j = i + 1; j < data.length; j++) {
                        if (data[j] !== null && data[j] !== undefined) {
                            ema[j] = (data[j] * k) + (ema[j - 1] * (1 - k));
                        } else {
                            ema[j] = ema[j - 1];
                        }
                    }
                    break;
                }
            }
            return histomacdFillInitial(ema);
        }

        function histomacdCalculateMACD(data, fast, slow, signal) {
            const emaFast = histomacdCalculateEMA(data, fast);
            const emaSlow = histomacdCalculateEMA(data, slow);
            let macdLine = data.map((d, i) => (emaFast[i] !== null && emaSlow[i] !== null ? emaFast[i] - emaSlow[i] : null));
            macdLine = histomacdFillInitial(macdLine);
            const emaSignal = histomacdCalculateEMA(macdLine, signal);
            let histogram = data.map((d, i) => (macdLine[i] !== null && emaSignal[i] !== null ? macdLine[i] - emaSignal[i] : null));
            histogram = histomacdFillInitial(histogram);
            return { macdLine, emaSignal, histogram };
        }

        function histomacdCalculateRSI(data, period) {
            let rsi = new Array(data.length).fill(null);
            let gains = [];
            let losses = [];

            for (let i = 1; i < data.length; i++) {
                if (data[i] === null || data[i - 1] === null) continue;
                
                const change = data[i] - data[i - 1];
                gains.push(change > 0 ? change : 0);
                losses.push(change < 0 ? -change : 0);

                if (gains.length >= period) {
                    const avgGain = gains.slice(-period).reduce((a, b) => a + b, 0) / period;
                    const avgLoss = losses.slice(-period).reduce((a, b) => a + b, 0) / period;
                    
                    if (avgLoss === 0) {
                        rsi[i] = 100;
                    } else {
                        const rs = avgGain / avgLoss;
                        rsi[i] = 100 - (100 / (1 + rs));
                    }
                }
            }

            return histomacdFillInitial(rsi);
        }

        function histomacdProcessApiData(data, league) {
            if (!data || !Array.isArray(data)) {
                console.error(`Dados inválidos para ${league}:`, data);
                return { labels: [] };
            }

            const sortedData = [...data].sort((a, b) => {
                const dateA = new Date(a.data);
                const dateB = new Date(b.data);
                if (dateA.getTime() !== dateB.getTime()) return dateA - dateB;
                if (a.hora !== b.hora) return a.hora - b.hora;
                return a.minuto - b.minuto;
            });

            const extra = 50;
            const slicedData = sortedData.slice(- (histomacdSettings.numPoints + histomacdSettings.averagePoints + extra));
            histomacdChartData[league] = slicedData;

            let labels = [];
            let ambasSim = [], ambasNao = [], casaVence = [], empate = [], foraVence = [];
            let over15 = [], over25 = [], over35 = [], under15 = [], under25 = [], under35 = [], over45 = [];
            let gol0 = [], gol1 = [], gol2 = [], gol3 = [], gol4 = [];

            function hasGap(prevMatch, currMatch) {
                const prevTime = new Date(prevMatch.data + 'T' + prevMatch.hora + ':' + prevMatch.minuto + ':00');
                const currTime = new Date(currMatch.data + 'T' + currMatch.hora + ':' + currMatch.minuto + ':00');
                const diffMinutes = (currTime - prevTime) / (1000 * 60);
                return diffMinutes > 1;
            }

            for (let i = histomacdSettings.averagePoints; i < slicedData.length; i++) {
                let counts = {
                    ambasSim: 0, ambasNao: 0, casaVence: 0, empate: 0, foraVence: 0,
                    over15: 0, over25: 0, over35: 0, under15: 0, under25: 0, under35: 0, over45: 0,
                    gol0: 0, gol1: 0, gol2: 0, gol3: 0, gol4: 0
                };
                let validMatches = 0;

                for (let j = Math.max(0, i - histomacdSettings.averagePoints); j <= i; j++) {
                    const match = slicedData[j];
                    let ftScoreParts = [0, 0];
                    if (match.ft && match.ft.includes(' x ')) {
                        ftScoreParts = match.ft.split(' x ').map(num => parseInt(num, 10));
                    }

                    const totalGolsFT = ftScoreParts[0] + ftScoreParts[1];

                    counts.ambasSim += ftScoreParts[0] > 0 && ftScoreParts[1] > 0 ? 1 : 0;
                    counts.ambasNao += ftScoreParts[0] === 0 || ftScoreParts[1] === 0 ? 1 : 0;
                    counts.casaVence += ftScoreParts[0] > ftScoreParts[1] ? 1 : 0;
                    counts.empate += ftScoreParts[0] === ftScoreParts[1] ? 1 : 0;
                    counts.foraVence += ftScoreParts[0] < ftScoreParts[1] ? 1 : 0;
                    counts.over15 += totalGolsFT > 1.5 ? 1 : 0;
                    counts.over25 += totalGolsFT > 2.5 ? 1 : 0;
                    counts.over35 += totalGolsFT > 3.5 ? 1 : 0;
                    counts.under15 += totalGolsFT < 1.5 ? 1 : 0;
                    counts.under25 += totalGolsFT < 2.5 ? 1 : 0;
                    counts.under35 += totalGolsFT < 3.5 ? 1 : 0;
                    counts.over45 += totalGolsFT > 4.5 ? 1 : 0;
                    counts.gol0 += totalGolsFT === 0 ? 1 : 0;
                    counts.gol1 += totalGolsFT === 1 ? 1 : 0;
                    counts.gol2 += totalGolsFT === 2 ? 1 : 0;
                    counts.gol3 += totalGolsFT === 3 ? 1 : 0;
                    counts.gol4 += totalGolsFT === 4 ? 1 : 0;
                    validMatches++;
                }

                const match = slicedData[i];

                if (i > histomacdSettings.averagePoints && hasGap(slicedData[i - 1], match)) {
                    labels.push('');
                    Object.keys(counts).forEach(key => {
                        eval(key).push(null);
                    });
                }

                labels.push(`${match.hora}:${match.minuto.toString().padStart(2, '0')}`);

                const avg = validMatches || 1;
                ambasSim.push(counts.ambasSim / avg * 100);
                ambasNao.push(counts.ambasNao / avg * 100);
                casaVence.push(counts.casaVence / avg * 100);
                empate.push(counts.empate / avg * 100);
                foraVence.push(counts.foraVence / avg * 100);
                over15.push(counts.over15 / avg * 100);
                over25.push(counts.over25 / avg * 100);
                over35.push(counts.over35 / avg * 100);
                under15.push(counts.under15 / avg * 100);
                under25.push(counts.under25 / avg * 100);
                under35.push(counts.under35 / avg * 100);
                over45.push(counts.over45 / avg * 100);
                gol0.push(counts.gol0 / avg * 100);
                gol1.push(counts.gol1 / avg * 100);
                gol2.push(counts.gol2 / avg * 100);
                gol3.push(counts.gol3 / avg * 100);
                gol4.push(counts.gol4 / avg * 100);
            }

            const result = { 
                labels, ambasSim, ambasNao, casaVence, empate, foraVence,
                over15, over25, over35, under15, under25, under35, over45,
                gol0, gol1, gol2, gol3, gol4
            };

            histomacdProcessedChartData[league] = result;
            histomacdChartData[league] = slicedData.slice(extra);

            const start = result.labels.length - histomacdSettings.numPoints;
            if (start > 0) {
                for (let key in result) {
                    if (Array.isArray(result[key])) {
                        result[key] = result[key].slice(start);
                    }
                }
            }

            return result;
        }

        function histomacdGetIndicatorData(league, market) {
            if (!histomacdProcessedChartData[league]) {
                console.warn(`Dados processados não disponíveis para ${league}`);
                return { macdLine: [], emaSignal: [], histogram: [], rsi: [] };
            }

            const marketKey = histomacdMarketKeys[market] || 'ambasSim';
            const data = histomacdProcessedChartData[league][marketKey] || [];
            const filledData = histomacdFillGaps(data);
            const macd = histomacdCalculateMACD(filledData, histomacdSettings.macdFast, histomacdSettings.macdSlow, histomacdSettings.macdSignal);
            const rsi = histomacdCalculateRSI(filledData, histomacdSettings.rsiPeriod);

            return { ...macd, rsi };
        }

        function histomacdCreateIndicatorChart(ctx, labels, indicatorData, league) {
            if (!ctx) {
                console.error(`Contexto do canvas para indicadores de ${league} é inválido`);
                return null;
            }

            const marketKey = histomacdMarketKeys[histomacdSettings.selectedMarket] || 'ambasSim';
            const marketLabel = histomacdKeyToLabel[marketKey] || 'Ambas Sim';
            
            const datasets = [
                {
                    label: 'Linha MACD',
                    data: indicatorData.macdLine || [],
                    borderColor: '#00BFFF',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    pointRadius: 0,
                    yAxisID: 'y-macd',
                    fill: false
                },
                {
                    label: 'Sinal MACD',
                    data: indicatorData.emaSignal || [],
                    borderColor: '#FFA500',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    pointRadius: 0,
                    yAxisID: 'y-macd',
                    fill: false
                },
                {
                    label: `Histograma MACD (${marketLabel})`,
                    data: indicatorData.histogram || [],
                    type: 'bar',
                    backgroundColor: (indicatorData.histogram || []).map(val => val >= 0 ? 'rgba(0, 255, 0, 0.5)' : 'rgba(255, 0, 0, 0.5)'),
                    yAxisID: 'y-macd'
                }
            ];

            if (histomacdSettings.showRSI) {
                datasets.push({
                    label: 'RSI',
                    data: indicatorData.rsi || [],
                    borderColor: '#9C27B0',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    pointRadius: 0,
                    yAxisID: 'y-rsi',
                    fill: false
                });
            }

            const scales = {
                x: {
                    ticks: { 
                        color: '#aaa',
                        maxRotation: 45,
                        minRotation: 45
                    },
                    grid: { color: '#2a2d35' }
                },
                'y-macd': {
                    type: 'linear',
                    position: 'left',
                    ticks: { color: '#aaa' },
                    grid: { color: '#2a2d35' }
                }
            };

            if (histomacdSettings.showRSI) {
                scales['y-rsi'] = {
                    type: 'linear',
                    position: 'right',
                    min: 0,
                    max: 100,
                    title: { 
                        display: true, 
                        text: 'RSI',
                        color: '#9C27B0',
                        font: { size: 12, weight: 'bold' }
                    },
                    ticks: { color: '#aaa' },
                    grid: { color: '#2a2d35', drawBorder: true }
                };
            }

            try {
                return new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels || [],
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        scales: scales,
                        plugins: {
                            legend: { 
                                display: true,
                                labels: { 
                                    color: '#fff',
                                    padding: 10,
                                    font: { size: 11 }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#1fad8b',
                                bodyColor: '#e0e0e0',
                                borderColor: '#1fad8b',
                                borderWidth: 1,
                                padding: 12,
                                displayColors: true,
                                callbacks: {
                                    title: function(context) {
                                        return 'Horário: ' + context[0].label;
                                    },
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.y !== null) {
                                            label += context.parsed.y.toFixed(2);
                                            if (context.dataset.yAxisID === 'y-rsi') {
                                                if (context.parsed.y > 70) {
                                                    label += ' (Sobrecompra)';
                                                } else if (context.parsed.y < 30) {
                                                    label += ' (Sobrevenda)';
                                                }
                                            }
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error(`Erro ao criar gráfico de indicadores para ${league}:`, error);
                return null;
            }
        }

        function histomacdUpdateIndicatorChart(league) {
            if (!histomacdIndicatorCharts[league]) {
                console.warn(`Gráfico de indicadores não inicializado para ${league}`);
                return;
            }

            const indicatorData = histomacdGetIndicatorData(league, histomacdSettings.selectedMarket);
            const marketKey = histomacdMarketKeys[histomacdSettings.selectedMarket] || 'ambasSim';
            const marketLabel = histomacdKeyToLabel[marketKey] || 'Ambas Sim';

            histomacdIndicatorCharts[league].data.labels = histomacdProcessedChartData[league]?.labels || [];
            histomacdIndicatorCharts[league].data.datasets[0].data = indicatorData.macdLine || [];
            histomacdIndicatorCharts[league].data.datasets[1].data = indicatorData.emaSignal || [];
            histomacdIndicatorCharts[league].data.datasets[2].data = indicatorData.histogram || [];
            histomacdIndicatorCharts[league].data.datasets[2].backgroundColor = (indicatorData.histogram || []).map(val => val >= 0 ? 'rgba(0, 255, 0, 0.5)' : 'rgba(255, 0, 0, 0.5)');
            histomacdIndicatorCharts[league].data.datasets[2].label = `Histograma MACD (${marketLabel})`;
            
            if (histomacdSettings.showRSI) {
                if (histomacdIndicatorCharts[league].data.datasets.length === 3) {
                    histomacdIndicatorCharts[league].data.datasets.push({
                        label: 'RSI',
                        data: indicatorData.rsi || [],
                        borderColor: '#9C27B0',
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        pointRadius: 0,
                        yAxisID: 'y-rsi',
                        fill: false
                    });
                } else {
                    histomacdIndicatorCharts[league].data.datasets[3].data = indicatorData.rsi || [];
                }
                
                if (!histomacdIndicatorCharts[league].options.scales['y-rsi']) {
                    histomacdIndicatorCharts[league].options.scales['y-rsi'] = {
                        type: 'linear',
                        position: 'right',
                        min: 0,
                        max: 100,
                        title: { 
                            display: true, 
                            text: 'RSI',
                            color: '#9C27B0',
                            font: { size: 12, weight: 'bold' }
                        },
                        ticks: { color: '#aaa' },
                        grid: { color: '#2a2d35', drawBorder: true }
                    };
                }
            } else {
                if (histomacdIndicatorCharts[league].data.datasets.length > 3) {
                    histomacdIndicatorCharts[league].data.datasets.splice(3, 1);
                }
                if (histomacdIndicatorCharts[league].options.scales['y-rsi']) {
                    delete histomacdIndicatorCharts[league].options.scales['y-rsi'];
                }
            }

            histomacdIndicatorCharts[league].update('none');
        }

        function histomacdInitializeCharts() {
            const container = document.getElementById('histomacdChartsContainer');
            container.innerHTML = '';

            Object.keys(HISTOMACD_LEAGUES).forEach(leagueName => {
                const section = document.createElement('div');
                section.className = 'histomacd-league-section';
                section.innerHTML = `
                    <h2 class="histomacd-league-title">${leagueName}</h2>
                    <div class="histomacd-chart-container">
                        <canvas id="chart-${leagueName.replace(/\s+/g, '-')}" class="histomacd-canvas"></canvas>
                    </div>
                `;
                container.appendChild(section);
            });
        }

        function histomacdUpdateCharts() {
            Object.entries(HISTOMACD_LEAGUES).forEach(([leagueName, url]) => {
                const timestamp = new Date().getTime();
                const apiUrl = `${url}?timestamp=${timestamp}`;
                
                fetch(apiUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        const processedData = histomacdProcessApiData(data, leagueName);
                        const canvasId = `chart-${leagueName.replace(/\s+/g, '-')}`;
                        const canvas = document.getElementById(canvasId);

                        if (!canvas) {
                            console.error(`Canvas não encontrado: ${canvasId}`);
                            return;
                        }

                        if (!histomacdIndicatorCharts[leagueName]) {
                            const ctx = canvas.getContext('2d');
                            const indicatorData = histomacdGetIndicatorData(leagueName, histomacdSettings.selectedMarket);
                            histomacdIndicatorCharts[leagueName] = histomacdCreateIndicatorChart(ctx, processedData.labels, indicatorData, leagueName);
                            console.log(`Gráfico criado para ${leagueName}`);
                        } else {
                            histomacdUpdateIndicatorChart(leagueName);
                            console.log(`Gráfico atualizado para ${leagueName}`);
                        }
                    })
                    .catch(error => {
                        console.error(`Erro ao buscar dados de ${leagueName}:`, error);
                    });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            histomacdInitializeCharts();

            const marketSelector = document.getElementById('histomacdMarketSelector');
            if (marketSelector) {
                marketSelector.addEventListener('change', function(event) {
                    histomacdSettings.selectedMarket = event.target.value;
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const macdFastInput = document.getElementById('histomacdMacdFast');
            if (macdFastInput) {
                macdFastInput.addEventListener('change', function(event) {
                    histomacdSettings.macdFast = parseInt(event.target.value, 10);
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const macdSlowInput = document.getElementById('histomacdMacdSlow');
            if (macdSlowInput) {
                macdSlowInput.addEventListener('change', function(event) {
                    histomacdSettings.macdSlow = parseInt(event.target.value, 10);
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const macdSignalInput = document.getElementById('histomacdMacdSignal');
            if (macdSignalInput) {
                macdSignalInput.addEventListener('change', function(event) {
                    histomacdSettings.macdSignal = parseInt(event.target.value, 10);
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const rsiPeriodInput = document.getElementById('histomacdRsiPeriod');
            if (rsiPeriodInput) {
                rsiPeriodInput.addEventListener('change', function(event) {
                    histomacdSettings.rsiPeriod = parseInt(event.target.value, 10);
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const showRSICheckbox = document.getElementById('histomacdShowRSI');
            if (showRSICheckbox) {
                showRSICheckbox.addEventListener('change', function(event) {
                    histomacdSettings.showRSI = event.target.checked;
                    Object.keys(HISTOMACD_LEAGUES).forEach(league => {
                        histomacdUpdateIndicatorChart(league);
                    });
                });
            }

            const pointsSelector = document.getElementById('histomacdPointsSelector');
            if (pointsSelector) {
                pointsSelector.addEventListener('change', function(event) {
                    histomacdSettings.numPoints = parseInt(event.target.value, 10);
                    histomacdUpdateCharts();
                });
            }

            const averageSelector = document.getElementById('histomacdAverageSelector');
            if (averageSelector) {
                averageSelector.addEventListener('change', function(event) {
                    histomacdSettings.averagePoints = parseInt(event.target.value, 10);
                    histomacdUpdateCharts();
                });
            }

            histomacdUpdateCharts();
        });

        setInterval(histomacdUpdateCharts, 3000);
    </script>

<script>
    fetch('header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header').innerHTML = data;
      });
  </script>
  <script src="redirecionar.js"></script>

<script>
      // Bloqueia o menu de contexto (clique direito)
      document.addEventListener("contextmenu", function(e) {
    e.preventDefault();
});

// Bloqueia atalhos de teclado comuns para ferramentas de desenvolvimento
document.addEventListener("keydown", function(e) {
    // F12
    if (e.key === "F12") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + I
    if (e.ctrlKey && e.shiftKey && e.key === "I") {
        e.preventDefault();
    }
    
    // Ctrl + U (ver código fonte)
    if (e.ctrlKey && e.key === "u") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + J (console)
    if (e.ctrlKey && e.shiftKey && e.key === "J") {
        e.preventDefault();
    }
    
    // Ctrl + Shift + C (inspeção de elementos)
    if (e.ctrlKey && e.shiftKey && e.key === "C") {
        e.preventDefault();
    }
    
    // Ctrl + S (salvar página)
    if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
    }
    
    // Ctrl + P (imprimir)
    if (e.ctrlKey && e.key === "p") {
        e.preventDefault();
    }
});

// Detecta abertura de ferramentas de desenvolvimento
const devtools = { open: false };
const element = new Image();
Object.defineProperty(element, 'id', {
    get: function () {
        devtools.open = true;
    }
});

// Adiciona detecção alternativa de devtools
(function() {
    const threshold = 160;
    const checkDevTools = function() {
        if ((window.outerWidth - window.innerWidth) > threshold || 
            (window.outerHeight - window.innerHeight) > threshold) {
            devtools.open = true;
        }
    };
    
    window.addEventListener('resize', checkDevTools);
    setInterval(checkDevTools, 500);
})();

// Monitoramento contínuo
console.log('%c', element);
setInterval(function() {
    if (devtools.open) {
        document.body.innerHTML = '<h1>Acesso não autorizado detectado</h1>';
        // Ou redirecionar:
        // window.location.href = 'about:blank';
        devtools.open = false;
    }
}, 1000);

// Impede seleção de texto
document.addEventListener('selectstart', function(e) {
    e.preventDefault();
});

// Impede arrastar e soltar
document.addEventListener('dragstart', function(e) {
    e.preventDefault();
});

// Ofusca console
console.log = function() {};
console.debug = function() {};
console.info = function() {};
  </script>




  </body>
</html>
