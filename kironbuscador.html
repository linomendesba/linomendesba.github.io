<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>
    <title>BetStat</title>
    <meta name="description" content="Transforme suas apostas com BetStat - a √∫nica plataforma especializada em futebol virtual Betano. An√°lises precisas, estat√≠sticas confi√°veis e resultados comprovados para investimentos inteligentes." />
    <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estat√≠sticas apostas, an√°lise apostas, investimentos esportivos" />
    <meta property="og:title" content="BetStat | Plataforma de An√°lise para Apostas Esportivas" />
    <meta property="og:description" content="Transforme suas apostas com an√°lises precisas e estat√≠sticas confi√°veis. A √∫nica plataforma especializada em futebol virtual Betano." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.betstat.site/payment.html" />
    <meta property="og:site_name" content="BetStat" />
    <meta name="robots" content="index, follow" />
    <meta name="author" content="BetStat" />
    <meta name="canonical" href="https://www.betstat.site/payment.html" />
    <script type="module" src="js/firebase-auth.js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag("js", new Date());
      gtag("config", "G-4WT805FFHQ");
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
  </head>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Roboto", Arial, sans-serif;
      background-color: #1c1f26;
      color: #ffffff;
    }

    :root {
      --bg:       #1c1f26;
      --bg2:      #21252e;
      --bg3:      #252a34;
      --bg4:      #2c3240;
      --bgi:      #181b22;
      --green:    #00c978;
      --gdim:     rgba(0,201,120,.12);
      --gborder:  rgba(0,201,120,.28);
      --orange:   #ff8c42;
      --red:      #ff4757;
      --yellow:   #ffd32a;
      --t1:       #f0f2f7;
      --t2:       #8b92a5;
      --t3:       #555c6e;
      --border:   rgba(255,255,255,.07);
      --r:        11px;
      --rs:       7px;
    }

    .wrapper {
      max-width: 1800px;
      margin: 0 auto;
      padding: 24px 24px 60px;
    }

    /* ‚îÄ‚îÄ Page title ‚îÄ‚îÄ‚îÄ */
    .page-header {
      margin-top: 90px;
      margin-bottom: 20px;
    }
    .page-title {
      font-size: 18px;
      font-weight: 500;
      letter-spacing: .5px;
      color: var(--t1);
      text-transform: uppercase;
      border-bottom: 1px solid rgba(255,255,255,.06);
      padding-bottom: 10px;
    }
    .page-subtitle {
      font-size: 12px;
      color: var(--t3);
      margin-top: 5px;
    }

    /* ‚îÄ‚îÄ Summary cards ‚îÄ‚îÄ‚îÄ */
    .summary-grid {
      display: grid;
      grid-template-columns: repeat(4,1fr);
      gap: 12px;
      margin-bottom: 18px;
    }
    @media(max-width:800px){ .summary-grid{ grid-template-columns:repeat(2,1fr); } }
    @media(max-width:480px){ .summary-grid{ grid-template-columns:1fr; } }

    .s-card {
      background: var(--bg3);
      border: 1px solid var(--border);
      border-top: 2px solid var(--ctop, var(--green));
      border-radius: var(--r);
      padding: 16px 18px;
      transition: transform .2s;
    }
    .s-card:hover { transform: translateY(-1px); }
    .s-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--t3);
      font-weight: 500;
      margin-bottom: 6px;
    }
    .s-value {
      font-size: 26px;
      font-weight: 700;
      color: var(--t1);
      line-height: 1;
    }
    .s-value.green  { color: var(--green); }
    .s-value.orange { color: var(--orange); }
    .s-value.small  { font-size:14px; line-height:1.4; margin-top:4px; color:var(--yellow); }
    .s-sub { font-size: 11px; color: var(--t2); margin-top: 5px; }

    /* ‚îÄ‚îÄ Controls ‚îÄ‚îÄ‚îÄ */
    .controls-panel {
      background: var(--bg3);
      border: 1px solid var(--border);
      border-radius: var(--r);
      padding: 18px 20px;
      margin-bottom: 14px;
    }
    .controls-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    .controls-lbl {
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--t3);
    }
    .controls-actions { display:flex; gap:8px; align-items:center; }

    .btn-primary {
      display: flex;
      align-items: center;
      gap: 6px;
      background: var(--green);
      color: #000;
      border: none;
      padding: 8px 16px;
      border-radius: var(--rs);
      font-family: "Roboto", Arial, sans-serif;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all .2s;
      margin: 0;
    }
    .btn-primary:hover {
      background: #00e58a;
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(0,201,120,.3);
    }
    .btn-primary:active { transform: translateY(0); }

    .btn-sec {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--t2);
      font-family: "Roboto", Arial, sans-serif;
      font-size: 12px;
      padding: 6px 12px;
      border-radius: var(--rs);
      cursor: pointer;
      transition: all .2s;
      margin: 0;
    }
    .btn-sec:hover { border-color: var(--green); color: var(--green); }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(148px,1fr));
      gap: 12px;
    }
    .ctrl-group { display:flex; flex-direction:column; gap:5px; }
    .ctrl-lbl {
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: .8px;
      color: var(--t2);
    }

    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: var(--rs);
      background: var(--bgi);
      border: 1px solid var(--border);
      color: var(--t1);
      font-family: "Roboto", Arial, sans-serif;
      font-size: 13px;
      cursor: pointer;
      transition: border-color .2s;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='11' viewBox='0 0 24 24' fill='none' stroke='%238b92a5' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 9px center;
      padding-right: 28px;
    }
    select:hover, select:focus { border-color: var(--green); outline: none; }
    option { background: #1c1f26; color: #fff; }

    .extra-grid {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border);
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(148px,1fr));
      gap: 12px;
    }

    /* ‚îÄ‚îÄ Filter tags ‚îÄ‚îÄ‚îÄ */
    .filter-tags { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:12px; }
    .f-tag {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: .4px;
      background: var(--gdim);
      border: 1px solid var(--gborder);
      color: var(--green);
      padding: 3px 6px 3px 9px;
      border-radius: 20px;
    }
    .f-tag-del {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 14px; height: 14px;
      border-radius: 50%;
      background: rgba(0,201,120,.2);
      border: none;
      color: var(--green);
      font-size: 9px;
      cursor: pointer;
      line-height: 1;
      padding: 0;
      margin: 0;
      transition: background .15s;
      font-family: inherit;
    }
    .f-tag-del:hover { background: rgba(255,71,87,.35); color: var(--red); }

    /* ‚îÄ‚îÄ Status bar ‚îÄ‚îÄ‚îÄ */
    .status-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-left: 3px solid var(--green);
      border-radius: var(--rs);
      padding: 9px 14px;
      margin-bottom: 14px;
      font-size: 12px;
      color: var(--t2);
    }
    .status-bar.loading { border-left-color: var(--yellow); }
    .status-bar.error   { border-left-color: var(--red); }
    .s-dot { width:7px;height:7px;border-radius:50%;background:var(--green);flex-shrink:0; }
    .loading .s-dot { background:var(--yellow); animation:blink 1s infinite; }
    .error   .s-dot { background:var(--red); }
    @keyframes blink { 0%,100%{opacity:1}50%{opacity:.3} }

    /* ‚îÄ‚îÄ Legend ‚îÄ‚îÄ‚îÄ */
    .legend { display:flex; gap:16px; flex-wrap:wrap; margin-bottom:10px; }
    .leg-item { display:flex; align-items:center; gap:5px; font-size:11px; color:var(--t3); }
    .leg-dot  { width:7px;height:7px;border-radius:50%; }

    /* ‚îÄ‚îÄ Table ‚îÄ‚îÄ‚îÄ */
    .table-wrapper {
      background: var(--bg3);
      border: 1px solid var(--border);
      border-radius: var(--r);
      overflow: hidden;
    }
    .table-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      border-bottom: 1px solid var(--border);
    }
    .table-topbar-title {
      font-size: 11px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--t3);
    }
    .count-badge {
      font-size: 11px;
      font-weight: 500;
      color: var(--green);
      background: var(--gdim);
      border: 1px solid var(--gborder);
      padding: 2px 10px;
      border-radius: 20px;
    }

    table { width:100%; border-collapse:collapse; }

    th {
      background: rgba(0,0,0,.18);
      padding: 11px 16px;
      text-align: left;
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: .8px;
      color: var(--t3);
      cursor: pointer;
      white-space: nowrap;
      user-select: none;
      border-bottom: 1px solid var(--border);
      transition: color .2s;
      border-radius: 0;
    }
    th:hover { color: var(--green); }
    th.sorted-asc::after  { content:" ‚ñ≤"; }
    th.sorted-desc::after { content:" ‚ñº"; }

    tbody tr {
      border-bottom: 1px solid rgba(255,255,255,.04);
      transition: background .15s;
    }
    tbody tr:last-child { border-bottom: none; }
    tbody tr:hover { background: var(--bg4); }

    td { padding: 11px 16px; font-size: 13px; color: var(--t2); }

    .rank { font-size:11px; color:var(--t3); }

    .score-badge {
      display: inline-block;
      font-size: 13px;
      font-weight: 700;
      color: var(--t1);
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.08);
      padding: 3px 11px;
      border-radius: 6px;
      letter-spacing: .5px;
    }

    .pct-pill {
      display: inline-block;
      font-size: 12px;
      font-weight: 700;
      padding: 3px 11px;
      border-radius: 20px;
    }
    .pct-high   { background:rgba(0,201,120,.12);  color:var(--green);  border:1px solid rgba(0,201,120,.25); }
    .pct-medium { background:rgba(255,140,66,.12);  color:var(--orange); border:1px solid rgba(255,140,66,.25); }
    .pct-low    { background:rgba(255,71,87,.1);   color:var(--red);    border:1px solid rgba(255,71,87,.2); }

    .bar-wrap { display:flex; align-items:center; gap:8px; }
    .bar-bg { width:70px;height:4px;background:rgba(255,255,255,.06);border-radius:99px;overflow:hidden; }
    .bar-fill { height:100%;border-radius:99px;transition:width .5s ease; }
    .bar-g { background:linear-gradient(90deg,#00c978,#00e58a); }
    .bar-o { background:linear-gradient(90deg,#ff8c42,#ffaa6c); }
    .bar-r { background:linear-gradient(90deg,#ff4757,#ff7b85); }

    .skip-badge {
      font-size: 11px;
      color: var(--t3);
      background: rgba(255,255,255,.04);
      border: 1px solid var(--border);
      padding: 2px 8px;
      border-radius: 5px;
    }

    .empty-state { text-align:center; padding:50px 20px; color:var(--t3); font-size:13px; }
    .empty-icon  { font-size:32px; margin-bottom:10px; }

    /* ‚îÄ‚îÄ Loader ‚îÄ‚îÄ‚îÄ */
    .loader-overlay {
      position: fixed; inset: 0;
      background: rgba(28,31,38,.85);
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      z-index: 999;
      backdrop-filter: blur(4px);
      opacity: 0; pointer-events: none;
      transition: opacity .3s;
    }
    .loader-overlay.active { opacity:1; pointer-events:all; }
    .loader-ring {
      width:42px;height:42px;
      border:3px solid rgba(0,201,120,.15);
      border-top-color:var(--green);
      border-radius:50%;
      animation:spin .8s linear infinite;
      margin-bottom:14px;
    }
    @keyframes spin { to{ transform:rotate(360deg); } }
    .loader-msg { color:var(--t2); font-size:13px; }

    ::-webkit-scrollbar { width:5px;height:5px; }
    ::-webkit-scrollbar-track { background:transparent; }
    ::-webkit-scrollbar-thumb { background:#333;border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover { background:#444; }

    button { font-family:"Roboto",Arial,sans-serif; }

    @media(max-width:600px){
      .wrapper { padding:14px 12px 50px; }
      .table-topbar { flex-direction:column; gap:8px; align-items:flex-start; }
      .controls-top { flex-direction:column; gap:10px; align-items:flex-start; }
    }
  </style>

  <body>

    <!-- Loader overlay -->
    <div class="loader-overlay" id="loaderOverlay">
      <div class="loader-ring"></div>
      <div class="loader-msg" id="loaderMsg">Carregando dados...</div>
    </div>

    <!-- Header original do site (n√£o alterado) -->
    <div id="header"></div>

    <div class="wrapper">

      <div class="page-header">
        <div class="page-title">Buscador de Padr√µes</div>
        <div class="page-subtitle">An√°lise estat√≠stica por placar ‚Äî detec√ß√£o de oportunidades por mercado</div>
      </div>

      <!-- Cards de resumo -->
      <div class="summary-grid">
        <div class="s-card" style="--ctop:var(--green)">
          <div class="s-label">Jogos Analisados</div>
          <div class="s-value green" id="sumTotal">‚Äî</div>
          <div class="s-sub" id="sumLiga">Aguardando...</div>
        </div>
        <div class="s-card" style="--ctop:#00a0ff">
          <div class="s-label">Padr√µes √önicos</div>
          <div class="s-value" id="sumPatterns" style="color:#00a0ff">‚Äî</div>
          <div class="s-sub">Placares distintos</div>
        </div>
        <div class="s-card" style="--ctop:var(--orange)">
          <div class="s-label">Melhor % do Mercado</div>
          <div class="s-value orange" id="sumBestPct">‚Äî</div>
          <div class="s-sub" id="sumBestScore">‚Äî</div>
        </div>
        <div class="s-card" style="--ctop:var(--yellow)">
          <div class="s-label">Mercado Ativo</div>
          <div class="s-value small" id="sumMercado">‚Äî</div>
          <div class="s-sub" id="sumGales">‚Äî</div>
        </div>
      </div>

      <!-- Painel de filtros -->
      <div class="controls-panel">
        <div class="controls-top">
          <span class="controls-lbl">‚öô Filtros de An√°lise</span>
          <div class="controls-actions">
            <button class="btn-sec" onclick="toggleExtra()">Filtros avan√ßados ‚ñæ</button>
            <button class="btn-primary" onclick="loadData()">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
              Atualizar
            </button>
          </div>
        </div>

        <div class="controls-grid">
          <div class="ctrl-group">
            <label class="ctrl-lbl">Liga</label>
            <select id="buscador-ligas" onchange="loadData()">
              <option value="all">Todas as Ligas</option>
                <option value="England">England</option>
                <option value="Italy">Italy</option>
                <option value="Spain">Spain</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Mercado</label>
            <select id="buscador-mercado" onchange="analyzeData()">
              <option value="ambasMarcam">Ambas Sim</option>
              <option value="ambasNaoMarcam">Ambas N√£o</option>
              <option value="casaVence">Casa Vence</option>
              <option value="foraVence">Fora Vence</option>
              <option value="empate">Empate (FT)</option>
              <option value="empateHT">Empate (HT)</option>
              <option value="over1.5">Over 1.5</option>
              <option value="under1.5">Under 1.5</option>
              <option value="over2.5">Over 2.5</option>
              <option value="under2.5">Under 2.5</option>
              <option value="over3.5">Over 3.5</option>
              <option value="under3.5">Under 3.5</option>
              <option value="over5">Over 5+</option>
              <option value="exato0">Exato 0 Gols</option>
              <option value="exato1">Exato 1 Gol</option>
              <option value="exato2">Exato 2 Gols</option>
              <option value="exato3">Exato 3 Gols</option>
              <option value="exato4">Exato 4 Gols</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Janela de Tempo</label>
            <select id="buscador-linhaLimite" onchange="loadData()">
              <option value="60">√öltimas 3 horas</option>
              <option value="120">√öltimas 6 horas</option>
              <option value="240">√öltimas 12 horas</option>
              <option value="480">√öltimas 24 horas</option>
              <option value="960">√öltimas 48 horas</option>
              <option value="todas">Todo o hist√≥rico</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Gales</label>
            <select id="buscador-numTiros" onchange="analyzeData()">
              <option value="1">1 tiro</option>
              <option value="2">2 tiros</option>
              <option value="3" selected>3 tiros</option>
              <option value="4">4 tiros</option>
              <option value="5">5 tiros</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Top Resultados</label>
            <select id="buscador-topResults" onchange="analyzeData()">
              <option value="5">Top 5</option>
              <option value="10" selected>Top 10</option>
              <option value="20">Top 20</option>
              <option value="50">Top 50</option>
            </select>
          </div>
        </div>

        <!-- Filtros avan√ßados -->
        <div class="extra-grid" id="extraGrid" style="display:none">
          <div class="ctrl-group">
            <label class="ctrl-lbl">% M√≠nima</label>
            <select id="filtro-pctMin" onchange="analyzeData()">
              <option value="0">Sem filtro</option>
              <option value="50">‚â• 50%</option>
              <option value="60">‚â• 60%</option>
              <option value="70">‚â• 70%</option>
              <option value="80">‚â• 80%</option>
              <option value="90">‚â• 90%</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Ocorr√™ncias M√≠nimas</label>
            <select id="filtro-ocorrMin" onchange="analyzeData()">
              <option value="0">Sem filtro</option>
              <option value="3">‚â• 3</option>
              <option value="5">‚â• 5</option>
              <option value="10">‚â• 10</option>
              <option value="20">‚â• 20</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Max. Pulos</label>
            <select id="filtro-pulosMax" onchange="analyzeData()">
              <option value="999">Sem filtro</option>
              <option value="10">‚â§ 10 jogos</option>
              <option value="20">‚â§ 20 jogos</option>
              <option value="30">‚â§ 30 jogos</option>
              <option value="40">‚â§ 40 jogos</option>
              <option value="50">‚â§ 50 jogos</option>
              <option value="60">‚â§ 60 jogos</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label class="ctrl-lbl">Ordenar por</label>
            <select id="filtro-sortBy" onchange="analyzeData()">
              <option value="percentual">Maior porcentagem</option>
              <option value="ocorrencias">Mais ocorr√™ncias</option>
              <option value="pulos">Menos pulos</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Tags de filtros ativos -->
      <div class="filter-tags" id="filterTags"></div>

      <!-- Barra de status -->
      <div class="status-bar" id="statusBar">
        <div class="s-dot"></div>
        <span id="buscador-statusMessage">Aguardando carregamento dos dados...</span>
      </div>

      <!-- Legenda -->
      <div class="legend">
        <div class="leg-item"><div class="leg-dot" style="background:var(--green)"></div> ‚â• 70% ‚Äî Alta probabilidade</div>
        <div class="leg-item"><div class="leg-dot" style="background:var(--orange)"></div> 50‚Äì70% ‚Äî M√©dia probabilidade</div>
        <div class="leg-item"><div class="leg-dot" style="background:var(--red)"></div> &lt; 50% ‚Äî Baixa probabilidade</div>
      </div>

      <!-- Tabela de resultados -->
      <div class="table-wrapper">
        <div class="table-topbar">
          <span class="table-topbar-title">Resultados da An√°lise</span>
          <span class="count-badge" id="tableCount">0 padr√µes</span>
        </div>
        <table id="buscador-results">
          <thead>
            <tr>
              <th style="width:28px">#</th>
              <th onclick="sortTable(1)">Placar</th>
              <th onclick="sortTable(2)">Jogos p/ Pular</th>
              <th onclick="sortTable(3)">Ocorr√™ncias</th>
              <th onclick="sortTable(4)">Porcentagem</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr>
              <td colspan="5">
                <div class="empty-state">
                  <div class="empty-icon">üìä</div>
                  Clique em "Atualizar" para carregar os dados
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

    <!-- Scripts de an√°lise -->
    <script>
      let jogos = [];
      let currentSortColumn = -1;
      let sortOrderAsc = true;
      let extraVisible = false;

        const ligas = [
        "England",
        "Italy",
        "Spain"
    ];
    const API_BASE_URL = "https://betstat.site/resultados/kiron/";

      const mercadoLabels = {
        ambasMarcam:"Ambas Sim", ambasNaoMarcam:"Ambas N√£o",
        casaVence:"Casa Vence", foraVence:"Fora Vence",
        empate:"Empate FT", empateHT:"Empate HT",
        "over1.5":"Over 1.5", "under1.5":"Under 1.5",
        "over2.5":"Over 2.5", "under2.5":"Under 2.5",
        "over3.5":"Over 3.5", "under3.5":"Under 3.5",
        "over5":"Over 5+",
        exato0:"Exato 0", exato1:"Exato 1", exato2:"Exato 2",
        exato3:"Exato 3", exato4:"Exato 4"
      };

      // Mapa: id do select ‚Üí label exibido na tag ‚Üí valor padr√£o para "resetar"
      const filterResetMap = {
        'buscador-ligas':      { label:'Liga',       def:'all'  },
        'buscador-linhaLimite':{ label:'Per√≠odo',    def:'60'   },
        'filtro-pctMin':       { label:'% min',      def:'0'    },
        'filtro-ocorrMin':     { label:'Ocorr. min', def:'0'    },
        'filtro-pulosMax':     { label:'Pulos max',  def:'999'  },
        'filtro-sortBy':       { label:'Ordem',      def:'percentual' },
      };

      function toggleExtra() {
        extraVisible = !extraVisible;
        document.getElementById('extraGrid').style.display = extraVisible ? 'grid' : 'none';
      }

      function setLoading(on, msg) {
        if (msg) document.getElementById('loaderMsg').textContent = msg;
        // S√≥ ativa overlay no carregamento inicial (quando jogos est√° vazio)
        if (on && jogos.length === 0) {
          document.getElementById('loaderOverlay').classList.add('active');
        } else if (!on) {
          document.getElementById('loaderOverlay').classList.remove('active');
        }
        document.getElementById('statusBar').classList.toggle('loading', on);
      }

      function updateStatus(msg, type) {
        document.getElementById('buscador-statusMessage').textContent = msg;
        const bar = document.getElementById('statusBar');
        bar.classList.remove('loading','error');
        if (type === 'loading') bar.classList.add('loading');
        if (type === 'error')   bar.classList.add('error');
      }

      function removeFilter(selectId) {
        const cfg = filterResetMap[selectId];
        if (!cfg) return;
        document.getElementById(selectId).value = cfg.def;
        // Se for liga ou per√≠odo, recarrega dados; sen√£o s√≥ reanalisa
        if (selectId === 'buscador-ligas' || selectId === 'buscador-linhaLimite') {
          loadData();
        } else {
          updateFilterTags();
          analyzeData();
        }
      }

      function updateFilterTags() {
        const liga   = document.getElementById('buscador-ligas').value;
        const horas  = document.getElementById('buscador-linhaLimite').value;
        const pctMin = document.getElementById('filtro-pctMin').value;
        const ocMin  = document.getElementById('filtro-ocorrMin').value;
        const puMax  = document.getElementById('filtro-pulosMax').value;
        const hMap   = {'60':'3h','120':'6h','240':'12h','480':'24h','960':'48h','todas':'Todas'};

        const active = [];
        if (liga !== 'all')            active.push({ id:'buscador-ligas',       txt:`Liga: ${liga}` });
        if (horas !== '60')            active.push({ id:'buscador-linhaLimite', txt:`Per√≠odo: ${hMap[horas]||horas}` });
        if (pctMin !== '0')            active.push({ id:'filtro-pctMin',        txt:`% min: ${pctMin}%` });
        if (ocMin  !== '0')            active.push({ id:'filtro-ocorrMin',      txt:`Ocorr. min: ${ocMin}` });
        if (puMax  !== '999')          active.push({ id:'filtro-pulosMax',      txt:`Pulos max: ${puMax}` });

        document.getElementById('filterTags').innerHTML = active.map(f =>
          `<span class="f-tag">${f.txt}<button class="f-tag-del" onclick="removeFilter('${f.id}')" title="Remover filtro">‚úï</button></span>`
        ).join('');
      }

      async function fetchLigaData(liga) {
        try {
          const r = await fetch(`${API_BASE_URL}${liga}`);
          if (!r.ok) throw new Error(`HTTP ${r.status}`);
          return await r.json();
        } catch(e) { console.error(e); return []; }
      }

      function convertGameData(apiData) {
        return apiData.map(item => {
          const ft = item.ft.split(" x ");
          const ht = item.ht && item.ht !== "OUT" ? item.ht.split(" x ") : ["0","0"];
          return [item.time_a+" vs "+item.time_b, parseInt(ft[0]), parseInt(ft[1]), item.data, ht[0], ht[1]];
        });
      }

      async function loadData() {
        const liga   = document.getElementById("buscador-ligas").value;
        const limite = document.getElementById("buscador-linhaLimite").value;
        const novosJogos = [];

        setLoading(true, "Atualizando dados...");
        updateStatus("Carregando dados da API...", 'loading');

        try {
          if (liga === "all") {
            for (const l of ligas) {
              const data = await fetchLigaData(l);
              novosJogos.push(...convertGameData(data));
            }
          } else {
            novosJogos.push(...convertGameData(await fetchLigaData(liga)));
          }

          if (limite !== "todas") {
            jogos = novosJogos.slice(-parseInt(limite));
          } else {
            jogos = novosJogos;
          }

          setLoading(false);
          updateStatus(`${jogos.length} jogos carregados ‚Äî analisando...`);
          updateFilterTags();
          analyzeData();
        } catch(e) {
          setLoading(false);
          updateStatus(`Erro: ${e.message}`, 'error');
        }
      }

      function verificaCondicaoMercado(mercado, jogo) {
        const gC=parseInt(jogo[1]), gF=parseInt(jogo[2]), tot=gC+gF;
        const gCht=parseInt(jogo[4])||0, gFht=parseInt(jogo[5])||0;
        switch(mercado) {
          case "ambasMarcam":    return gC>0 && gF>0;
          case "ambasNaoMarcam": return gC===0 || gF===0;
          case "casaVence":      return gC>gF;
          case "foraVence":      return gF>gC;
          case "empate":         return gC===gF;
          case "empateHT":       return gCht===gFht;
          case "over1.5":        return tot>1;
          case "under1.5":       return tot<2;
          case "over2.5":        return tot>2;
          case "under2.5":       return tot<3;
          case "over3.5":        return tot>3;
          case "under3.5":       return tot<4;
          case "over5":          return tot>5;
          case "exato0":         return tot===0;
          case "exato1":         return tot===1;
          case "exato2":         return tot===2;
          case "exato3":         return tot===3;
          case "exato4":         return tot===4;
          default: return false;
        }
      }

      function analyzeData() {
        const mercado  = document.getElementById("buscador-mercado").value;
        const numTiros = parseInt(document.getElementById("buscador-numTiros").value);
        const topN     = parseInt(document.getElementById("buscador-topResults").value);
        const pctMin   = parseFloat(document.getElementById("filtro-pctMin").value);
        const ocorrMin = parseInt(document.getElementById("filtro-ocorrMin").value);
        const pulosMax = parseInt(document.getElementById("filtro-pulosMax").value);
        const sortBy   = document.getElementById("filtro-sortBy").value;

        const stats = {};
        jogos.forEach((jogo, idx) => {
          const placar = `${parseInt(jogo[1])} x ${parseInt(jogo[2])}`;
          if (!stats[placar]) stats[placar] = {contagem:0, ocorrencias:0, pulos:0};
          stats[placar].contagem++;
          for (let i=2; i<=60; i++) {
            if (idx+i+(numTiros-1) < jogos.length) {
              let ok=true;
              for (let j=0; j<numTiros; j++) {
                if (!verificaCondicaoMercado(mercado, jogos[idx+i+j])){ ok=false; break; }
              }
              if (ok){ stats[placar].ocorrencias++; stats[placar].pulos=i; break; }
            }
          }
        });

        let arr = Object.entries(stats).map(([placar,s])=>({
          placar, ocorrencias:s.contagem,
          percentual:parseFloat(((s.ocorrencias/s.contagem)*100).toFixed(2)),
          pulos:s.pulos
        }));

        arr = arr.filter(d => d.percentual>=pctMin && d.ocorrencias>=ocorrMin && d.pulos<=pulosMax);

        const sorters = {
          percentual:  (a,b)=>b.percentual-a.percentual || a.pulos-b.pulos,
          ocorrencias: (a,b)=>b.ocorrencias-a.ocorrencias || b.percentual-a.percentual,
          pulos:       (a,b)=>a.pulos-b.pulos || b.percentual-a.percentual,
        };
        arr.sort(sorters[sortBy]||sorters.percentual);
        const top = arr.slice(0,topN);

        // Summary cards
        document.getElementById('sumTotal').textContent    = jogos.length;
        document.getElementById('sumLiga').textContent     =
          document.getElementById('buscador-ligas').options[document.getElementById('buscador-ligas').selectedIndex].text;
        document.getElementById('sumPatterns').textContent = Object.keys(stats).length;
        if (top.length) {
          document.getElementById('sumBestPct').textContent   = `${top[0].percentual}%`;
          document.getElementById('sumBestScore').textContent = `Placar: ${top[0].placar}`;
        } else {
          document.getElementById('sumBestPct').textContent   = '‚Äî';
          document.getElementById('sumBestScore').textContent = '‚Äî';
        }
        document.getElementById('sumMercado').textContent = mercadoLabels[mercado]||mercado;
        document.getElementById('sumGales').textContent   = `${numTiros} tiro${numTiros>1?'s':''} consecutivo${numTiros>1?'s':''}`;
        document.getElementById('tableCount').textContent = `${top.length} padr√µes`;
        updateStatus(`An√°lise conclu√≠da ‚Äî ${top.length} de ${arr.length} padr√µes exibidos.`);

        const tbody = document.getElementById('tableBody');
        if (!top.length) {
          tbody.innerHTML = `<tr><td colspan="5"><div class="empty-state"><div class="empty-icon">üîç</div>Nenhum padr√£o encontrado com os filtros atuais.</div></td></tr>`;
          return;
        }

        // Build new rows in a fragment (no flicker)
        const frag = document.createDocumentFragment();
        top.forEach((stat,i) => {
          const pct      = stat.percentual;
          const pctClass = pct>=70?'pct-high':pct>=50?'pct-medium':'pct-low';
          const barClass = pct>=70?'bar-g':pct>=50?'bar-o':'bar-r';
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td><span class="rank">${i+1}</span></td>
            <td><span class="score-badge">${stat.placar}</span></td>
            <td><span class="skip-badge">+${stat.pulos}</span></td>
            <td>${stat.ocorrencias}</td>
            <td>
              <div class="bar-wrap">
                <span class="pct-pill ${pctClass}">${pct}%</span>
                <div class="bar-bg"><div class="bar-fill ${barClass}" style="width:${Math.min(pct,100)}%"></div></div>
              </div>
            </td>
          `;
          frag.appendChild(tr);
        });
        tbody.innerHTML = '';
        tbody.appendChild(frag);
      }

      function sortTable(colIdx) {
        const table   = document.getElementById("buscador-results");
        const headers = table.querySelectorAll("th");
        headers.forEach(h=>h.classList.remove("sorted-asc","sorted-desc"));
        const rows = Array.from(table.tBodies[0].rows);
        rows.sort((a,b)=>{
          let av=a.cells[colIdx]?.textContent?.trim()||'';
          let bv=b.cells[colIdx]?.textContent?.trim()||'';
          av=isNaN(av)?av:parseFloat(av);
          bv=isNaN(bv)?bv:parseFloat(bv);
          if (typeof av==='number') return sortOrderAsc?av-bv:bv-av;
          return sortOrderAsc?av.localeCompare(bv):bv.localeCompare(av);
        });
        sortOrderAsc = colIdx===currentSortColumn?!sortOrderAsc:true;
        currentSortColumn = colIdx;
        headers[colIdx]?.classList.add(sortOrderAsc?"sorted-asc":"sorted-desc");
        const frag = document.createDocumentFragment();
        rows.forEach(r=>frag.appendChild(r));
        table.tBodies[0].appendChild(frag);
      }

      loadData();
      setInterval(loadData, 300000);
    </script>

    <!-- Prote√ß√£o original (sem altera√ß√µes) -->
    <script>
      document.addEventListener("contextmenu", function(e){ e.preventDefault(); });
      document.addEventListener("keydown", function(e){
        if (e.key==="F12") e.preventDefault();
        if (e.ctrlKey&&e.shiftKey&&e.key==="I") e.preventDefault();
        if (e.ctrlKey&&e.key==="u") e.preventDefault();
        if (e.ctrlKey&&e.shiftKey&&e.key==="J") e.preventDefault();
        if (e.ctrlKey&&e.shiftKey&&e.key==="C") e.preventDefault();
        if (e.ctrlKey&&e.key==="s") e.preventDefault();
        if (e.ctrlKey&&e.key==="p") e.preventDefault();
      });
      const devtools={open:false};
      const element=new Image();
      Object.defineProperty(element,'id',{get:function(){devtools.open=true;}});
      (function(){
        const threshold=160;
        const check=function(){
          if((window.outerWidth-window.innerWidth)>threshold||(window.outerHeight-window.innerHeight)>threshold)
            devtools.open=true;
        };
        window.addEventListener('resize',check);
        setInterval(check,500);
      })();
      console.log('%c',element);
      setInterval(function(){
        if(devtools.open){
          document.body.innerHTML='<h1>Acesso n√£o autorizado detectado</h1>';
          devtools.open=false;
        }
      },1000);
      document.addEventListener('selectstart',function(e){e.preventDefault();});
      document.addEventListener('dragstart',function(e){e.preventDefault();});
      console.log=function(){};
      console.debug=function(){};
      console.info=function(){};
    </script>

    <!-- Header original (sem altera√ß√µes) -->
    <script>
      fetch('header.html')
        .then(response=>response.text())
        .then(data=>{document.getElementById('header').innerHTML=data;});
    </script>

    <script src="redirecionar.js"></script>

  </body>
</html>