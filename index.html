<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="style.css" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>    
        <title>BetStat</title>
        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
            import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
    

            const firebaseConfig = {
                apiKey: "AIzaSyDmLGMBnUa2YOdP0b-zlZepXjm-zlV477A",
                authDomain: "linoautenticador.firebaseapp.com",
                projectId: "linoautenticador",
                storageBucket: "linoautenticador.firebasestorage.app",
                messagingSenderId: "946057648829",
                appId: "1:946057648829:web:ac5c2b1ba66e651f9d75d4",
                measurementId: "G-4WT805FFHQ"
            };
    

            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
    

            onAuthStateChanged(auth, (user) => {
                if (!user) {

                    window.location.href = "auth.html"; 
                } 
            });
    

            window.logout = function() {
                signOut(auth).then(() => {
                    alert("Você saiu com sucesso!");
                    window.location.href = "auth.html"; 
                }).catch((error) => {
                    alert("Erro ao sair: " + error.message);
                });
            };
        </script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
    
            gtag('config', 'G-4WT805FFHQ');
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
        
    </head>
    
<body>
    <header>
        <div class="header-container">
            <img src="img/logo.png" alt="Logo" class="logo" />
            <div class="selectors-container">
                <div class="nav-seletor">
                    <label for="ligas">Betano:</label>
                    <select id="ligas" onchange="redirecionar(this)">
                        <option value="">Selecione uma liga...</option> 
                        <option value="index.html">🏆 Taça Glória Eterna</option>
                        <option value="copa_america.html">🏆 Copa América</option>
                        <option value="euro.html">🏆 Euro</option>
                        <option value="campeonato_italiano.html">🏆 Campeonato Italiano</option>
                        <option value="copa_das_estrelas.html">🏆 Copa das Estrelas</option>
                        <option value="british_derbies.html">🏆 British Derbies</option>
                        <option value="scudetto_italiano.html">🏆 Scudetto Italiano</option>
                        <option value="liga_espanhola.html">🏆 Liga Espanhola</option>
                        <option value="ligas_america.html">🏆 Ligas América</option>
                        <option value="copa.html">🏆 Copa</option>
                        <option value="premier.html">🏆 Premier</option>
                        <option value="campeoes.html">🏆 Campeões</option>

                    </select>
                </div>
            </div>
        </div>

        <div class="nav-seletor">
            <label for="redes">Suporte:</label>
            <select id="redes" onchange="redirecionar(this)">
                <option value="">Selecione um suporte</option>
                <option value="https://t.me/betstatsite">Telegram</option>

            </select>
        </div>
            </div>
        </div>

        <button onclick="logout()">Sair</button>
    </header>

    <div class="container" id="mainContainer"></div>

   
            <table id="time-tabela-resultados">
              <thead>
                <tr>
                  
                </tr>
              </thead>
              <tbody>
               
              </tbody>
            </table>


    <div id="market-selector">
        <label for="market">🏆 Ranking Top 10 </label>
        <select id="market">
            <option value="ambos-sim">Ambas Sim</option>
            <option value="ambos-nao">Ambas Não</option>
            <option value="casaVence">Casa Vence</option>
            <option value="foraVence">Fora Vence</option>
            <option value="empates">Empates</option>
            <option value="over1_5">Over 1.5</option>
            <option value="under1_5">Under 1.5</option>
            <option value="over2_5">Over 2.5</option>
            <option value="under2_5">Under 2.5</option>
            <option value="over3_5">Over 3.5</option>
            <option value="under3_5">Under 3.5</option>
            <option value="cincoMaisGols">5 ou mais Gols</option>
        </select>
        <button id="toggle-ranking">Mostrar Ranking</button>
      </div>


<div id="ranking" class="hidden"></div>


            
        <div class="maximaplacar-table-container">
            <table class="maximaplacar-table" id="maximaplacar-placaresTabela">
                <thead>
                    <tr class="maximaplacar-header" id="maximaplacar-header">

                    </tr>
                </thead>
                <tbody id="maximaplacar-resultados">

                </tbody>
            </table>
        </div>

        <div class="maximamercado-table-container">
            <table class="maximamercado-table" id="maximamercado-mercadosTabela">
                <thead>
                    <tr class="maximamercado-header" id="maximamercado-header">

                    </tr>
                </thead>
                <tbody id="maximamercado-resultados">

                </tbody>
            </table>
        </div>

        <div class="buscador-container">
            <div>
              <input type="text" id="buscador-placar" class="buscador-input" placeholder="Placar (Ex: 0x1)">
              <select id="buscador-mercado" class="buscador-select" aria-label="Selecione o mercado">
                <option value="ambasMarcam" selected>Ambas Sim</option>
                <option value="ambasNaoMarcam">Ambas Não</option>
                <option value="casaVence">Casa vence</option>
                <option value="foraVence">Fora vence</option>
                <option value="empate">Empate</option>
                <option value="over1.5">Over 1.5</option>
                <option value="under1.5">Under 1.5</option>
                <option value="over2.5">Over 2.5</option>
                <option value="under2.5">Under 2.5</option>
                <option value="over3.5">Over 3.5</option>
                <option value="under3.5">Under 3.5</option>
                <option value="over5">Over 5+</option>
              </select>      
              <input type="number" id="buscador-pular" class="buscador-input" placeholder="Pular Casas">
              <input type="number" id="buscador-analisar" class="buscador-input" placeholder="Qtd. entradas">
              <button class="buscador-btn-green" onclick="buscadorAnalisar()">Analisar</button>
              <button class="buscador-btn-red" onclick="buscadorLimpar()">Limpar</button>
            </div>
            <div class="buscador-result">
              <p id="buscador-localizados">LOCALIZADOS: 0</p>
              <p id="buscador-greens" class="buscador-green">Greens: 0 (0%)</p>
              <p id="buscador-reds" class="buscador-red">Reds: 0 (0%)</p>
            </div>
          </div>

    
    
    <canvas id="golsplus" width="1080" height="250"></canvas>

    <div class="chart-container">
        <canvas id="myChart" width="1080" height="250"></canvas> 
    </div>


    <div class="button-container">

        <button class="toggle-button" onclick="toggleVideo()">Expandir Vídeo</button>
    </div>


    <div class="live-container">

        <div class="live" id="liveVideo">
            <iframe 
                src="https://stoiximan-br.live.inspiredvss.co.uk/inggWebViewer/?cust=stoiximan-br&ch=soccercopabr" 
                width="80%" 
                height="355"  
                allowfullscreen 
                title="ao vivo">
            </iframe>
            

            <div class="iframe-overlay" 
                 oncontextmenu="return false;" 
                 onclick="return false;">
            </div>
    
            <h6>Instale a extensão "Ignore X-Frame Headers" no seu navegador</h6>
        </div>
    </div>

     

    <div class="seletor-container">

        <div id="resultDisplay">
            <div id="greenPercentage">Greens: 0%</div>
            <div id="redPercentage">Reds: 0%</div>
        </div>

        <div class="seletor-horas">
            <label for="seletorHoras">Horas:</label>
            <select id="seletorHoras">
                <option value="3">3 horas</option>
                <option value="6">6 horas</option>
                <option value="12" selected>12 horas</option>
                <option value="24">24 horas</option>
            </select>
        </div>

        <div class="seletor-resultado">
            <label for="seletorResultado">Mercado:</label>
            <select id="seletorResultado">
                <option value="ambasMarcam" selected>Ambas Sim</option>
                <option value="ambasNaoMarcam">Ambas Não</option>
                <option value="casaVence">Casa vence</option>
                <option value="foraVence">Fora vence</option>
                <option value="empate">Empate</option> 
                <option value="over1.5">Over 1.5</option>
                <option value="under1.5">Under 1.5</option>
                <option value="over2.5">Over 2.5</option>
                <option value="under2.5">Under 2.5</option>
                <option value="over3.5">Over 3.5</option>
                <option value="under3.5">Under 3.5</option>
                <option value="over5">Over 5+</option>
            </select>
        </div>

        <div class="seletor-tipo-placar">
            <label for="seletorTipoPlacar">Resultado:</label>
            <select id="seletorTipoPlacar">
                <option value="ft" selected>FT</option>
                <option value="ht">HT</option>
            </select>
        </div>

        <div id="resultDisplay">
            <div id="totalGols">Gols: 0</div>
            <div id="mediaGolsHora">Média Gols Por Hora: 0</div>
            <h2 class="custom-color">Betano | Glória Eterna</h2>
        </div>

    </div>


    <table id="tabelaResultados">
        <thead>
            <div class="minutofixo-header">
                <div id="market-percentages"></div> 
            </div>
            <tr id="linhaPercentual">
                <th>📊</th>
            </tr>
            <tr>
                <th>H</th>
                <th class="minute-header">1</th>
                <th class="minute-header">4</th>
                <th class="minute-header">7</th>
                <th class="minute-header">10</th>
                <th class="minute-header">13</th>
                <th class="minute-header">16</th>
                <th class="minute-header">19</th>
                <th class="minute-header">22</th>
                <th class="minute-header">25</th>
                <th class="minute-header">28</th>
                <th class="minute-header">31</th>
                <th class="minute-header">34</th>
                <th class="minute-header">37</th>
                <th class="minute-header">40</th>
                <th class="minute-header">43</th>
                <th class="minute-header">46</th>
                <th class="minute-header">49</th>
                <th class="minute-header">52</th>
                <th class="minute-header">55</th>
                <th class="minute-header">58</th>
                <th>⚽️</th>
                <th>✅</th>
                <th>📊</th>
            </tr>
        </thead>    
        <tbody>

        </tbody>
        <tfoot></tfoot>
    </table>
      
    <table>
        <thead>
            <tr>
                <th>Mercado</th>
                <th>1</th>
                <th>4</th>
                <th>7</th>
                <th>10</th>
                <th>13</th>
                <th>16</th>
                <th>19</th>
                <th>22</th>
                <th>25</th>
                <th>28</th>
                <th>31</th>
                <th>34</th>
                <th>37</th>
                <th>40</th>
                <th>43</th>
                <th>46</th>
                <th>49</th>
                <th>52</th>
                <th>55</th>
                <th>58</th>
            </tr>
        </thead>
        <tbody id="minutofixo-market-table">

        </tbody>
    </table>

    <script>
        const minutosFixos = [1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52, 55, 58];

        function redirecionar(selectElement) {
            const url = selectElement.value;
            if (url) {
                window.location.href = url;
            }
        }
        
        let placarSelecionado = localStorage.getItem('placarSelecionado');
        

        function selecionarPlacaresIguais(placarAlvo) {
            const placares = document.querySelectorAll('.placar');
            
            placares.forEach(placar => {

                const texto = placar.childNodes[0].textContent.trim();
                
                if (placarAlvo) {
                    if (texto === placarAlvo) {
                        placar.classList.add('placar-selecionado');
                    } else {
                        placar.classList.remove('placar-selecionado');
                    }
                } else {
                    placar.classList.remove('placar-selecionado');
                }
            });
        }
        
        function criarTabela(dados) {
            const tabelaBody = document.querySelector("#tabelaResultados tbody");
            const linhaPercentual = document.getElementById('linhaPercentual');
            linhaPercentual.innerHTML = '<th>📊</th>';
            tabelaBody.innerHTML = '';
        
            const horasSelecionadas = parseInt(document.querySelector("#seletorHoras").value);
        
            dados.sort((a, b) => {
                const dataHoraA = new Date(`${a.data}T${a.hora.toString().padStart(2, '0')}:00:00`).getTime();
                const dataHoraB = new Date(`${b.data}T${b.hora.toString().padStart(2, '0')}:00:00`).getTime();
                return dataHoraA - dataHoraB;
            });
            
            const chavesJaProcessadas = new Set();
            const mapeamentoChaveLinha = {};
        
            let contagemLinhas = 0;
        

            dados.reverse().forEach(dado => {
                if (contagemLinhas >= horasSelecionadas) return;
        
                const dataHora = new Date(dado.data);
                const hora = dado.hora;
                const chave = `${dataHora.toISOString().split('T')[0]}-${hora}`;
        
                if (!chavesJaProcessadas.has(chave)) {
                    const novaLinha = document.createElement("tr");
                    novaLinha.setAttribute('data-chave', chave);
        
                    const colunaHora = document.createElement("td");
                    colunaHora.textContent = hora.toString().padStart(2, '0');
                    novaLinha.appendChild(colunaHora);
        
                    minutosFixos.forEach(() => {
                        novaLinha.appendChild(document.createElement("td"));
                    });
        
                    const contagemMercadosCelula = document.createElement("td");
                    contagemMercadosCelula.textContent = 0;
                    novaLinha.appendChild(contagemMercadosCelula);
        
                    const totalGolsCelula = document.createElement("td");
                    totalGolsCelula.textContent = 0;
                    novaLinha.appendChild(totalGolsCelula);
        
                    const porcentagemCelula = document.createElement("td");
                    porcentagemCelula.textContent = "0%";
                    novaLinha.appendChild(porcentagemCelula);
        
                    tabelaBody.appendChild(novaLinha);
                    chavesJaProcessadas.add(chave);
                    mapeamentoChaveLinha[chave] = novaLinha;
        
                    contagemLinhas++;
                }
            });
        

            function handlePlacarClick(event) {

                const placarClicado = event.currentTarget.childNodes[0].textContent.trim();
                
                if (placarSelecionado === placarClicado) {
                    placarSelecionado = null;
                    localStorage.removeItem('placarSelecionado');
                    selecionarPlacaresIguais(null);
                } else {
                    placarSelecionado = placarClicado;
                    localStorage.setItem('placarSelecionado', placarClicado);
                    selecionarPlacaresIguais(placarClicado);
                }
            }
        

            dados.forEach(dado => {
                const dataHora = new Date(dado.data);
                const hora = dado.hora;
                const chave = `${dataHora.toISOString().split('T')[0]}-${hora}`;
                const linha = mapeamentoChaveLinha[chave];
        
                if (linha) {
                    const indexMinuto = minutosFixos.indexOf(dado.minuto);
                    if (indexMinuto !== -1) {
                        const colunaMinuto = linha.children[1 + indexMinuto];
        
                        if (!colunaMinuto.querySelector('.placar')) {
                            const placar = document.createElement("div");
                            placar.className = "placar";
        
                            const tipoPlacar = document.querySelector("#seletorTipoPlacar").value;
                            const placarAtual = tipoPlacar === "ft" ? dado.ft : dado.ht;
        
                            const placarTexto = document.createElement("span");
                            placarTexto.textContent = placarAtual;
                            placar.appendChild(placarTexto);
        

                            placar.addEventListener('click', handlePlacarClick);
        

                            const tooltip = document.createElement("span");
                            tooltip.className = "tooltip";
                            tooltip.textContent = `${dado.time_a} vs ${dado.time_b}`;
                            placar.appendChild(tooltip);
        
                            colunaMinuto.appendChild(placar);
        

                            if (placarSelecionado === placarAtual) {
                                placar.classList.add('placar-selecionado');
                            }
        
                            const selecaoResultado = document.querySelector("#seletorResultado").value;
                            let acerto = false;
                            const resultadoA = parseInt(placarAtual.split(' x ')[0]);
                            const resultadoB = parseInt(placarAtual.split(' x ')[1]);
        

                            if (selecaoResultado === "ambasMarcam") {
                                acerto = resultadoA > 0 && resultadoB > 0;
                            } else if (selecaoResultado === "ambasNaoMarcam") {
                                acerto = resultadoA === 0 || resultadoB === 0;
                            } else if (selecaoResultado === "over1.5") {
                                acerto = (resultadoA + resultadoB) > 1.5;
                            } else if (selecaoResultado === "under1.5") {
                                acerto = (resultadoA + resultadoB) <= 1.5;
                            } else if (selecaoResultado === "over2.5") {
                                acerto = (resultadoA + resultadoB) > 2.5;
                            } else if (selecaoResultado === "under2.5") {
                                acerto = (resultadoA + resultadoB) <= 2.5;
                            } else if (selecaoResultado === "over3.5") {
                                acerto = (resultadoA + resultadoB) > 3.5;
                            } else if (selecaoResultado === "under3.5") {
                                acerto = (resultadoA + resultadoB) <= 3.5;
                            } else if (selecaoResultado === "over5") {
                                acerto = (resultadoA + resultadoB) > 5;
                            } else if (selecaoResultado === "casaVence") {
                                acerto = resultadoA > resultadoB;
                            } else if (selecaoResultado === "foraVence") {
                                acerto = resultadoB > resultadoA;
                            } else if (selecaoResultado === "empate") {
                                acerto = resultadoA === resultadoB;
                            }
        
                            colunaMinuto.style.backgroundColor = acerto ? "#018b06" : "#be0e02";
        
                            if (acerto) {
                                linha.children[linha.children.length - 2].textContent = parseInt(linha.children[linha.children.length - 2].textContent) + 1;
                            }
        
                            const totalGolsCelula = linha.children[linha.children.length - 3];
                            const totalGols = resultadoA + resultadoB;
                            totalGolsCelula.textContent = parseInt(totalGolsCelula.textContent) + totalGols;
                        }
                    }
                }
            });
        

            const todasLinhas = Array.from(tabelaBody.querySelectorAll('tr'));
            todasLinhas.forEach((row) => {
                const totalCelsProcessadas = Array.from(row.cells).slice(1, -3).filter(cell => cell.querySelector('.placar')).length;
                const celsMercado = parseInt(row.children[row.children.length - 2].textContent);
        
                const porcentagem = totalCelsProcessadas > 0 ? Math.floor((celsMercado / totalCelsProcessadas) * 100) : 0;
                const porcentagemCell = row.children[row.children.length - 1];
                porcentagemCell.innerText = `${porcentagem}%`;
        
                if (porcentagem >= 50) {
                    porcentagemCell.classList.add('porcentagem-verde');
                    porcentagemCell.classList.remove('porcentagem-branca');
                } else {
                    porcentagemCell.classList.add('porcentagem-branca');
                    porcentagemCell.classList.remove('porcentagem-verde');
                }
            });
        

            const totalColunas = minutosFixos.length;
            const totalMercadosPorColuna = Array(totalColunas).fill(0);
            const totalAcertosPorColuna = Array(totalColunas).fill(0);
        
            todasLinhas.forEach(row => {
                Array.from(row.cells).slice(1, -3).forEach((cell, index) => {
                    if (cell.querySelector('.placar')) {
                        totalMercadosPorColuna[index]++;
                        if (cell.style.backgroundColor === "rgb(1, 139, 6)") {
                            totalAcertosPorColuna[index]++;
                        }
                    }
                });
            });
        
            linhaPercentual.innerHTML = '<th>📈</th>';
        
            totalMercadosPorColuna.forEach((totalMercados, index) => {
                const cell = document.createElement("td");
                const porcentagemVertical = totalMercados > 0 ? Math.floor((totalAcertosPorColuna[index] / totalMercados) * 100) : 0;
                cell.textContent = `${porcentagemVertical}%`;
        
                if (porcentagemVertical > 49) {
                    cell.classList.add('porcentagem-verde');
                    cell.classList.remove('porcentagem-branca');
                } else {
                    cell.classList.add('porcentagem-branca');
                    cell.classList.remove('porcentagem-verde');
                }
        
                linhaPercentual.appendChild(cell);
            });
        
            for (let i = 0; i < 3; i++) {
                const emptyCell = document.createElement("td");
                emptyCell.textContent = "";
                linhaPercentual.appendChild(emptyCell);
            }
        

            if (placarSelecionado) {
                selecionarPlacaresIguais(placarSelecionado);
            }
        }
        
        async function buscarDados() {
            try {
                const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
                if (!response.ok) {
                    throw new Error('Erro ao buscar os dados da rota.');
                }
                const dados = await response.json();
                criarTabela(dados);
            } catch (error) {
                console.error('Erro:', error);
            }
        }
        
        buscarDados();
        setInterval(buscarDados, 10000);
        
        document.querySelector("#seletorHoras").addEventListener("change", buscarDados);
        document.querySelector("#seletorResultado").addEventListener("change", buscarDados);
        document.querySelector("#seletorTipoPlacar").addEventListener("change", buscarDados);

        
    </script>
    
<script>
    const ctx = document.getElementById('myChart').getContext('2d');


    let fetchedData = []; 
    let displayData = []; 
    let initialPercentage = 50; 
    let initialPercentageAmbasNaoMarcam = 50; 
    let initialCasaVence = 50; 
    let initialForaVence = 50; 
    let initialEmpate = 50; 


    async function fetchChartData() {
        try {
            const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
            if (!response.ok) {
                throw new Error(`Erro na requisição: ${response.status}`);
            }
            const data = await response.json();

            return data.slice(-320);
        } catch (error) {
            console.error('Erro ao buscar dados:', error);
            return [];
        }
    }
    

    function ambosMarcam(ft) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return golsA > 0 && golsB > 0;
    }
    function ambasNaoMarcam(ft) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return golsA === 0 || golsB === 0;
    }
    function casaVence(ft) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return golsA > golsB;
    }
    function foraVence(ft) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return golsB > golsA;
    }
    function empate(ft) { 
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return golsA === golsB;
    }
    function isOver(ft, threshold) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return (golsA + golsB) > threshold;
    }
    function isUnder(ft, threshold) {
        const [golsA, golsB] = ft.split(' x ').map(Number);
        return (golsA + golsB) < threshold;
    }
    

    async function updateChart() {
        fetchedData = await fetchChartData();
        if (!isOrdered(fetchedData)) {
            fetchedData.sort((a, b) => {
                const dateA = new Date(a.data);
                const dateB = new Date(b.data);
                if (dateA < dateB) return -1;
                if (dateA > dateB) return 1;
                if (a.hora < b.hora) return -1;
                if (a.hora > b.hora) return 1;
                return a.minuto - b.minuto;
            });
        }
        displayData = fetchedData.slice(-160);
        const labels = displayData.map(item => `${item.hora.toString().padStart(2, '0')}:${item.minuto.toString().padStart(2, '0')}`);
        const ambosMarcamData = [];
        const ambasNaoMarcamData = [];
        const casaVenceData = [];
        const foraVenceData = [];
        const empateData = []; 
        const over1_5Data = [];
        const under1_5Data = [];
        const over2_5Data = [];
        const under2_5Data = [];
        const over3_5Data = [];
        const under3_5Data = [];
    

        let previousAmbosMarcam = initialPercentage;
        let previousAmbasNaoMarcam = initialPercentageAmbasNaoMarcam;
        let previousCasaVence = initialCasaVence;
        let previousForaVence = initialForaVence;
        let previousEmpate = initialEmpate;
        let previousOver1_5 = initialPercentage;
        let previousUnder1_5 = initialPercentageAmbasNaoMarcam;
        let previousOver2_5 = initialPercentage;
        let previousUnder2_5 = initialPercentageAmbasNaoMarcam;
        let previousOver3_5 = initialPercentage;
        let previousUnder3_5 = initialPercentageAmbasNaoMarcam;
    

function getPreviousMatch(current, fetchedData) {
    let previousHour = current.hora - 1;


    if (current.hora === 0) {
        previousHour = 23;
    }



    const previousMatch = fetchedData.find(item => 
        item.hora === previousHour && 
        item.minuto === current.minuto
    );

    if (previousMatch) {

    } else {

    }

    return previousMatch;
}


for (let i = 0; i < displayData.length; i++) {
    const current = displayData[i];
    

    const previous = getPreviousMatch(current, fetchedData);

    if (previous) {

        if (ambosMarcam(previous.ft) !== ambosMarcam(current.ft)) {
            previousAmbosMarcam += ambosMarcam(current.ft) ? 5 : -5;
        }
        ambosMarcamData.push(previousAmbosMarcam);


        if (ambasNaoMarcam(previous.ft) !== ambasNaoMarcam(current.ft)) {
            previousAmbasNaoMarcam += ambasNaoMarcam(current.ft) ? 5 : -5;
        }
        ambasNaoMarcamData.push(previousAmbasNaoMarcam);


        if (casaVence(previous.ft) !== casaVence(current.ft)) {
            previousCasaVence += casaVence(current.ft) ? 5 : -5;
        }
        casaVenceData.push(previousCasaVence);


        if (foraVence(previous.ft) !== foraVence(current.ft)) {
            previousForaVence += foraVence(current.ft) ? 5 : -5;
        }
        foraVenceData.push(previousForaVence);

        if (empate(previous.ft) !== empate(current.ft)) { 
            previousEmpate += empate(current.ft) ? 5 : -5;
        }
        empateData.push(previousEmpate);


        const wasOver1_5 = isOver(previous.ft, 1.5);
        const isNowOver1_5 = isOver(current.ft, 1.5);
        if (wasOver1_5 !== isNowOver1_5) {
            previousOver1_5 += isNowOver1_5 ? 5 : -5;
        }
        over1_5Data.push(previousOver1_5);


        const wasUnder1_5 = isUnder(previous.ft, 1.5);
        const isNowUnder1_5 = isUnder(current.ft, 1.5);
        if (wasUnder1_5 !== isNowUnder1_5) {
            previousUnder1_5 += isNowUnder1_5 ? 5 : -5;
        }
        under1_5Data.push(previousUnder1_5);


        const wasOver2_5 = isOver(previous.ft, 2.5);
        const isNowOver2_5 = isOver(current.ft, 2.5);
        if (wasOver2_5 !== isNowOver2_5) {
            previousOver2_5 += isNowOver2_5 ? 5 : -5;
        }
        over2_5Data.push(previousOver2_5);


        const wasUnder2_5 = isUnder(previous.ft, 2.5);
        const isNowUnder2_5 = isUnder(current.ft, 2.5);
        if (wasUnder2_5 !== isNowUnder2_5) {
            previousUnder2_5 += isNowUnder2_5 ? 5 : -5;
        }
        under2_5Data.push(previousUnder2_5);


        const wasOver3_5 = isOver(previous.ft, 3.5);
        const isNowOver3_5 = isOver(current.ft, 3.5);
        if (wasOver3_5 !== isNowOver3_5) {
            previousOver3_5 += isNowOver3_5 ? 5 : -5;
        }
        over3_5Data.push(previousOver3_5);


        const wasUnder3_5 = isUnder(previous.ft, 3.5);
        const isNowUnder3_5 = isUnder(current.ft, 3.5);
        if (wasUnder3_5 !== isNowUnder3_5) {
            previousUnder3_5 += isNowUnder3_5 ? 5 : -5;
        }
        under3_5Data.push(previousUnder3_5);

    } else {

        ambosMarcamData.push(previousAmbosMarcam);
        ambasNaoMarcamData.push(previousAmbasNaoMarcam);
        casaVenceData.push(previousCasaVence);
        foraVenceData.push(previousForaVence);
        empateData.push(previousEmpate);
        over1_5Data.push(previousOver1_5);
        under1_5Data.push(previousUnder1_5);
        over2_5Data.push(previousOver2_5);
        under2_5Data.push(previousUnder2_5);
        over3_5Data.push(previousOver3_5);
        under3_5Data.push(previousUnder3_5);
    }
}


        myChart.data.labels = labels;
        myChart.data.datasets[0].data = ambosMarcamData;
        myChart.data.datasets[1].data = ambasNaoMarcamData;
        myChart.data.datasets[2].data = casaVenceData;
        myChart.data.datasets[3].data = foraVenceData;
        myChart.data.datasets[4].data = over1_5Data;
        myChart.data.datasets[5].data = under1_5Data;
        myChart.data.datasets[6].data = over2_5Data;
        myChart.data.datasets[7].data = under2_5Data;
        myChart.data.datasets[8].data = over3_5Data;
        myChart.data.datasets[9].data = under3_5Data;
        myChart.data.datasets[10].data = empateData;
        myChart.update();

        
        
    }
    

    function isOrdered(data) {
        for (let i = 1; i < data.length; i++) {
            const currentDate = new Date(data[i].data);
            const previousDate = new Date(data[i - 1].data);
            if (currentDate < previousDate) return false;
            if (currentDate.getTime() === previousDate.getTime()) {
                if (data[i].hora < data[i - 1].hora || 
                    (data[i].hora === data[i - 1].hora && data[i].minuto < data[i - 1].minuto)) return false;
            }
        }
        return true;
    }
    
    

    const chartData = {
        labels: [],
        datasets: [
            {
                label: 'Ambas Sim',
                data: [],
                backgroundColor: 'rgba(255, 255, 255, 0.5)',
                borderColor: 'rgba(255, 255, 255, 1)',
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 255, 255, 1)',
            },
            {
                label: 'Ambas Não',
                data: [],
                backgroundColor: 'rgba(255, 0, 0, 0.5)', 
                borderColor: 'rgba(255, 0, 0, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 0, 0, 1)', 
                hidden: true,
            },
            
            {
                label: 'Casa Vence',
                data: [],
                backgroundColor: 'rgba(255, 20, 147, 0.5)', 
                borderColor: 'rgba(255, 20, 147, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 20, 147, 1)', 
                hidden: true,
            },
            {
                label: 'Fora Vence',
                data: [],
                backgroundColor: 'rgba(0, 0, 255, 0.5)', 
                borderColor: 'rgba(0, 0, 255, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(0, 0, 255, 1)', 
                hidden: true,
            },
            {
                label: 'Over 1.5',
                data: [],
                backgroundColor: 'rgba(0, 255, 127, 0.5)', 
                borderColor: 'rgba(0, 255, 127, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(0, 255, 127, 1)', 
                hidden: true,
            },
            {
                label: 'Under 1.5',
                data: [],
                backgroundColor: 'rgba(0, 128, 0, 0.5)', 
                borderColor: 'rgba(0, 128, 0, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(0, 128, 0, 1)', 
                hidden: true,
            },
            {
                label: 'Over 2.5',
                data: [],
                backgroundColor: 'rgba(255, 255, 0, 0.5)', 
                borderColor: 'rgba(255, 255, 0, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 255, 0, 1)', 
                hidden: true,
            },
            {
                label: 'Under 2.5',
                data: [],
                backgroundColor: 'rgba(255, 165, 0, 0.5)', 
                borderColor: 'rgba(255, 165, 0, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 165, 0, 1)', 
                hidden: true,
            },
            {
                label: 'Over 3.5',
                data: [],
                backgroundColor: 'rgba(0, 255, 255, 0.5)', 
                borderColor: 'rgba(0, 255, 255, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(0, 255, 255, 1)', 
                hidden: true,
            },
            {
                label: 'Under 3.5',
                data: [],
                backgroundColor: 'rgba(255, 105, 180, 0.5)', 
                borderColor: 'rgba(255, 105, 180, 1)', 
                borderWidth: 2,
                pointRadius: 3,  
                pointBackgroundColor: 'rgba(255, 105, 180, 1)', 
                hidden: true,
            },

            {
                label: 'Empate',
                data: [],
                backgroundColor: 'rgba(128, 128, 128, 0.5)', 
                borderColor: 'rgba(128, 128, 128, 1)', 
                borderWidth: 2,
                pointRadius: 3,
                pointBackgroundColor: 'rgba(128, 128, 128, 1)', 
                hidden: true,
            }
    
            
        ]
    };
    

    const myChart = new Chart(ctx, {
    type: 'line',
    data: chartData,
    options: {
        scales: {
            y: {
                
                position: 'right',
                ticks: {
                    stepSize: 5, 
                    color: 'white'
                },
                grid: {
                    color: 'rgba(255, 255, 255, 0.5)', 
                    drawBorder: false,
                    lineWidth: 1 
                    
                },
            },
            x: {
                grid: {
                    color: 'rgba(0, 0, 0, 0)' 
                },
                ticks: {
                    color: 'white',
                    display: false 
                    
                },
                
                
            }
        },
        responsive: true,
        plugins: {
            legend: { display: true },
            tooltip: {
                enabled: true,
                callbacks: {
                    title: (context) => `Hora: ${context[0].label}`, 
                    label: (context) => {
                        const index = context.dataIndex;
                        const currentGame = displayData[index] || { ft: 'N/A', hora: 'N/A', minuto: 'N/A' };
                        const previousGame = fetchedData.find(item => item.hora === currentGame.hora - 1 && item.minuto === currentGame.minuto) || {};
    
                        return [
                            `Placar: ${currentGame.ft}`,
                        ];
                    }
                }
            }
        }
    }
    });
    

setInterval(updateChart, 5000);


updateChart();

</script>


<script>
let intervalId;

document.getElementById('toggle-ranking').addEventListener('click', function() {
    const rankingDiv = document.getElementById('ranking');
    rankingDiv.style.display = rankingDiv.style.display === 'none' ? 'block' : 'none';

    if (rankingDiv.style.display === 'block') {
        fetchRankingAndUpcomingMatches();
        clearInterval(intervalId);
        intervalId = setInterval(fetchRankingAndUpcomingMatches, 3000);
    } else {
        clearInterval(intervalId);
    }
});

document.getElementById('market').addEventListener('change', function() {
    fetchRankingAndUpcomingMatches();
});

async function fetchRankingAndUpcomingMatches() {
    const selectedMarket = document.getElementById('market').value;
    try {
        // Fetch both endpoints concurrently
        const [rankingResponse, upcomingResponse] = await Promise.all([
            fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna'),
            fetch('https://betstat.site/proximos/taca-gloria-eterna')
        ]);

        const rankingData = await rankingResponse.json();
        const upcomingMatches = await upcomingResponse.json();

        const games = Array.isArray(rankingData) ? rankingData.slice(0, 960) : [rankingData];

        const ranking = {};

        // Calculate rankings (same as before)
        games.forEach(game => {
            const [golsA, golsB] = game.ft.split(' x ').map(Number);
            const timeA = game.time_a;
            const timeB = game.time_b;

            ranking[timeA] = ranking[timeA] || {
                gols: 0,
                vitorias: 0,
                empates: 0,
                derrotas: 0,
                ambosSim: 0,
                ambosNao: 0,
                over1_5: 0,
                under1_5: 0,
                over2_5: 0,
                under2_5: 0,
                over3_5: 0,
                under3_5: 0,
                casaVence: 0,
                foraVence: 0,
                cincoMaisGols: 0
            };
            ranking[timeB] = ranking[timeB] || {
                gols: 0,
                vitorias: 0,
                empates: 0,
                derrotas: 0,
                ambosSim: 0,
                ambosNao: 0,
                over1_5: 0,
                under1_5: 0,
                over2_5: 0,
                under2_5: 0,
                over3_5: 0,
                under3_5: 0,
                casaVence: 0,
                foraVence: 0,
                cincoMaisGols: 0
            };

            // Update statistics (same as before)
            ranking[timeA].gols += golsA;
            ranking[timeB].gols += golsB;

            if (golsA > golsB) {
                ranking[timeA].vitorias += 1;
                ranking[timeB].derrotas += 1;
                ranking[timeA].casaVence += 1;
            } else if (golsA < golsB) {
                ranking[timeB].vitorias += 1;
                ranking[timeA].derrotas += 1;
                ranking[timeB].foraVence += 1;
            } else {
                ranking[timeA].empates += 1;
                ranking[timeB].empates += 1;
            }

            if (golsA > 0 && golsB > 0) {
                ranking[timeA].ambosSim += 1;
                ranking[timeB].ambosSim += 1;
            } else {
                ranking[timeA].ambosNao += 1;
                ranking[timeB].ambosNao += 1;
            }

            const totalGols = golsA + golsB;
            if (totalGols > 1) {
                ranking[timeA].over1_5 += 1;
                ranking[timeB].over1_5 += 1;
            } else {
                ranking[timeA].under1_5 += 1;
                ranking[timeB].under1_5 += 1;
            }

            if (totalGols > 2) {
                ranking[timeA].over2_5 += 1;
                ranking[timeB].over2_5 += 1;
            } else {
                ranking[timeA].under2_5 += 1;
                ranking[timeB].under2_5 += 1;
            }

            if (totalGols > 3) {
                ranking[timeA].over3_5 += 1;
                ranking[timeB].over3_5 += 1;
            } else {
                ranking[timeA].under3_5 += 1;
                ranking[timeB].under3_5 += 1;
            }

            if (totalGols >= 5) {
                ranking[timeA].cincoMaisGols += 1;
                ranking[timeB].cincoMaisGols += 1;
            }
        });


        const upcomingMatch = Array.isArray(upcomingMatches) ? upcomingMatches[0] : upcomingMatches;
        const teamsToHighlight = [upcomingMatch.time_a, upcomingMatch.time_b];


        const rankedTeams = Object.entries(ranking)
            .map(([team, stats]) => ({
                name: team,
                gols: stats.gols,
                vitorias: stats.vitorias,
                empates: stats.empates,
                derrotas: stats.derrotas,
                ambosSim: stats.ambosSim,
                ambosNao: stats.ambosNao,
                over1_5: stats.over1_5,
                under1_5: stats.under1_5,
                over2_5: stats.over2_5,
                under2_5: stats.under2_5,
                over3_5: stats.over3_5,
                under3_5: stats.under3_5,
                casaVence: stats.casaVence,
                foraVence: stats.foraVence,
                cincoMaisGols: stats.cincoMaisGols,
                isUpcomingTeam: teamsToHighlight.includes(team)
            }))
            .sort((a, b) => {
                if (selectedMarket === 'empates') {
                    return b.empates - a.empates;
                } else if (selectedMarket === 'ambos-sim') {
                    return b.ambosSim - a.ambosSim;
                } else if (selectedMarket === 'ambos-nao') {
                    return b.ambosNao - a.ambosNao;
                } else {
                    return b[selectedMarket] - a[selectedMarket];
                }
            });


        const teamPositions = {};
        rankedTeams.forEach((team, index) => {
            if (teamsToHighlight.includes(team.name)) {
                teamPositions[team.name] = index + 1;
            }
        });

        const rankingDiv = document.getElementById('ranking');
        rankingDiv.innerHTML = `
            <div style="margin-bottom: 20px; color: #ffffff;">
                <h2>Próximo Jogo: ${upcomingMatch.time_a} Vs ${upcomingMatch.time_b}</h2>
            <h3>
                <span style="color: #FFD700;">${upcomingMatch.time_a}</span> 
                <span style="color: #FFD700;">${teamPositions[upcomingMatch.time_a]}º lugar</span> | 
                <span style="color: #FFD700;">${upcomingMatch.time_b}</span> 
                <span style="color: #FFD700;">${teamPositions[upcomingMatch.time_b]}º lugar</span>
            </h3>

            </div>
            <table>
                <thead>
                    <tr style="color: #ffffff;">
                        <th>Posição</th>
                        <th>Time</th>
                        <th>Gols</th>
                        <th>V</th>
                        <th>E</th>
                        <th>D</th>
                        <th>${selectedMarket === 'ambos-sim' ? 'Ambas Sim' : 
                             (selectedMarket === 'ambos-nao' ? 'Ambas Não' : 
                             selectedMarket)}</th>
                    </tr>
                </thead>
                <tbody>
                    ${rankedTeams.slice(0, 10).map((item, index) => {
                        let rowColor = item.isUpcomingTeam ? '#c09500' : 
                                     (index < 5 ? '#2f6d35' : '#163519');
                        let rowStyle = item.isUpcomingTeam ? 'font-weight: bold;' : '';
                        
                        return `
                            <tr style="background-color: ${rowColor}; ${rowStyle}">
                                <td>${index < 5 ? '🏆 ' : ''}${index + 1}º</td>
                                <td>${item.name}</td>
                                <td>${item.gols}</td>
                                <td>${item.vitorias}</td>
                                <td>${item.empates}</td>
                                <td>${item.derrotas}</td>
                                <td>${selectedMarket === 'ambos-sim' ? item.ambosSim :
                                     (selectedMarket === 'ambos-nao' ? item.ambosNao :
                                     item[selectedMarket])}</td>
                            </tr>
                        `;
                    }).join('')}
                </tbody>
            </table>
        `;

    } catch (error) {
        console.error('Erro ao buscar dados:', error);
    }
}

window.onload = fetchRankingAndUpcomingMatches;

</script>



<script>

    async function fetchResults() {
        const response = await fetch("https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna");
        const data = await response.json();

        return data.slice(-480).reverse();
    }


        function calculatePercentage(data, market) {
            let greens = 0;
            let reds = 0;
  
            data.forEach(game => {
                const [scoreA, scoreB] = game.ft.split(" x ").map(Number);
  
                switch (market) {
                    case "ambasMarcam":
                        if (scoreA > 0 && scoreB > 0) greens++;
                        else reds++;
                        break;
                    case "ambasNaoMarcam":
                        if (scoreA === 0 || scoreB === 0) greens++;
                        else reds++;
                        break;
                    case "casaVence":
                        if (scoreA > scoreB) greens++;
                        else reds++;
                        break;
                    case "foraVence":
                        if (scoreA < scoreB) greens++;
                        else reds++;
                        break;
                    case "empate": 
                        if (scoreA === scoreB) greens++;
                        else reds++;
                        break;
                    case "over1.5":
                        if (scoreA + scoreB > 1.5) greens++;
                        else reds++;
                        break;
                    case "under1.5":
                        if (scoreA + scoreB <= 1.5) greens++;
                        else reds++;
                        break;
                    case "over2.5":
                        if (scoreA + scoreB > 2.5) greens++;
                        else reds++;
                        break;
                    case "under2.5":
                        if (scoreA + scoreB <= 2.5) greens++;
                        else reds++;
                        break;
                    case "over3.5":
                        if (scoreA + scoreB > 3.5) greens++;
                        else reds++;
                        break;
                    case "under3.5":
                        if (scoreA + scoreB <= 3.5) greens++;
                        else reds++;
                        break;
                    case "over5":
                        if (scoreA + scoreB > 5) greens++;
                        else reds++;
                        break;
                    default:
                        break;
                }
            });
  
            const total = greens + reds;
            return {
                greens: ((greens / total) * 100).toFixed(1),
                reds: ((reds / total) * 100).toFixed(1)
            };
        }
  

        document.getElementById("seletorResultado").addEventListener("change", async (event) => {
            const market = event.target.value;
            const games = await fetchResults();
            const percentages = calculatePercentage(games, market);
  
            document.getElementById("greenPercentage").innerText = `Greens: ${percentages.greens}%`;
            document.getElementById("redPercentage").innerText = `Reds: ${percentages.reds}%`;
        });
  

        window.addEventListener("load", async () => {
            const market = document.getElementById("seletorResultado").value;
            const games = await fetchResults();
            const percentages = calculatePercentage(games, market);
  
            document.getElementById("greenPercentage").innerText = `Greens: ${percentages.greens}%`;
            document.getElementById("redPercentage").innerText = `Reds: ${percentages.reds}%`;
        });


       async function fetchResults() {
        const response = await fetch("https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna");
        const data = await response.json();

        return data.slice(-240).reverse();
    }


    function calculateGoalStats(data) {
        let totalGols = 0;
        const totalHorasJogadas = 12; 

        data.forEach(game => {
            const [scoreA, scoreB] = game.ft.split(" x ").map(Number);
            totalGols += scoreA + scoreB;
        });

        const mediaGolsHora = (totalGols / totalHorasJogadas).toFixed(2);
        return {
            totalGols,
            mediaGolsHora
        };
    }


    document.getElementById("seletorResultado").addEventListener("change", async () => {
        const games = await fetchResults();
        const stats = calculateGoalStats(games);

        document.getElementById("totalGols").innerText = `Gols: ${stats.totalGols}`;
        document.getElementById("mediaGolsHora").innerText = `Média Gols Por Hora: ${stats.mediaGolsHora}`;
    });


    window.addEventListener("load", async () => {
        const games = await fetchResults();
        const stats = calculateGoalStats(games);

        document.getElementById("totalGols").innerText = `Gols: ${stats.totalGols}`;
        document.getElementById("mediaGolsHora").innerText = `Média Gols Por Hora: ${stats.mediaGolsHora}`;
    });
</script>

<script>

const URL_API_RESULTADOS = 'https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna';
const URL_API_PROXIMOS = 'https://betstat.site/proximos/taca-gloria-eterna';


let ultimosResultados = [];
let ultimoProximoJogo = null;
let modoComparacao = false;
let intervaloAtualizacao = null;


async function buscarProximoJogo() {
    try {
        const resposta = await fetch(URL_API_PROXIMOS);
        if (!resposta.ok) {
            throw new Error(`Erro HTTP! status: ${resposta.status}`);
        }
        const partidas = await resposta.json();
        

        if (!partidas[0]) return null;


        return {
            timeA: partidas[0].time_a,
            timeB: partidas[0].time_b,
            odds: {
                vitoriaCasa: partidas[0].casa_odds,
                empate: partidas[0].empate_odds,
                vitoriaFora: partidas[0].fora_odds,
                over15: partidas[0].over15_odds,
                under15: partidas[0].under15_odds,
                over25: partidas[0].over25_odds,
                under25: partidas[0].under25_odds,
                over35: partidas[0].over35_odds,
                under35: partidas[0].under35_odds,
                ambasMarcamSim: partidas[0].ambas_sim_odds,
                ambasMarcamNao: partidas[0].ambas_nao_odds
            },
            dataJogo: new Date(partidas[0].data_jogo),
            horaJogo: `${partidas[0].hora_jogo.slice(0, 5)}`
        };
    } catch (erro) {
        console.error('Erro ao buscar próximo jogo:', erro);
        return null;
    }
}


function formatarDataHora(dataStr, hora, minuto) {
    const data = new Date(dataStr);
    return `${String(data.getDate()).padStart(2, '0')}/${String(data.getMonth() + 1).padStart(2, '0')}/${data.getFullYear()} ${String(hora).padStart(2, '0')}:${String(minuto).padStart(2, '0')}`;
}


function calcularEstatisticasTime(partidas, nomeTime) {
    let estatisticas = {
        vitorias: 0,
        empates: 0,
        derrotas: 0,
        golsPro: 0,
        golsContra: 0,
        jogosInvicto: 0,
        jogosSemMarcar: 0,
        sequencia: [],
        racha: { tipo: '', quantidade: 0 }
    };

    partidas.forEach(partida => {
        const jogouEmCasa = partida.time_a === nomeTime;
        const [golsCasa, golsFora] = partida.ft.split(' x ').map(Number);
        const golsMarcados = jogouEmCasa ? golsCasa : golsFora;
        const golsSofridos = jogouEmCasa ? golsFora : golsCasa;

        let resultado;
        if (golsMarcados > golsSofridos) {
            estatisticas.vitorias++;
            resultado = 'V';
        } else if (golsMarcados < golsSofridos) {
            estatisticas.derrotas++;
            resultado = 'D';
        } else {
            estatisticas.empates++;
            resultado = 'E';
        }

        estatisticas.golsPro += golsMarcados;
        estatisticas.golsContra += golsSofridos;

        if (golsSofridos === 0) estatisticas.jogosInvicto++;
        if (golsMarcados === 0) estatisticas.jogosSemMarcar++;

        estatisticas.sequencia.unshift(resultado);
    });


    let rachaAtual = 1;
    const ultimoResultado = estatisticas.sequencia[0];
    for (let i = 1; i < estatisticas.sequencia.length; i++) {
        if (estatisticas.sequencia[i] === ultimoResultado) {
            rachaAtual++;
        } else {
            break;
        }
    }
    estatisticas.racha = {
        tipo: ultimoResultado,
        quantidade: rachaAtual
    };

    estatisticas.sequencia = estatisticas.sequencia.slice(0, 5);
    return estatisticas;
}


function criarSecaoTime(titulo, partidas, nomeTime) {
    const estatisticas = calcularEstatisticasTime(partidas.filter(partida => 
        partida.time_a === nomeTime || partida.time_b === nomeTime
    ), nomeTime);

    const totalJogos = estatisticas.vitorias + estatisticas.empates + estatisticas.derrotas;
    const aproveitamento = ((estatisticas.vitorias / totalJogos) * 100).toFixed(1);

    const mercadoSugerido = sugerirMercado(estatisticas);

    return `
        <div class="section">
            <div class="section-header">${titulo}</div>
            <div class="stats-container">
                <div class="stats-row">
                    <span class="stats-label">Aproveitamento:</span>
                    <span class="stats-value">${aproveitamento}%</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">V - E - D:</span>
                    <span class="stats-value">${estatisticas.vitorias} | ${estatisticas.empates} | ${estatisticas.derrotas}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Gols:</span>
                    <span class="stats-value">Marcados: ${estatisticas.golsPro} | Sofridos: ${estatisticas.golsContra}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Jogos sem sofrer gols:</span>
                    <span class="stats-value">${estatisticas.jogosInvicto}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Jogos sem marcar:</span>
                    <span class="stats-value">${estatisticas.jogosSemMarcar}</span>
                </div>
            </div>
            <div class="match-container">
                ${partidas.filter(partida => partida.time_a === nomeTime || partida.time_b === nomeTime)
                    .slice(0, 19)
                    .map(partida => `
                        <div class="match-row">
                            <div class="match-date">${formatarDataHora(partida.data, partida.hora, partida.minuto)}</div>
                            <div class="match-teams">
                                <span>${partida.time_a}</span>
                                <span class="score">${partida.ft}</span>
                                <span>${partida.time_b}</span>
                            </div>
                            <div class="result-indicator ${obterIndicadorResultado(partida.ft, partida.time_a, partida.time_b, nomeTime)}"></div>
                        </div>
                    `).join('')}
            </div>
        </div>
    `;
}


function sugerirMercado(estatisticas) {
    if (estatisticas.golsPro > estatisticas.golsContra) {
        if (estatisticas.vitorias > 3) {
            return 'Mais de 2.5 Gols';
        } else {
            return 'Ambas Equipes Marcam';
        }
    } else {
        return 'Menos de 2.5 Gols';
    }
}


function criarSecaoConfrontos(partidas, timeA, timeB) {
    const confrontos = partidas.filter(partida => 
        (partida.time_a === timeA && partida.time_b === timeB) ||
        (partida.time_a === timeB && partida.time_b === timeA)
    );

    let estatisticas = {
        totalJogos: confrontos.length,
        vitoriasPrimeiro: 0,
        vitoriasSegundo: 0,
        empates: 0,
        golsPrimeiro: 0,
        golsSegundo: 0,
        ambasSim: 0,
        ambasNao: 0,
        over15: 0,
        under15: 0,
        over25: 0,
        under25: 0,
        over35: 0,
        under35: 0,
        vitoriaCasa: 0,
        vitoriaFora: 0
    };

    confrontos.forEach(partida => {
        const [golsA, golsB] = partida.ft.split(' x ').map(Number);

        if (partida.time_a === timeA) {
            estatisticas.golsPrimeiro += golsA;
            estatisticas.golsSegundo += golsB;
        } else {
            estatisticas.golsPrimeiro += golsB;
            estatisticas.golsSegundo += golsA;
        }

        if (golsA > golsB) {
            estatisticas.vitoriaCasa++;
            if (partida.time_a === timeA) estatisticas.vitoriasPrimeiro++;
            else estatisticas.vitoriasSegundo++;
        } else if (golsA < golsB) {
            estatisticas.vitoriaFora++;
            if (partida.time_a === timeA) estatisticas.vitoriasSegundo++;
            else estatisticas.vitoriasPrimeiro++;
        } else {
            estatisticas.empates++;
        }

        if (golsA > 0 && golsB > 0) estatisticas.ambasSim++;
        else estatisticas.ambasNao++;

        const totalGols = golsA + golsB;
        if (totalGols > 1.5) estatisticas.over15++;
        else estatisticas.under15++;
        if (totalGols > 2.5) estatisticas.over25++;
        else estatisticas.under25++;
        if (totalGols > 3.5) estatisticas.over35++;
        else estatisticas.under35++;
    });

    const mediaGols = (estatisticas.golsPrimeiro + estatisticas.golsSegundo) / estatisticas.totalJogos || 0;
    const mercadosSugeridos = sugerirMercados(estatisticas);

    return `
        <div class="section">
            <div class="section-header">Confrontos Diretos</div>
            <div class="stats-container">
                <div class="stats-row">
                    <span class="stats-label">Total de jogos:</span>
                    <span class="stats-value">${estatisticas.totalJogos}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Vitórias ${timeA}:</span>
                    <span class="stats-value">${estatisticas.vitoriasPrimeiro}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Empates:</span>
                    <span class="stats-value">${estatisticas.empates}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Vitórias ${timeB}:</span>
                    <span class="stats-value">${estatisticas.vitoriasSegundo}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Média de gols:</span>
                    <span class="stats-value">${mediaGols.toFixed(2)}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Vitórias Casa:</span>
                    <span class="stats-value">${estatisticas.vitoriaCasa}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Vitórias Fora:</span>
                    <span class="stats-value">${estatisticas.vitoriaFora}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Ambas(Sim):</span>
                    <span class="stats-value">${estatisticas.ambasSim}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Ambas(Não):</span>
                    <span class="stats-value">${estatisticas.ambasNao}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Mais de 1.5:</span>
                    <span class="stats-value">${estatisticas.over15}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Menos de 1.5:</span>
                    <span class="stats-value">${estatisticas.under15}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Mais de 2.5:</span>
                    <span class="stats-value">${estatisticas.over25}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Menos de 2.5:</span>
                    <span class="stats-value">${estatisticas.under25}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Mais de 3.5:</span>
                    <span class="stats-value">${estatisticas.over35}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Menos de 3.5:</span>
                    <span class="stats-value">${estatisticas.under35}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">Sugestões:</span>
                    <span class="stats-value" style="color: #FFFF00;">${mercadosSugeridos.join(', ')}</span>
                </div>
            </div>
            ${confrontos.slice(0, 11).map(partida => `
                <div class="match-row">
                    <div class="match-date<div class="match-date">${formatarDataHora(partida.data, partida.hora, partida.minuto)}</div>
                    <div class="match-teams">
                        <span>${partida.time_a}</span>
                        <span class="score">${partida.ft}</span>
                        <span>${partida.time_b}</span>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}



function sugerirMercados(estatisticas) {
    const mercados = [];

    if (estatisticas.ambasSim > estatisticas.ambasNao) {
        mercados.push('Ambas(Sim)');
    } else {
        mercados.push('Ambas(Não)');
    }

    if (estatisticas.over25 > estatisticas.under25) {
        mercados.push('Over 2.5');
    } else {
        mercados.push('Under 2.5');
    }

    if (estatisticas.vitoriaCasa > estatisticas.vitoriaFora) {
        mercados.push('Casa Vence');
    } else if (estatisticas.vitoriaFora > estatisticas.vitoriaCasa) {
        mercados.push('Fora Vence');
    } else {
        mercados.push('Empate');
    }

    return mercados;
}


function obterIndicadorResultado(placar, timeA, timeB, timeAlvo) {
    const [golsA, golsB] = placar.split(' x ').map(Number);
    if (timeAlvo === timeA) {
        if (golsA > golsB) return 'vitoria';
        if (golsA < golsB) return 'derrota';
    } else {
        if (golsB > golsA) return 'vitoria';
        if (golsB < golsA) return 'derrota';
    }
    return 'empate';
}


function criarSecaoProximoJogo(proximoJogo) {
    return `
        <div class="section upcoming-match">
            <div class="section-header" style="background-color: #fe3c00; color: white; padding: 10px; font-size: 18px; font-weight: bold; text-align: center;">Próximo Jogo</div>
            <div class="stats-container">
                <div class="stats-row" style="border-bottom: 2px solid #fe3c00; padding: 10px 0;">
                    <span class="stats-label">Data/Hora/Minuto:</span>
                    <span class="stats-value">${proximoJogo.dataJogo.toLocaleDateString()} ${proximoJogo.horaJogo}</span>
                </div>
                <div class="stats-row" style="border-bottom: 2px solid #fe3c00; padding: 10px 0;">
                    <span class="stats-label">Times:</span>
                    <span class="stats-value" style="color: #FFD700;">${proximoJogo.timeA} 🆚 ${proximoJogo.timeB}</span>

                </div>

                <div class="stats-row" style="background-color: #fe3c00; color: white; padding: 5px 0; font-weight: bold; text-align: center; width: 100%; display: block; margin: 0 auto;">
                    Próximas Odds:
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">Casa:</span>
                    <span class="stats-value">${proximoJogo.odds.vitoriaCasa}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">Empate:</span>
                    <span class="stats-value">${proximoJogo.odds.empate}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">Fora:</span>
                    <span class="stats-value">${proximoJogo.odds.vitoriaFora}</span>
                </div>

                <div class="stats-row" style="background-color: #fe3c00; color: white; padding: 5px 0; font-weight: bold; text-align: center; width: 100%; display: block; margin: 0 auto;">
                    Ambas Marcam:
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">Sim:</span>
                    <span class="stats-value">${proximoJogo.odds.ambasMarcamSim}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">Não:</span>
                    <span class="stats-value">${proximoJogo.odds.ambasMarcamNao}</span>
                </div>

                <div class="stats-row" style="background-color: #fe3c00; color: white; padding: 5px 0; font-weight: bold; text-align: center; width: 100%; display: block; margin: 0 auto;">
                    Mais/Menos Gols:
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">⚽️Mais de 1.5:</span>
                    <span class="stats-value">${proximoJogo.odds.over15}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">⚽️Menos de 1.5:</span>
                    <span class="stats-value">${proximoJogo.odds.under15}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">⚽️Mais de 2.5:</span>
                    <span class="stats-value">${proximoJogo.odds.over25}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">⚽️Menos de 2.5:</span>
                    <span class="stats-value">${proximoJogo.odds.under25}</span>
                </div>
                <div class="stats-row" style="border-bottom: 1px solid #ccc; padding: 10px 0;">
                    <span class="stats-label">⚽️Mais de 3.5:</span>
                    <span class="stats-value">${proximoJogo.odds.over35}</span>
                </div>
                <div class="stats-row" style="padding: 10px 0;">
                    <span class="stats-label">⚽️Menos de 3.5:</span>
                    <span class="stats-value">${proximoJogo.odds.under35}</span>
                </div>
            </div>
        </div>
    `;
}


async function buscarEAtualizarResultados() {
    try {

        const proximoJogo = await buscarProximoJogo();
        if (!proximoJogo) {
            console.log('Nenhum próximo jogo encontrado');
            return;
        }


        const resposta = await fetch(URL_API_RESULTADOS);
        if (!resposta.ok) {
            throw new Error(`Erro HTTP! status: ${resposta.status}`);
        }
        const novosResultados = await resposta.json();
        

        const proximoJogoMudou = JSON.stringify(proximoJogo) !== JSON.stringify(ultimoProximoJogo);
        const resultadosMudaram = JSON.stringify(novosResultados) !== JSON.stringify(ultimosResultados);
        
        if (proximoJogoMudou || resultadosMudaram) {
            //console.log('Atualizando dados...', new Date().toLocaleTimeString());
            

            ultimosResultados = novosResultados;
            ultimoProximoJogo = proximoJogo;
            
            const container = document.getElementById('mainContainer');
            if (!container) {
                console.error('Container não encontrado');
                return;
            }
            

            container.innerHTML = `
                ${criarSecaoProximoJogo(proximoJogo)}
                ${criarSecaoTime(`${proximoJogo.timeA} Geral`, novosResultados, proximoJogo.timeA)}
                ${criarSecaoConfrontos(novosResultados, proximoJogo.timeA, proximoJogo.timeB)}
                ${criarSecaoTime(`${proximoJogo.timeB} Geral`, novosResultados, proximoJogo.timeB)}
            `;
        } else {
            //console.log('Nenhuma mudança detectada:', new Date().toLocaleTimeString());
        }
    } catch (erro) {
        console.error('Erro ao atualizar dados:', erro);
    }
}


function iniciarAtualizacaoAutomatica() {
    // Limpa qualquer intervalo existente
    if (intervaloAtualizacao) {
        clearInterval(intervaloAtualizacao);
    }
    

    buscarEAtualizarResultados();
    

    intervaloAtualizacao = setInterval(() => {
        buscarEAtualizarResultados();
    }, 3000);
    

    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            clearInterval(intervaloAtualizacao);
        } else {
            iniciarAtualizacaoAutomatica();
        }
    });
}


document.addEventListener('DOMContentLoaded', iniciarAtualizacaoAutomatica);

</script>


<script>
    
    async function initializeChart() {
        const ctx = document.getElementById('golsplus').getContext('2d');
        let fetchedData = [];
        let displayData = [];
        let initialPercentageGols = 50;
        

        function isOrdered(data) {
            for (let i = 1; i < data.length; i++) {
                const currentDate = new Date(data[i].data);
                const previousDate = new Date(data[i - 1].data);
                if (currentDate < previousDate) return false;
                if (currentDate.getTime() === previousDate.getTime()) {
                    if (data[i].hora < data[i - 1].hora ||
                        (data[i].hora === data[i - 1].hora && data[i].minuto < data[i - 1].minuto)) return false;
                }
            }
            return true;
        }
    

        async function fetchChartData() {
            try {
                const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status}`);
                }
                const data = await response.json();
                const sortedData = data.sort((a, b) => {
                    const dateA = new Date(a.data);
                    const dateB = new Date(b.data);
                    if (dateA < dateB) return -1;
                    if (dateA > dateB) return 1;
                    if (a.hora < b.hora) return -1;
                    if (a.hora > b.hora) return 1;
                    return a.minuto - b.minuto;
                });
    
                if (!isOrdered(sortedData)) {
                    console.warn('Os dados não estão em ordem.');
                    return [];
                }
    
                return sortedData;
            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                return [];
            }
        }
    

        function getPreviousMatch(current) {
            let previousHour = current.hora === 0 ? 23 : current.hora - 1;
            const currentDate = current.data.split("T")[0];  
    

            if (current.hora === 0) {
                const dateObj = new Date(current.data);
                dateObj.setDate(dateObj.getDate() - 1);
                return fetchedData.find(item => 
                    item.data.split("T")[0] === dateObj.toISOString().split("T")[0] && 
                    item.hora === previousHour && 
                    item.minuto === current.minuto
                );
            }
    
            return fetchedData.find(item => 
                item.data.split("T")[0] === currentDate && 
                item.hora === previousHour && 
                item.minuto === current.minuto
            );
        }
    

        async function updateChart() {
            fetchedData = await fetchChartData();
            if (fetchedData.length === 0) {
                console.warn('Nenhum dado para atualizar o gráfico.');
                return;
            }
    
            displayData = fetchedData.slice(-160);
            const labels = displayData.map(item => `${item.hora}:${item.minuto.toString().padStart(2, '0')}`);
            const golsData = [];
            let previousGols = initialPercentageGols;
    
            for (let i = 0; i < displayData.length; i++) {
                const current = displayData[i];
                const previous = getPreviousMatch(current);
    
                if (previous) {
                    const [golsAAtual, golsBAtual] = current.ft.split(' x ').map(Number);
                    const [golsAAnterior, golsBAnterior] = previous.ft.split(' x ').map(Number);
    
                    if (golsAAnterior !== undefined && golsBAnterior !== undefined) {
                        const totalGolsAtual = golsAAtual + golsBAtual;
                        const totalGolsAnterior = golsAAnterior + golsBAnterior;
    

                        const diferencaGols = totalGolsAtual - totalGolsAnterior;
    

                        if (diferencaGols > 0) {

                            previousGols += diferencaGols;
                        } else if (diferencaGols < 0) {

                            previousGols += diferencaGols;
                        } else {

                        }
                    }
                }
                golsData.push(previousGols);
            }
    
            golsplus.data.labels = labels;
            golsplus.data.datasets[0].data = golsData;
            golsplus.update();
        }
    
        const chartData = {
            labels: [],
            datasets: [
                {
                    label: 'Gols',
                    data: [],
                    borderColor: 'rgba(0, 255, 0, 1)', 
                    backgroundColor: 'rgba(0, 255, 0, 0.5)', 
                    borderWidth: 2,
                    pointRadius: 3,
                    pointBackgroundColor: 'rgba(0, 255, 0, 1)'                  
                }
            ]
        };
    
        const golsplus = new Chart(ctx, {
            type: 'line',
            data: chartData,
            options: {
                scales: {
                    y: {
                        position: 'right',
                        ticks: {
                            color: 'white',
                            stepSize: 5 
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.5)', 
                            drawBorder: false,
                            lineWidth: 1 
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(0, 0, 0, 0)' 
                        },
                        ticks: {
                            color: 'white',
                            display: false 
                        }
                    }
                },
                responsive: true,
                plugins: {
                    legend: { display: true },
                    tooltip: {
                        enabled: true,
                        callbacks: {
                            title: (context) => `Hora: ${context[0].label}`,
                            label: (context) => {
                                const index = context.dataIndex;
                                const currentGame = displayData[index] || { ft: 'N/A', hora: 'N/A', minuto: 'N/A' };
                                const previousGame = getPreviousMatch(currentGame) || { ft: 'N/A', hora: 'N/A', minuto: 'N/A' };
                                
                                return [
                                    `Placar: ${currentGame.ft}`,
                                ];
                            }
                        }
                    }
                }
            }
        });
    
        setInterval(updateChart, 5000);
        updateChart();
    }
    

    initializeChart();
    
</script>

<script>
    let previousDataHash = '';

    async function fetchData() {
        try {
            const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
            const data = await response.json();


            const dataHash = JSON.stringify(data.slice(-480));
            if (dataHash === previousDataHash) return; 
            previousDataHash = dataHash;

            const recentData = data.slice(-480);

            const placaresFixos = [
                "2 x 0", "2 x 1", "0 x 0", "0 x 2", "1 x 2", "0 x 1", 
                "1 x 0", "1 x 1",  "2 x 2", "3 x 1", "4 x 0", 
                "0 x 3", "3 x 0", "4 x 1", "2 x 3", "2 x 4", "1 x 3", 
                "3 x 2", "4 x 2", "0 x 4", 
            ];

            const headerRow = document.getElementById('maximaplacar-header');
            if (headerRow.children.length === 0) {
                placaresFixos.forEach(placar => {
                    const th = document.createElement('th');
                    th.textContent = placar;
                    th.classList.add('maximaplacar-th');
                    headerRow.appendChild(th);
                });
            }

            let placares = {};
            placaresFixos.forEach(placar => {
                placares[placar] = { max: 0, atual: 0, lastIndex: -1 };
            });

            recentData.forEach((jogo, i) => {
                const placar = jogo.ft;
                if (placares[placar]) {
                    if (placares[placar].lastIndex !== -1) {
                        const jogosSemPlacar = i - placares[placar].lastIndex - 1;
                        placares[placar].max = Math.max(placares[placar].max, jogosSemPlacar);
                    }
                    placares[placar].lastIndex = i;
                    placares[placar].atual = 0;
                }
                for (let p in placares) {
                    if (placar !== p) placares[p].atual++;
                }
            });

            const tableBody = document.getElementById('maximaplacar-resultados');
            let row = tableBody.querySelector('tr');
            if (!row) {
                row = document.createElement('tr');
                tableBody.appendChild(row);
            } else {
                row.innerHTML = "";
            }

            placaresFixos.forEach(placar => {
                const result = placares[placar];
                const td = document.createElement('td');
                td.innerHTML = `${result.max} / ${result.atual}`;
                td.classList.add('maximaplacar-td');
                row.appendChild(td);
            });

        } catch (error) {
            console.error("Erro ao buscar os dados:", error);
        }
    }


    setInterval(fetchData, 5000);
    fetchData(); 
</script>

<script>
    async function fetchData() {
        try {
            const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
            const data = await response.json();
            const recentData = data.slice(-480);


        const mercadosFixos = [
            "Ambas Sim", "Ambas Não", "Casa Vence", "Fora Vence", "Empate",
            "Over 1.5", "Under 1.5", "Over 2.5", "Under 2.5", "Over 3.5", "Under 3.5",
            "5 ou Mais Gols"
        ];

        const headerRow = document.getElementById('maximamercado-header');
        if (headerRow.children.length === 0) {
            mercadosFixos.forEach(mercado => {
                const th = document.createElement('th');
                th.textContent = mercado;
                th.classList.add('maximamercado-th');
                headerRow.appendChild(th);
            });
        }

        let mercados = {};
        mercadosFixos.forEach(mercado => {
            mercados[mercado] = { max: 0, atual: 0, lastIndex: -1 };
        });

        for (let i = 0; i < recentData.length; i++) {
            const jogo = recentData[i];
            const [golCasa, golFora] = jogo.ft.split(' x ').map(Number);

            const condicoes = {
                "Ambas Sim": golCasa > 0 && golFora > 0,
                "Ambas Não": golCasa === 0 || golFora === 0,
                "Casa Vence": golCasa > golFora,
                "Fora Vence": golFora > golCasa,
                "Empate": golCasa === golFora,
                "Over 1.5": (golCasa + golFora) > 1.5,
                "Under 1.5": (golCasa + golFora) <= 1.5,
                "Over 2.5": (golCasa + golFora) > 2.5,
                "Under 2.5": (golCasa + golFora) <= 2.5,
                "Over 3.5": (golCasa + golFora) > 3.5,
                "Under 3.5": (golCasa + golFora) <= 3.5,
                "5 ou Mais Gols": (golCasa + golFora) >= 5
            };

            for (let mercado in condicoes) {
                if (condicoes[mercado]) {
                    if (mercados[mercado].lastIndex !== -1) {
                        const jogosSemMercado = i - mercados[mercado].lastIndex - 1;
                        mercados[mercado].max = Math.max(mercados[mercado].max, jogosSemMercado);
                    }
                    mercados[mercado].lastIndex = i;
                    mercados[mercado].atual = 0;
                } else {
                    mercados[mercado].atual++;
                }
            }
        }

        const tableBody = document.getElementById('maximamercado-resultados');
        let row = tableBody.querySelector('tr');

        if (!row) {
            row = document.createElement('tr');
            tableBody.appendChild(row);
        } else {
            row.innerHTML = "";
        }


        mercadosFixos.forEach(mercado => {
            const result = mercados[mercado];
            const td = document.createElement('td');
            td.innerHTML = `${result.max} / ${result.atual}`;
            td.classList.add('maximamercado-td');
            row.appendChild(td);
        });

        setTimeout(fetchData, 10000);

    } catch (error) {
        console.error("Erro ao buscar os dados:", error);
    }
}


    setInterval(fetchData, 5000);
    fetchData(); 

</script>

<script>

    
            const apiUrl = "https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna";
        
          
          let data = [];
      

          async function fetchData() {
            try {
              const response = await fetch(apiUrl);
              const allData = await response.json();
      

              data = allData.sort((a, b) => new Date(b.data) - new Date(a.data)).slice(0, 480);
      

            } catch (error) {
              console.error("Erro ao buscar os dados:", error);
            }
          }
      

          function formatarPlacar(placar) {
            return placar.replace(/x/, " x ");
          }
      
          function buscadorAnalisar() {
            const placarInput = document.getElementById("buscador-placar").value;
            const mercado = document.getElementById("buscador-mercado").value;
            const pular = parseInt(document.getElementById("buscador-pular").value, 10);
            const analisarQtd = parseInt(document.getElementById("buscador-analisar").value, 10);
      
            if (!placarInput || isNaN(pular) || isNaN(analisarQtd)) {
              alert("Preencha todos os campos corretamente!");
              return;
            }
      
            const placar = formatarPlacar(placarInput);
      

            const jogosFiltrados = data.filter(jogo => jogo.ft === placar);
            let localizados = 0;
            let greens = 0;
            let reds = 0;
      
            jogosFiltrados.forEach((jogo, index) => {
              if (index + pular + analisarQtd <= data.length) {
                localizados++;
      

                const jogosParaAnalisar = data.slice(index + pular, index + pular + analisarQtd);
      

                const houveGreen = jogosParaAnalisar.some(jogo => {
                  const [golsA, golsB] = jogo.ft.split(" x ").map(Number);
      
                  switch (mercado) {
                    case "ambasMarcam":
                      return golsA > 0 && golsB > 0;
                    case "ambasNaoMarcam":
                      return golsA === 0 || golsB === 0;
                    case "casaVence":
                      return golsA > golsB;
                    case "foraVence":
                      return golsB > golsA;
                    case "empate":
                      return golsA === golsB;
                    case "over1.5":
                      return golsA + golsB > 1.5;
                    case "under1.5":
                      return golsA + golsB <= 1.5;
                    case "over2.5":
                      return golsA + golsB > 2.5;
                    case "under2.5":
                      return golsA + golsB <= 2.5;
                    case "over3.5":
                      return golsA + golsB > 3.5;
                    case "under3.5":
                      return golsA + golsB <= 3.5;
                    case "over5":
                      return golsA + golsB > 5;
                    default:
                      return false;
                  }
                });
      
                if (houveGreen) {
                  greens++;
                } else {
                  reds++;
                }
              }
            });
      

            const greenPercent = localizados ? ((greens / localizados) * 100).toFixed(2) : 0;
            const redPercent = localizados ? ((reds / localizados) * 100).toFixed(2) : 0;
      

            document.getElementById("buscador-localizados").innerText = `LOCALIZADOS: ${localizados}`;
            document.getElementById("buscador-greens").innerText = `Greens: ${greens} (${greenPercent}%)`;
            document.getElementById("buscador-reds").innerText = `Reds: ${reds} (${redPercent}%)`;
          }
      
          function buscadorLimpar() {
            document.getElementById("buscador-placar").value = "";
            document.getElementById("buscador-pular").value = "";
            document.getElementById("buscador-analisar").value = "";
            document.getElementById("buscador-localizados").innerText = "LOCALIZADOS: 0";
            document.getElementById("buscador-greens").innerText = "Greens: 0 (0%)";
            document.getElementById("buscador-reds").innerText = "Reds: 0 (0%)";
          }
      

          fetchData();    
</script>
<script>
    const minutes = [1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 52, 55, 58];
    const markets = {
        "minutofixo-ambasMarcam": "Ambas Sim",
        "minutofixo-ambasNaoMarcam": "Ambas Não",
        "minutofixo-casaVence": "Casa Vence",
        "minutofixo-foraVence": "Fora Vence",
        "minutofixo-empate": "Empate",
        "minutofixo-over1.5": "Over 1.5",
        "minutofixo-under1.5": "Under 1.5",
        "minutofixo-over2.5": "Over 2.5",
        "minutofixo-under2.5": "Under 2.5",
        "minutofixo-over3.5": "Over 3.5",
        "minutofixo-under3.5": "Under 3.5",
    };
    
    let selectedMinutes = [];
    let marketCounts = {};
    let minuteOccurrences = {};
    let goalSums = {}; 
    
    async function fetchMarketData() {
        try {
            const response = await fetch('https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna');
            const data = await response.json();
            const recentGames = data.slice(-960);
            processAndRenderTable(recentGames);
        } catch (error) {

        }
    }
    
    function processAndRenderTable(data) {
        const totalGames = data.length;
    

        minutes.forEach(minute => {
            minuteOccurrences[minute] = 0;
            goalSums[minute] = 0;
            for (const market in markets) {
                if (!marketCounts[market]) marketCounts[market] = {};
                marketCounts[market][minute] = 0;
            }
        });
    

        data.forEach(game => {
            const gameMinute = game.minuto;
    
            if (minutes.includes(gameMinute)) {
                const ft = game.ft.split('x').map(Number);
                const totalGoals = ft[0] + ft[1];
    
                minuteOccurrences[gameMinute]++;
                goalSums[gameMinute] += totalGoals; 
    
                if (ft[0] > 0 && ft[1] > 0) marketCounts["minutofixo-ambasMarcam"][gameMinute]++;
                if (ft[0] === 0 || ft[1] === 0) marketCounts["minutofixo-ambasNaoMarcam"][gameMinute]++;
                if (ft[0] > ft[1]) marketCounts["minutofixo-casaVence"][gameMinute]++;
                if (ft[1] > ft[0]) marketCounts["minutofixo-foraVence"][gameMinute]++;
                if (ft[0] === ft[1]) marketCounts["minutofixo-empate"][gameMinute]++;
                if (totalGoals > 1.5) marketCounts["minutofixo-over1.5"][gameMinute]++;
                if (totalGoals <= 1.5) marketCounts["minutofixo-under1.5"][gameMinute]++;
                if (totalGoals > 2.5) marketCounts["minutofixo-over2.5"][gameMinute]++;
                if (totalGoals <= 2.5) marketCounts["minutofixo-under2.5"][gameMinute]++;
                if (totalGoals > 3.5) marketCounts["minutofixo-over3.5"][gameMinute]++;
                if (totalGoals <= 3.5) marketCounts["minutofixo-under3.5"][gameMinute]++;
            }
        });
    
        renderTable(marketCounts, minuteOccurrences, goalSums);
        renderMarketPercentages(marketCounts, minuteOccurrences);
    }
    
    function processAndRenderTable(data) {
        const totalGames = data.length;
    

        minutes.forEach(minute => {
            minuteOccurrences[minute] = 0;  
            goalSums[minute] = 0;  
            for (const market in markets) {
                if (!marketCounts[market]) marketCounts[market] = {};
                marketCounts[market][minute] = 0;
            }
        });
    

        data.forEach(game => {
            const gameMinute = game.minuto;
    
            if (minutes.includes(gameMinute)) {
                const ft = game.ft.split('x').map(Number); 
                const totalGoals = ft[0] + ft[1]; 
    
                minuteOccurrences[gameMinute]++; 
                goalSums[gameMinute] += totalGoals; 
    

                if (ft[0] > 0 && ft[1] > 0) marketCounts["minutofixo-ambasMarcam"][gameMinute]++;
                if (ft[0] === 0 || ft[1] === 0) marketCounts["minutofixo-ambasNaoMarcam"][gameMinute]++;
                if (ft[0] > ft[1]) marketCounts["minutofixo-casaVence"][gameMinute]++;
                if (ft[1] > ft[0]) marketCounts["minutofixo-foraVence"][gameMinute]++;
                if (ft[0] === ft[1]) marketCounts["minutofixo-empate"][gameMinute]++;
                if (totalGoals > 1.5) marketCounts["minutofixo-over1.5"][gameMinute]++;
                if (totalGoals <= 1.5) marketCounts["minutofixo-under1.5"][gameMinute]++;
                if (totalGoals > 2.5) marketCounts["minutofixo-over2.5"][gameMinute]++;
                if (totalGoals <= 2.5) marketCounts["minutofixo-under2.5"][gameMinute]++;
                if (totalGoals > 3.5) marketCounts["minutofixo-over3.5"][gameMinute]++;
                if (totalGoals <= 3.5) marketCounts["minutofixo-under3.5"][gameMinute]++;
            }
        });
    
        renderTable(marketCounts, minuteOccurrences, goalSums);
        renderMarketPercentages(marketCounts, minuteOccurrences);
    }
    
    function renderTable(marketCounts, minuteOccurrences, goalSums) {
        const percentagesReference = {
            "minutofixo-ambasMarcam": 50,
            "minutofixo-ambasNaoMarcam": 50,
            "minutofixo-casaVence": 41,
            "minutofixo-foraVence": 30,
            "minutofixo-empate": 29,
            "minutofixo-over1.5": 70,
            "minutofixo-under1.5": 30,
            "minutofixo-over2.5": 41,
            "minutofixo-under2.5": 58,
            "minutofixo-over3.5": 20,
            "minutofixo-under3.5": 80,
            "minutofixo-over5": 7
        };
    
        const tbody = document.getElementById('minutofixo-market-table');
        tbody.innerHTML = '';
    
        for (const market in markets) {
            const row = document.createElement('tr');
            const marketCell = document.createElement('td');
            marketCell.textContent = markets[market];
            row.appendChild(marketCell);
    
            minutes.forEach(minute => {
                const cell = document.createElement('td');
                const count = marketCounts[market][minute];
                const gamesInMinute = minuteOccurrences[minute];
    
                const percentage = gamesInMinute > 0 
                    ? Math.round((count / gamesInMinute) * 100)
                    : 0;
    
                cell.textContent = `${percentage}%`;
    

                const reference = percentagesReference[market];
                if (percentage < reference) {
                    cell.style.backgroundColor = '#9d0c02'; 
                    cell.style.color = '#FFF';
                    cell.style.fontSize = '12px'; 
                } else {
                    cell.style.backgroundColor = '#ffc901'; 
                    cell.style.color = '#000';
                    cell.style.fontSize = '12px'; 
                }
    
                row.appendChild(cell);
            });
    
            tbody.appendChild(row);
        }
    
        document.getElementById("total-games").textContent = `Total de jogos processados: ${Object.values(minuteOccurrences).reduce((a, b) => a + b, 0)}`;
    }
    
    
    
    function renderMarketPercentages(marketCounts, minuteOccurrences) {
        const marketPercentages = {};
    
        for (const market in markets) {
            let totalCount = 0;
            let totalGames = 0;
    
            selectedMinutes.forEach(minute => {
                const count = marketCounts[market][minute];
                totalCount += count;
                totalGames += minuteOccurrences[minute];
            });
    
            const percentage = totalGames > 0 ? Math.round((totalCount / totalGames) * 100) : 0;
            marketPercentages[market] = percentage;
        }
    
        const percentagesDiv = document.getElementById('market-percentages');
        percentagesDiv.innerHTML = '';
    
        for (const market in marketPercentages) {
            const marketPercentage = marketPercentages[market];
            const marketLabel = markets[market];
            const percentageDiv = document.createElement('div');
            percentageDiv.textContent = `${marketLabel}: ${marketPercentage}%`;
            percentageDiv.style.display = 'inline-block';
            percentageDiv.style.marginRight = '20px';
            percentagesDiv.appendChild(percentageDiv);
        }
    }
    
    function toggleMinuteSelection(minute) {
        const index = selectedMinutes.indexOf(minute);
    
        if (index === -1) {
            selectedMinutes.push(minute);
            document.querySelector(`th[data-minute="${minute}"]`).classList.add('selected');
        } else {
            selectedMinutes.splice(index, 1);
            document.querySelector(`th[data-minute="${minute}"]`).classList.remove('selected');
        }
    
        renderMarketPercentages(marketCounts, minuteOccurrences);
    }
    
    document.querySelectorAll('.minute-header').forEach((cell, index) => {
        const minute = minutes[index];
        cell.setAttribute('data-minute', minute);
    
        cell.addEventListener('click', () => {
            toggleMinuteSelection(minute);
        });
    });
    
    document.getElementById('clear-selection-btn')?.addEventListener('click', () => {
        selectedMinutes = [];
        document.querySelectorAll('.minute-header').forEach(cell => {
            cell.classList.remove('selected');
        });
        renderMarketPercentages(marketCounts, minuteOccurrences);
    });
    
    setInterval(fetchMarketData, 5000);
    
    fetchMarketData();
</script>

<script>
    function redirecionar(select) {
        const url = select.value;

        if (url === "https://t.me/betstatsite" || url === "https://api.whatsapp.com/send?phone=5575991103046") {
            window.open(url, '_blank'); 
        } else if (url) {
            window.location.href = url; 
        }
    }
</script>

<script>
const API_URL = 'https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna';
const PROXIMOS_JOGOS_URL = 'https://betstat.site/proximos/taca-gloria-eterna';

async function carregarJogos() {
  try {
    const response = await fetch(API_URL);
    const jogos = await response.json();
    return jogos;
  } catch (error) {
    console.error('Erro ao carregar dados:', error);
    return [];
  }
}

async function carregarProximosJogos() {
  try {
    const response = await fetch(PROXIMOS_JOGOS_URL);
    const proximosJogos = await response.json();
    return proximosJogos;
  } catch (error) {
    console.error('Erro ao carregar dados dos próximos jogos:', error);
    return [];
  }
}

function analisarMercados(jogos, timeA, timeB) {
  const analise = {};

  jogos.forEach(jogo => {
 
    if (jogo.time_a === timeA || jogo.time_b === timeA) {
      const minuto = jogo.minuto;
      const ftGols = jogo.ft.split(' x ').map(Number);
      const timeA_gols = ftGols[0];
      const timeB_gols = ftGols[1];
      const totalGols = timeA_gols + timeB_gols;

      if (!analise[minuto]) {
        analise[minuto] = {
          ambasMarcamSim: 0,
          ambasMarcamNao: 0,
          over15: 0,
          under15: 0,
          over25: 0,
          under25: 0,
          over35: 0,
          under35: 0,
          casa: 0,
          fora: 0,
          empate: 0,
          total: 0,
          timeA: 0, 
          timeB: 0  
        };
      }

      analise[minuto].total += 1;

      if (timeA_gols > 0 && timeB_gols > 0) analise[minuto].ambasMarcamSim += 1;
      if (timeA_gols === 0 || timeB_gols === 0) analise[minuto].ambasMarcamNao += 1;

      if (totalGols > 1.5) analise[minuto].over15 += 1;
      if (totalGols <= 1.5) analise[minuto].under15 += 1;

      if (totalGols > 2.5) analise[minuto].over25 += 1;
      if (totalGols <= 2.5) analise[minuto].under25 += 1;

      if (totalGols > 3.5) analise[minuto].over35 += 1;
      if (totalGols <= 3.5) analise[minuto].under35 += 1;

      if (timeA_gols > timeB_gols) analise[minuto].casa += 1;
      if (timeB_gols > timeA_gols) analise[minuto].fora += 1;
      if (timeA_gols === timeB_gols) analise[minuto].empate += 1;


      if (jogo.time_a === timeA || jogo.time_b === timeA) analise[minuto].timeA += 1;
      if (jogo.time_a === timeB || jogo.time_b === timeB) analise[minuto].timeB += 1;
    }
  });

  return analise;
}

function gerarTabela(analise) {
  const table = document.getElementById("time-tabela-resultados");
  const tbody = table.querySelector("tbody");
  const thead = table.querySelector("thead tr");

  tbody.innerHTML = '';
  thead.innerHTML = '<th>Mercado | Minuto</th>';

  const minutos = Object.keys(analise);
  minutos.forEach(minuto => {
    const th = document.createElement("th");
    th.innerText = minuto;
    thead.appendChild(th);
  });

  const mercados = [
    { 
        class: 'mercado-ambas-marcam',
        label: 'Ambas',
        yes: 'ambasMarcamSim',
        no: 'ambasMarcamNao'
    },
    { 
        class: 'mercado-over15',
        label: '1.5',
        over: 'over15',
        under: 'under15'
    },
    { 
        class: 'mercado-over25',
        label: '2.5',
        over: 'over25',
        under: 'under25'
    },
    { 
        class: 'mercado-over35',
        label: '3.5',
        over: 'over35',
        under: 'under35'
    },
    { 
        class: 'mercado-resultado',
        label: 'C/F/E',
        casa: 'casa',
        fora: 'fora',
        empate: 'empate'
    }
  ];

  mercados.forEach(mercado => {
    const tr = document.createElement("tr");
    tr.classList.add(mercado.class);
    
    const td = document.createElement("td");
    td.classList.add('mercado-header');
    td.innerText = mercado.label;
    tr.appendChild(td);

    minutos.forEach(minuto => {
      const td = document.createElement("td");
      const dados = analise[minuto];
      let texto = '';


      if (mercado.yes && mercado.no) {
        const simPercent = (dados[mercado.yes] / dados.total) * 100;
        const naoPercent = (dados[mercado.no] / dados.total) * 100;
        texto = `S:${simPercent.toFixed(0)}%\nN:${naoPercent.toFixed(0)}%`;
      }

      if (mercado.over && mercado.under) {
        const overPercent = (dados[mercado.over] / dados.total) * 100;
        const underPercent = (dados[mercado.under] / dados.total) * 100;
        texto = `O:${overPercent.toFixed(0)}%\nU:${underPercent.toFixed(0)}%`;
      }

      if (mercado.casa && mercado.fora && mercado.empate) {
        const casaPercent = (dados[mercado.casa] / dados.total) * 100;
        const foraPercent = (dados[mercado.fora] / dados.total) * 100;
        const empatePercent = (dados[mercado.empate] / dados.total) * 100;
        texto = `C:${casaPercent.toFixed(0)}%\nF:${foraPercent.toFixed(0)}%\nE:${empatePercent.toFixed(0)}%`;
      }


            if (dados.timeB > 0) {
        td.style.backgroundColor = '#02a507'; 
        }

        if (dados.timeB > 0) {
        td.classList.add('piscando'); 
        }


            td.innerHTML = texto.replace(/\n/g, '<br>');
            tr.appendChild(td);
            });

            tbody.appendChild(tr);
        });
        }

async function analisar() {
  const proximosJogos = await carregarProximosJogos();
  if (proximosJogos.length > 0) {
    const timeA = proximosJogos[0].time_a;
    const timeB = proximosJogos[0].time_b;

    const jogos = await carregarJogos();
    const analise = analisarMercados(jogos, timeA, timeB);
    gerarTabela(analise);
  }
}


setInterval(atualizarAnálise, 5000);


async function atualizarAnálise() {
  await analisar();
}


atualizarAnálise();
</script>

<script>
    
    document.addEventListener("contextmenu", function(e) {
                e.preventDefault();
            });
    

            document.addEventListener("keydown", function(e) {

                if (e.key === "F12" || 
                    (e.ctrlKey && e.shiftKey && e.key === "I")) {
                    e.preventDefault();
                }
    

                if (e.ctrlKey && e.key === "u") {
                    e.preventDefault();
                }
    

                if (e.ctrlKey && e.shiftKey && e.key === "J") {
                    e.preventDefault();
                }
    

                if (e.ctrlKey && e.shiftKey && e.key === "C") {
                    e.preventDefault();
                }
            });
    

            const devtools = { open: false };
            const element = new Image();
            Object.defineProperty(element, 'id', {
                get: function () {
                    devtools.open = true;
                }
            });
    
            console.log('%c', element); 
            setInterval(function() {
                if (devtools.open) {
                    alert('Desculpe, as ferramentas de desenvolvedor estão abertas!');
                    devtools.open = false; 
                }
            }, 1000);
    
            function toggleVideo() {

                const videoDiv = document.getElementById("liveVideo");
                const overlayDiv = videoDiv.querySelector(".iframe-overlay"); 
                const button = document.querySelector(".toggle-button");
            

                const isVisible = window.getComputedStyle(videoDiv).display !== "none";
            

                if (isVisible) {
                    videoDiv.style.display = "none";  
                    overlayDiv.style.display = "none"; 
                    button.textContent = "Expandir Vídeo";  
                } else {
                    videoDiv.style.display = "block";  
                    overlayDiv.style.display = "block"; 
                    button.textContent = "Contrair Vídeo";  
                }
            }
</script>
</body>
</html>
