<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>    
        <title>BetStat - Gols FT</title>
        <meta name="description" content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes.">
        <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos">
        <meta property="og:title" content="BetStat | Plataforma de Análise para Apostas Esportivas">
        <meta property="og:description" content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano.">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.betstat.site/payment.html">
        <meta property="og:site_name" content="BetStat">
        <meta name="robots" content="index, follow">
        <meta name="author" content="BetStat">
        <meta name="canonical" href="https://www.betstat.site/payment.html">
        <script type="module" src="js/firebase-auth.js"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-4WT805FFHQ');
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
        
        <style>
            body {
                font-family: "Roboto", Arial, sans-serif;
                margin: 30px;
                background-color: #1c1f26;
                color: #ffffff;
            }

            .espaco {
                width: 50px;
                height: 50px;
            }

            option:hover {
                background-color: #ff8000;
                color: #ffffff;
            }

            canvas {
                cursor: pointer;
            }

            button {
                background-color: #1c1f26;
                color: rgb(255, 255, 255);
                font-family: "Roboto", Arial, sans-serif;
                border: none;
                padding: 5px 8px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 16px;
                transition: background-color 0.3s;
                margin: 10px;
            }

            button:hover {
                background-color: #0f1013;
            }

            option {
                background-color: #1c1f26;
                color: #ffffff;
            }

            select {
                width: 100%;
                padding: 5px;
                border-radius: 5px;
                background-color: #1c1f26;
                color: #ffffff;
                font-family: "Roboto", Arial, sans-serif;
                font-size: 14px;
                cursor: pointer;
                transition: border-color 0.3s;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            header {
                background: #005540;
                width: 100%;
                position: fixed;
                top: 0;
                left: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                height: 60px;
            }

            .header-container {
                display: flex;
                align-items: center;
                width: 100%;
                max-width: 1200px;
                padding: 0 20px;
                justify-content: space-between;
            }

            .logo {
                height: 40px;
            }

            .selectors-container {
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .nav-seletor {
                display: flex;
                align-items: center;
                color: #ffffff;
                font-weight: 500;
            }

            .nav-seletor select {
                padding: 0.5rem;
                border-radius: 6px;
                background-color: #1c1f26;
                color: var(--text-color);
                border: 1px solid #ffffff9f;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .logout-btn {
                background-color: #1c1f26;
                color: white;
                padding: 8px 10px;
                font-size: 14px;
                border-radius: 5px;
                cursor: pointer;
                border: 1px solid #ffffff81;
            }

            .logout-btn:hover {
                background-color: #720000;
            }

            h1, h2, label {
                color: #1fad8b;
            }

            h1 {
                font-size: 24px;
                margin-bottom: 20px;
                text-align: center;
            }

            .control-panel {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-bottom: 30px;
                flex-wrap: wrap;
            }

            select {
                padding: 8px 12px;
                background-color: #292d36;
                color: #e0e0e0;
                border: 1px solid #1fad8b;
                border-radius: 4px;
                font-size: 14px;
                cursor: pointer;
                transition: border-color 0.3s;
            }

            select:hover {
                border-color: #34d8ab;
            }

            select:focus {
                outline: none;
                border-color: #1fad8b;
            }

            .chart-container {
                background-color: #292d36;
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 40px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            }

            .chart-container h2 {
                font-size: 18px;
                margin-bottom: 10px;
                text-align: center;
            }

            canvas {
                border-radius: 4px;
            }

            .checkbox-container {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            input[type="checkbox"] {
                cursor: pointer;
            }

            .league-selector {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .league-buttons {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                justify-content: center;
                margin-bottom: 20px;
            }

            .league-btn {
                padding: 8px 12px;
                background-color: #292d36;
                color: #e0e0e0;
                border: 2px solid #1fad8b;
                border-radius: 5px;
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 14px;
            }

            .league-btn:hover {
                background-color: #1fad8b;
                color: #1c1f26;
            }

            .league-btn.active {
                background-color: #1fad8b;
                color: #1c1f26;
            }
        </style>
    </head>

    <body>
        <div id="header"></div>
        <br><br><br>

        <h1>Dashboard Gols FT - 6 Ligas</h1>

        <div class="control-panel">
            <div>
                <label for="pointsSelector">Horas</label>
                <select id="pointsSelector">
                    <option value="20">1 Hora</option>
                    <option value="40">2 Horas</option>
                    <option value="60">3 Horas</option>
                    <option value="80">4 Horas</option>
                    <option value="100">5 Horas</option>
                    <option value="120">6 Horas</option>
                    <option value="140">7 Horas</option>
                    <option value="160">8 Horas</option>
                    <option value="180">9 Horas</option>
                    <option value="200">10 Horas</option>
                    <option value="220">11 Horas</option>
                    <option value="240">12 Horas</option>
                    <option value="480">24 Horas</option>
                    <option value="960">48 Horas</option>
                </select>
            </div>
            
            <div>
                <label for="averageSelector">Base</label>
                <select id="averageSelector">
                    <option value="19">20</option>
                    <option value="39">40</option>
                    <option value="59">60</option>
                    <option value="79">80</option>
                    <option value="99">100</option>
                    <option value="119">120</option>
                </select>
            </div>

            <div class="checkbox-container">
                <input type="checkbox" id="fibonacciToggle">
                <label for="fibonacciToggle">Ativar Fibonacci</label>
            </div>

            <div class="checkbox-container">
                <input type="checkbox" id="dataLabelsToggle">
                <label for="dataLabelsToggle">Ativar Rótulos</label>
            </div>
        </div>

        <!-- Botões para seleção de ligas -->
        <div class="league-buttons">
            <button class="league-btn active" data-league="CopaAmerica">Copa América</button>
            <button class="league-btn active" data-league="TacaGloria">Taça Glória Eterna</button>
            <button class="league-btn active" data-league="Euro">Euro</button>
            <button class="league-btn active" data-league="CampeonatoItaliano">Campeonato Italiano</button>
            <button class="league-btn active" data-league="CopaEstrelas">Copa das Estrelas</button>
            <button class="league-btn active" data-league="brasileirao">Brasileirão Betano</button>
        </div>

        <!-- Container único para o gráfico -->
        <div class="chart-container">
            <h2 id="chartTitle">Gols FT</h2>
            <canvas id="golsFTChart" width="400" height="130"></canvas>
        </div>

        <script>
            fetch('header.html')
              .then(response => response.text())
              .then(data => {
                document.getElementById('header').innerHTML = data;
              });
        </script>
        <script src="redirecionar.js"></script>
        
        <script>
            // Bloqueia o menu de contexto (clique direito)
            document.addEventListener("contextmenu", function(e) {
                e.preventDefault();
            });

            // Bloqueia atalhos de teclado comuns para ferramentas de desenvolvimento
            document.addEventListener("keydown", function(e) {
                if (e.key === "F12") e.preventDefault();
                if (e.ctrlKey && e.shiftKey && e.key === "I") e.preventDefault();
                if (e.ctrlKey && e.key === "u") e.preventDefault();
                if (e.ctrlKey && e.shiftKey && e.key === "J") e.preventDefault();
                if (e.ctrlKey && e.shiftKey && e.key === "C") e.preventDefault();
                if (e.ctrlKey && e.key === "s") e.preventDefault();
                if (e.ctrlKey && e.key === "p") e.preventDefault();
            });

            // Detecta abertura de ferramentas de desenvolvimento
            const devtools = { open: false };
            const element = new Image();
            Object.defineProperty(element, 'id', {
                get: function () {
                    devtools.open = true;
                }
            });

            // Adiciona detecção alternativa de devtools
            (function() {
                const threshold = 160;
                const checkDevTools = function() {
                    if ((window.outerWidth - window.innerWidth) > threshold || 
                        (window.outerHeight - window.innerHeight) > threshold) {
                        devtools.open = true;
                    }
                };
                
                window.addEventListener('resize', checkDevTools);
                setInterval(checkDevTools, 500);
            })();

            // Monitoramento contínuo
            console.log('%c', element);
            setInterval(function() {
                if (devtools.open) {
                    document.body.innerHTML = '<h1>Acesso não autorizado detectado</h1>';
                    devtools.open = false;
                }
            }, 1000);

            // Impede seleção de texto
            document.addEventListener('selectstart', function(e) {
                e.preventDefault();
            });

            // Impede arrastar e soltar
            document.addEventListener('dragstart', function(e) {
                e.preventDefault();
            });

            // Ofusca console
            console.log = function() {};
            console.debug = function() {};
            console.info = function() {};
        </script>
        
        <script>
            let golsFTChart;
            let numPoints = 20;
            let averagePoints = 19;
            let showFibonacciLines = false;
            let showDataLabels = false;
            
            const leagues = ['CopaAmerica', 'TacaGloria', 'Euro', 'CampeonatoItaliano', 'CopaEstrelas', 'brasileirao'];
            let chartData = {};
            
            const leagueColors = {
                'CopaAmerica': '#FF6B6B',
                'TacaGloria': '#4ECDC4',
                'Euro': '#45B7D1',
                'CampeonatoItaliano': '#96CEB4',
                'CopaEstrelas': '#FECA57',
                'brasileirao': '#FF9FF3'
            };

            const leagueNames = {
                'CopaAmerica': 'Copa América',
                'TacaGloria': 'Taça Glória Eterna',
                'Euro': 'Euro',
                'CampeonatoItaliano': 'Campeonato Italiano',
                'CopaEstrelas': 'Copa das Estrelas',
                'brasileirao': 'Brasileirão Betano'
            };

            // Controla a visibilidade dos datasets
            const visibleDatasets = {
                'CopaAmerica': true,
                'TacaGloria': true,
                'Euro': true,
                'CampeonatoItaliano': true,
                'CopaEstrelas': true,
                'brasileirao': true
            };

            function formatHtResult(ht) {
                if (ht === 'OUT') return 'OUT';
                if (ht && ht.includes(' x ')) {
                    const parts = ht.split(' x ');
                    if (parts.length === 2) {
                        return `${parts[0]}-${parts[1]}`;
                    }
                }
                return ht;
            }

            function processApiData(data, league) {
                const sortedData = [...data].sort((a, b) => {
                    const dateA = new Date(a.data);
                    const dateB = new Date(b.data);
                    if (dateA.getTime() !== dateB.getTime()) return dateA - dateB;
                    if (a.hora !== b.hora) return a.hora - b.hora;
                    return a.minuto - b.minuto;
                });

                const slicedData = sortedData.slice(-numPoints - averagePoints);
                chartData[league] = slicedData;

                let labels = [];
                let golsFT = [];

                function hasGap(prevMatch, currMatch) {
                    const prevTime = new Date(prevMatch.data + 'T' + prevMatch.hora + ':' + prevMatch.minuto + ':00');
                    const currTime = new Date(currMatch.data + 'T' + currMatch.hora + ':' + currMatch.minuto + ':00');
                    const diffMinutes = (currTime - prevTime) / (1000 * 60);
                    return diffMinutes > 1;
                }

                for (let i = averagePoints; i < slicedData.length; i++) {
                    let golsFTSum = 0;
                    let validMatches = 0;

                    for (let j = Math.max(0, i - averagePoints); j <= i; j++) {
                        const match = slicedData[j];
                        const ftScore = match.ft;

                        if (j > 0 && hasGap(slicedData[j - 1], match)) {
                            labels.push(`${match.hora}:${match.minuto.toString().padStart(2, '0')}`);
                            golsFT.push(null);
                            continue;
                        }

                        let ftScoreParts = [0, 0];
                        if (ftScore && ftScore.includes(' x ')) {
                            ftScoreParts = ftScore.split(' x ').map(num => parseInt(num, 10));
                        }

                        const totalGolsFT = ftScoreParts[0] + ftScoreParts[1];
                        golsFTSum += totalGolsFT;
                        validMatches++;
                    }

                    const match = slicedData[i];
                    labels.push(`${match.hora}:${match.minuto.toString().padStart(2, '0')}`);
                    golsFT.push(golsFTSum);
                }

                return { labels, golsFT };
            }

            Chart.register(ChartDataLabels);

            const fibonacciLinesPlugin = {
                id: 'fibonacciLines',
                afterDraw: (chart) => {
                    if (!showFibonacciLines) return;
                    const ctx = chart.ctx;
                    const yAxis = chart.scales.y;
                    const fibonacciLevels = [0, 23.6, 38.2, 50, 61.8, 100];
                    const yMin = yAxis.min;
                    const yMax = yAxis.max;
                    const range = yMax - yMin;
                    const normalizedLevels = fibonacciLevels.map(level => yMin + (level / 100) * range);

                    ctx.save();
                    normalizedLevels.forEach((level, index) => {
                        const y = yAxis.getPixelForValue(level);
                        ctx.beginPath();
                        ctx.moveTo(chart.chartArea.left, y);
                        ctx.lineTo(chart.chartArea.right, y);
                        ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)';
                        ctx.lineWidth = 1;
                        ctx.stroke();
                        ctx.fillStyle = '#b0b0b0';
                        ctx.font = '11px Arial';
                        ctx.textAlign = 'left';
                        const textY = y - (index === 0 ? -10 : 5);
                        const textX = chart.chartArea.right + 10;
                        ctx.fillText(`${fibonacciLevels[index]}%`, textX, textY);
                    });
                    ctx.restore();
                }
            };

            function createGolsFTChart() {
                const ctx = document.getElementById('golsFTChart').getContext('2d');
                
                golsFTChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: []
                    },
                    options: {
                        responsive: true,
                        layout: { 
                            padding: { 
                                top: 30,
                                right: 50
                            } 
                        },
                        plugins: {
                            legend: {
                                display: true,
                                labels: { color: '#e0e0e0', font: { size: 12 } },
                                onClick: function(e, legendItem, legend) {
                                    const datasetIndex = legendItem.datasetIndex;
                                    const ci = legend.chart;
                                    const meta = ci.getDatasetMeta(datasetIndex);
                                    meta.hidden = !meta.hidden;
                                    visibleDatasets[legendItem.text] = !meta.hidden;
                                    ci.update('none');
                                }
                            },
                            datalabels: {
                                display: showDataLabels,
                                color: '#e0e0e0',
                                font: { size: 10 },
                                formatter: (value) => value ? Math.round(value) : '',
                                anchor: 'end',
                                align: 'top',
                                offset: 1
                            },
                            tooltip: {
                                enabled: true,
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: '#1fad8b',
                                bodyColor: '#e0e0e0',
                                borderColor: '#1fad8b',
                                borderWidth: 1,
                                callbacks: {
                                    title: function(tooltipItems) {
                                        const datasetIndex = tooltipItems[0].datasetIndex;
                                        const pointIndex = tooltipItems[0].dataIndex;
                                        const league = golsFTChart.data.datasets[datasetIndex].leagueKey;
                                        const index = pointIndex + averagePoints;
                                        const match = chartData[league][index];
                                        return match ? `${leagueNames[league]} - ${match.hora}:${match.minuto.toString().padStart(2, '0')}` : '';
                                    },
                                    label: function(tooltipItem) {
                                        const league = tooltipItem.dataset.leagueKey;
                                        const index = tooltipItem.dataIndex + averagePoints;
                                        const match = chartData[league] && chartData[league][index];
                                        if (!match) return '';
                                        
                                        const ftScore = match.ft || 'N/A';
                                        const htScore = formatHtResult(match.ht) || 'N/A';
                                        return [
                                            `FT: ${ftScore}`,
                                            `HT: ${htScore}`,
                                            `Gols FT: ${Math.round(tooltipItem.raw)} gols`
                                        ];
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: { display: false },
                                ticks: { color: '#b0b0b0', maxRotation: 45, minRotation: 45 },
                                grid: { display: false }
                            },
                            y: {
                                title: { display: true, text: '', color: '#1fad8b', font: { size: 14 } },
                                beginAtZero: false,
                                ticks: { 
                                    color: '#b0b0b0',
                                    stepSize: 5
                                },
                                grid: { color: 'rgba(255, 255, 255, 0.3)', borderDash: [], lineWidth: 0.5 },
                                afterFit: function(scale) { scale.paddingTop = 20; }
                            }
                        }
                    },
                    plugins: [ChartDataLabels, fibonacciLinesPlugin]
                });
            }

            function updateChart() {
                if (!golsFTChart) return;

                let allLabels = [];
                const datasets = leagues.map(league => {
                    if (chartData[league] && chartData[league].length > 0 && visibleDatasets[league]) {
                        const processedData = processApiData(chartData[league], league);
                        if (allLabels.length === 0) {
                            allLabels = processedData.labels;
                        }
                        return {
                            label: leagueNames[league],
                            data: processedData.golsFT,
                            borderColor: leagueColors[league],
                            backgroundColor: leagueColors[league],
                            borderWidth: 2,
                            pointRadius: 4,
                            pointBackgroundColor: leagueColors[league],
                            fill: false,
                            leagueKey: league,
                            hidden: !visibleDatasets[league]
                        };
                    }
                    return null;
                }).filter(dataset => dataset !== null);

                golsFTChart.data.labels = allLabels;
                golsFTChart.data.datasets = datasets;
                document.getElementById('chartTitle').textContent = 'Gols FT';
                golsFTChart.update('none');
            }

            function updateCharts() {
                const timestamp = new Date().getTime();
                const leagueUrls = {
                    'CopaAmerica': 'https://betstat.site/resultados/Copa%20America',
                    'TacaGloria': 'https://betstat.site/resultados/Ta%C3%A7a%20Gl%C3%B3ria%20eterna',
                    'Euro': 'https://betstat.site/resultados/Euro',
                    'CampeonatoItaliano': 'https://betstat.site/resultados/Campeonato%20Italiano',
                    'CopaEstrelas': 'https://betstat.site/resultados/Copa%20das%20estrelas',
                    'brasileirao': 'https://betstat.site/resultados/Brasileir%C3%A3o%20Betano',
                };

                const fetchPromises = leagues.map(league => {
                    const apiUrl = `${leagueUrls[league]}?timestamp=${timestamp}`;
                    return fetch(apiUrl)
                        .then(response => {
                            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                            return response.json();
                        })
                        .then(data => {
                            chartData[league] = data;
                        })
                        .catch(error => {
                            console.error(`Erro ao buscar dados para ${league}:`, error);
                        });
                });

                Promise.all(fetchPromises).then(() => {
                    updateChart();
                });
            }

            function toggleFibonacciLines() {
                showFibonacciLines = document.getElementById('fibonacciToggle').checked;
                if (golsFTChart) golsFTChart.update();
            }

            function toggleDataLabels() {
                showDataLabels = document.getElementById('dataLabelsToggle').checked;
                if (golsFTChart) {
                    golsFTChart.options.plugins.datalabels.display = showDataLabels;
                    golsFTChart.update();
                }
            }

            // Event listeners para botões de liga
            document.querySelectorAll('.league-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const league = this.dataset.league;
                    visibleDatasets[league] = !visibleDatasets[league];
                    if (visibleDatasets[league]) {
                        this.classList.add('active');
                    } else {
                        this.classList.remove('active');
                    }
                    updateChart();
                });
            });

            document.getElementById('pointsSelector').addEventListener('change', function(event) {
                numPoints = parseInt(event.target.value, 10);
                updateCharts();
            });

            document.getElementById('averageSelector').addEventListener('change', function(event) {
                averagePoints = parseInt(event.target.value, 10);
                updateCharts();
            });

            document.getElementById('fibonacciToggle').addEventListener('change', toggleFibonacciLines);
            document.getElementById('dataLabelsToggle').addEventListener('change', toggleDataLabels);

            // Inicialização
            window.onload = function() {
                createGolsFTChart();
                updateCharts();
            };
            
            setInterval(updateCharts, 3000);
        </script>
    </body>
</html>