<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script> 
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WT805FFHQ"></script>    
        <title>BetStat</title>
                    <!-- Meta tags SEO principais -->
    <meta name="description" content="Transforme suas apostas com BetStat - a única plataforma especializada em futebol virtual Betano. Análises precisas, estatísticas confiáveis e resultados comprovados para investimentos inteligentes.">
    <meta name="keywords" content="BetStat, apostas esportivas, futebol virtual, Betano, estatísticas apostas, análise apostas, investimentos esportivos">
    
    <!-- Open Graph meta tags para redes sociais -->
    <meta property="og:title" content="BetStat | Plataforma de Análise para Apostas Esportivas">
    <meta property="og:description" content="Transforme suas apostas com análises precisas e estatísticas confiáveis. A única plataforma especializada em futebol virtual Betano.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.betstat.site/payment.html">
    <meta property="og:site_name" content="BetStat">
    
    <!-- Meta tags adicionais -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="BetStat">
    <meta name="canonical" href="https://www.betstat.site/payment.html">
    <script type="module" src="js/firebase-auth.js"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
    
            gtag('config', 'G-4WT805FFHQ');
        </script>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
        
    </head>

    <style>

body {
      font-family: "Roboto", Arial, sans-serif;
      margin: 30px;
      background-color: #1c1f26;
      color: #ffffff;
    }

    .logo2 {
  width: 60px;      /* define a largura fixa */
  height: auto;     /* mantém a proporção da imagem */
}

    .espaco {
  width: 50px;  /* Largura da div */
  height: 50px;  /* Altura da div */
}


    option:hover {
      background-color: #ff8000;
      color: #ffffff;
    }

    canvas {
    cursor: pointer;
}

    button {
      background-color: #1c1f26;
      color: rgb(255, 255, 255);
      font-family: "Roboto", Arial, sans-serif;
      border: none;
      padding: 5px 8px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
      margin: 10px;
    }

    button:hover {
      background-color: #0f1013;
    }

    option {
      background-color: #1c1f26;
      color: #ffffff;
    }

    select {
      width: 100%;
      padding: 5px;
      border-radius: 5px;
      background-color: #1c1f26;
      color: #ffffff;
      font-family: "Roboto", Arial, sans-serif;
      font-size: 14px;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    header {
        background: #005540;
      width: 100vw;
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      height: 60px;
    }

    .header-container {
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      padding: 0 20px;
      justify-content: space-between;
      gap: 20px
    }

    .logo {
      height: 30px;
    }

    .selectors-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-seletor {
      display: flex;
      align-items: center;
      color: #ffffff;
      font-weight: 500;
    }

    .nav-seletor select {
      padding: 0.5rem ;
      border-radius: 6px;
      background-color: #1c1f26;
      color: var(--text-color);
      border: 1px solid #ffffff9f;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .logout-btn {
      background-color: #1c1f26;; /* Fundo vermelho */
      color: white; /* Texto branco */
      padding: 8px 10px; /* Espaçamento interno */
      font-size: 14px; /* Tamanho da fonte */
      border-radius: 5px; /* Cantos arredondados */
      cursor: pointer; /* Cursor de botão */
      border: 1px solid #ffffff81;
    }

    .logout-btn:hover {
      background-color: #720000; /* Cor ao passar o mouse */
    }

    .selectors-wrapper {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .selector-container {
            padding: 10px;
            background-color: #252932;
            border-radius: 5px;
            flex: 1;
        }

        .selector-container label {
            margin-right: 10px;
            font-weight: 500;
            color: #e0e0e0;
        }

        .selector-container select {
            padding: 6px 10px;
            background-color: #2d323d;
            color: #e0e0e0;
            border: 1px solid #3a404d;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            width: 100%;
            box-sizing: border-box;
        }

        .current-hour-container {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #252932;
            border-radius: 5px;
        }

        .current-hour-table {
            width: 100%;
            border-radius: 5px;
            background-color: #252932;
            color: #e0e0e0;
            table-layout: fixed;
        }

        .current-hour-table th, 
        .current-hour-table td {
            width: 40px;
            height: 20px;
            padding: 0;
            text-align: center;
            font-size: 13px;
            border: 1px solid #3a404d;
         border-radius: 5px;
            box-sizing: border-box;
            position: relative;
            cursor: pointer;
        }

        .current-hour-table th {
            background-color: #2d323d;
            font-weight: 500;
            color: #ffffff;
        }

        .current-hour-table td:first-child,
        .current-hour-table th:first-child {
            background-color: #2a2e38;
            font-weight: 500;
            color: #ffffff;
        }

        .maxima-hora-minuto-table-container {
            padding: 10px;
            background-color: #1c1f26;
            border-radius: 5px;
        }

        .maxima-hora-minuto-table {
            width: 100%;
            border-radius: 5px;
            background-color: #252932;
            color: #e0e0e0;
            table-layout: fixed;
        }

        .maxima-hora-minuto-table th, 
        .maxima-hora-minuto-table td {
            width: 40px;
            height: 20px;
            padding: 0;
            border: 1px solid #3a404d;
            text-align: center;
            font-size: 13px;
            box-sizing: border-box;
            position: relative;
            cursor: pointer;
         border-radius: 5px;
        }

        .maxima-hora-minuto-table th {
            background-color: #2d323d;
            font-weight: 500;
            color: #ffffff;
        }

        .maxima-hora-minuto-table td:first-child,
        .maxima-hora-minuto-table th:first-child {
            background-color: #2a2e38;
            font-weight: 500;
            color: #ffffff;
          border-radius: 5px;
        }

        /* Estilo do tooltip */
        td:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 10;
        }

        /* Classes de cor ajustadas */
        .percent-maxima {
            background-color: #560000;
            color: #ffffff;
            position: relative;
        }

        .percent-maxima::before {
            content: '';
            display: block;
            width: 8px;
            height: 8px;
            background-color: #ffffff;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .percent-0 {
            background-color: #005540;
            color: #ffffff;
            position: relative;
        }

        .percent-0::before {
            content: '';
            display: block;
            width: 8px;
            height: 8px;
            background-color: #ffffff;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .percent-low {
            background-color: #7a0000;
            color: #ffffff;
            position: relative;
        }

        .percent-low::before {
            content: '';
            display: block;
            width: 8px;
            height: 8px;
            background-color: #ffffff;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: blink 1s infinite;
        }

        /* Estilo da mensagem de chance de máxima */
        #chance-maxima-message {
            margin-top: 10px;
            padding: 10px;
            background-color: #252932;
            color: #e0e0e0;
            border-radius: 5px;
            text-align: center;
        }

        /* Estilo para destacar células com próximos jogos */
        .next-game-high {
            border: 2px solid #ffeb3b; /* Amarelo para alta probabilidade */
        }
        .next-game-low {
            border: 2px solid #2196f3; /* Azul para baixa probabilidade */
        }


    </style>
    
<body>
  <body>
    <div id="header"></div>
    <br>
<br>
<br>

<!-- Container para os seletores -->
<div class="selectors-wrapper">
    <!-- Seletor de Ligas -->
    <div class="selector-container">
        <label for="liga-selector">Selecione a Liga: </label>
        <select id="liga-selector" onchange="fetchMaximaPorHoraMinuto()">
            <option value="England">England</option>
            <option value="Italy">Italy</option>
            <option value="Spain">Spain</option>
        </select>
    </div>

<!-- Seletor de Mercados -->
<div class="selector-container">
    <label for="mercado-selector">Selecione o Mercado: </label>
    <select id="mercado-selector" onchange="fetchMaximaPorHoraMinuto()">
        <option value="Ambas Sim">Ambas Sim</option>
        <option value="Ambas Não">Ambas Não</option>
        <option value="Casa Vence">Casa Vence</option>
        <option value="Fora Vence">Fora Vence</option>
        <option value="Empate">Empate</option>
        <option value="Over 1.5">Over 1.5</option>
        <option value="Under 1.5">Under 1.5</option>
        <option value="Over 2.5" selected>Over 2.5</option>
        <option value="Under 2.5">Under 2.5</option>
        <option value="Over 3.5">Over 3.5</option>
        <option value="Under 3.5">Under 3.5</option>
        <option value="5 ou Mais Gols">5 ou Mais Gols</option>
    </select>
</div>


    <!-- Checkbox para ativar/desativar o filtro de times -->
    <div class="selector-container">
        <label for="team-filter">Desative para usar o filtro de times: </label>
        <input type="checkbox" id="team-filter" onchange="fetchMaximaPorHoraMinuto()" checked>
    </div>
</div>

<!-- Mensagem de chance de máxima -->
<div id="chance-maxima-message"></div>

<!-- Linha da hora atual -->
<div class="current-hour-container">
    <table class="current-hour-table" id="current-hour-tabela">
        <thead>
            <tr id="current-hour-header"></tr>
        </thead>
        <tbody id="current-hour-resultados"></tbody>
    </table>
</div>

<!-- Tabela completa -->
<div class="maxima-hora-minuto-table-container">
    <table class="maxima-hora-minuto-table" id="maxima-hora-minuto-tabela">
        <thead>
            <tr id="maxima-hora-minuto-header"></tr>
        </thead>
        <tbody id="maxima-hora-minuto-resultados"></tbody>
    </table>
</div>

    <script>
        fetch('header.html')
          .then(response => response.text())
          .then(data => {
            document.getElementById('header').innerHTML = data;
          });
      </script>
      <script src="redirecionar.js"></script>
    


    
    <script>
console.log = function() {};
console.debug = function() {};
console.info = function() {};

// Armazena referências das células para evitar recriação
let currentHourCells = {};
let tableCells = {};
let isFirstRun = true;

// Armazena estatísticas dos times
let teamStats = {};

// Mapeamento das ligas para nomes completos e rotas de próximos jogos
const ligaDisplayNames = {
    "England": "England",
    "Italy": "Italy",
    "Spain": "Spain",
};

const ligaToProximosMap = {
    "England": "England",
    "Italy": "Italy",
    "Spain": "Spain",
};

// Função para determinar o mercado contrário
function getOppositeMarket(mercado) {
    const opposites = {
        "Ambas Sim": "Ambas Não",
        "Ambas Não": "Ambas Sim",
        "Casa Vence": "Fora Vence",
        "Fora Vence": "Casa Vence",
        "Empate": "Casa Vence",
        "Over 1.5": "Under 1.5",
        "Under 1.5": "Over 1.5",
        "Over 2.5": "Under 2.5",
        "Under 2.5": "Over 2.5",
        "Over 3.5": "Under 3.5",
        "Under 3.5": "Over 3.5",
        "5 ou Mais Gols": "Under 3.5"
    };
    return opposites[mercado] || mercado;
}

// Função para buscar os próximos jogos
async function fetchNextGames(liga) {
    const proximosPath = ligaToProximosMap[liga];
    if (!proximosPath) return [];

    const url = `https://betstat.site/proximos/kiron/${proximosPath}`;
    try {
        const response = await fetch(url);
        const data = await response.json();
        return data || [];
    } catch (error) {
        console.error("Erro ao buscar próximos jogos:", error);
        return [];
    }
}

async function fetchMaximaPorHoraMinuto() {
    try {
        const selectedLiga = document.getElementById("liga-selector").value;
        const displayLiga = ligaDisplayNames[selectedLiga] || selectedLiga;
        const response = await fetch(`https://betstat.site/resultados/kiron/${selectedLiga}`);
        const data = await response.json();
        const recentData = data.slice(-1920);

        const selectedMercado = document.getElementById("mercado-selector").value;
        const oppositeMercado = getOppositeMarket(selectedMercado);
        const useTeamFilter = document.getElementById("team-filter").checked;

        // Busca os próximos jogos
        const nextGames = await fetchNextGames(selectedLiga);

        // Inicializa as estatísticas dos times
        teamStats = {};

        // Calcula estatísticas dos times
        recentData.forEach(jogo => {
            const timeA = jogo.time_a;
            const timeB = jogo.time_b;
            const [golCasa, golFora] = jogo.ft.split(" x ").map(Number);

            const condicoes = {
                "Ambas Sim": golCasa > 0 && golFora > 0,
                "Ambas Não": golCasa === 0 || golFora === 0,
                "Casa Vence": golCasa > golFora,
                "Fora Vence": golFora > golCasa,
                "Empate": golCasa === golFora,
                "Over 1.5": golCasa + golFora > 1.5,
                "Under 1.5": golCasa + golFora <= 1.5,
                "Over 2.5": golCasa + golFora > 2.5,
                "Under 2.5": golCasa + golFora <= 2.5,
                "Over 3.5": golCasa + golFora > 3.5,
                "Under 3.5": golCasa + golFora <= 3.5,
                "5 ou Mais Gols": golCasa + golFora >= 5,
            };

            if (!teamStats[timeA]) {
                teamStats[timeA] = { games: 0, markets: {}, oppositeMarkets: {} };
            }
            if (!teamStats[timeB]) {
                teamStats[timeB] = { games: 0, markets: {}, oppositeMarkets: {} };
            }

            teamStats[timeA].games += 1;
            teamStats[timeB].games += 1;

            if (!teamStats[timeA].markets[selectedMercado]) {
                teamStats[timeA].markets[selectedMercado] = 0;
            }
            if (!teamStats[timeB].markets[selectedMercado]) {
                teamStats[timeB].markets[selectedMercado] = 0;
            }
            if (!teamStats[timeA].oppositeMarkets[oppositeMercado]) {
                teamStats[timeA].oppositeMarkets[oppositeMercado] = 0;
            }
            if (!teamStats[timeB].oppositeMarkets[oppositeMercado]) {
                teamStats[timeB].oppositeMarkets[oppositeMercado] = 0;
            }

            if (condicoes[selectedMercado]) {
                teamStats[timeA].markets[selectedMercado] += 1;
                teamStats[timeB].markets[selectedMercado] += 1;
            }
            if (condicoes[oppositeMercado]) {
                teamStats[timeA].oppositeMarkets[oppositeMercado] += 1;
                teamStats[timeB].oppositeMarkets[oppositeMercado] += 1;
            }
        });

        // Obtém minutos únicos da liga selecionada
        const uniqueMinutes = [...new Set(recentData.map(game => parseInt(game.minuto, 10)))].sort((a, b) => a - b);

        const resultsByHourMinute = {};
        for (let h = 0; h < 24; h++) {
            const hour = String(h).padStart(2, "0");
            resultsByHourMinute[hour] = {};
            uniqueMinutes.forEach(minute => {
                const minuteStr = String(minute).padStart(2, "0");
                resultsByHourMinute[hour][minuteStr] = {
                    totalGames: 0,
                    maximaStarts: 0,
                    teamWeights: [],
                    nextGameWeight: null
                };
            });
        }

        let sequenciaAtual = 0;
        let inicioSequencia = null;

        for (let i = 0; i < recentData.length; i++) {
            const jogo = recentData[i];
            const hora = String(jogo.hora).padStart(2, "0");
            const minuto = String(jogo.minuto).padStart(2, "0");
            const timeA = jogo.time_a;
            const timeB = jogo.time_b;

            if (!resultsByHourMinute[hora] || !resultsByHourMinute[hora][minuto]) continue;

            resultsByHourMinute[hora][minuto].totalGames += 1;

            const [golCasa, golFora] = jogo.ft.split(" x ").map(Number);
            const condicoes = {
                "Ambas Sim": golCasa > 0 && golFora > 0,
                "Ambas Não": golCasa === 0 || golFora === 0,
                "Casa Vence": golCasa > golFora,
                "Fora Vence": golFora > golCasa,
                "Empate": golCasa === golFora,
                "Over 1.5": golCasa + golFora > 1.5,
                "Under 1.5": golCasa + golFora <= 1.5,
                "Over 2.5": golCasa + golFora > 2.5,
                "Under 2.5": golCasa + golFora <= 2.5,
                "Over 3.5": golCasa + golFora > 3.5,
                "Under 3.5": golCasa + golFora <= 3.5,
                "5 ou Mais Gols": golCasa + golFora >= 5,
            };

            const mercadoOcorreu = condicoes[selectedMercado];

            let teamWeight = 0;
            if (useTeamFilter) {
                const timeAStats = teamStats[timeA] || { games: 0, markets: { [selectedMercado]: 0 }, oppositeMarkets: { [oppositeMercado]: 0 } };
                const timeBStats = teamStats[timeB] || { games: 0, markets: { [selectedMercado]: 0 }, oppositeMarkets: { [oppositeMercado]: 0 } };

                const timeAFailRate = timeAStats.games > 0 ? 1 - (timeAStats.markets[selectedMercado] / timeAStats.games) : 0;
                const timeBFailRate = timeBStats.games > 0 ? 1 - (timeBStats.markets[selectedMercado] / timeBStats.games) : 0;
                const timeAOppositeRate = timeAStats.games > 0 ? (timeAStats.oppositeMarkets[oppositeMercado] / timeAStats.games) : 0;
                const timeBOppositeRate = timeBStats.games > 0 ? (timeBStats.oppositeMarkets[oppositeMercado] / timeBStats.games) : 0;

                teamWeight = (timeAFailRate + timeBFailRate + timeAOppositeRate + timeBOppositeRate) / 4;
                resultsByHourMinute[hora][minuto].teamWeights.push(teamWeight);
            }

            if (!mercadoOcorreu) {
                if (sequenciaAtual === 0) {
                    inicioSequencia = { hora, minuto };
                }
                sequenciaAtual++;
            } else {
                if (sequenciaAtual >= 4 && inicioSequencia) {
                    const { hora: inicioHora, minuto: inicioMinuto } = inicioSequencia;
                    if (useTeamFilter) {
                        const avgTeamWeight = resultsByHourMinute[inicioHora][inicioMinuto].teamWeights.reduce((a, b) => a + b, 0) / (resultsByHourMinute[inicioHora][inicioMinuto].teamWeights.length || 1);
                        if (avgTeamWeight > 0.5) {
                            resultsByHourMinute[inicioHora][inicioMinuto].maximaStarts += 1;
                        }
                    } else {
                        resultsByHourMinute[inicioHora][inicioMinuto].maximaStarts += 1;
                    }
                }
                sequenciaAtual = 0;
                inicioSequencia = null;
            }
        }

        if (sequenciaAtual >= 5 && inicioSequencia) {
            const { hora: inicioHora, minuto: inicioMinuto } = inicioSequencia;
            if (useTeamFilter) {
                const avgTeamWeight = resultsByHourMinute[inicioHora][inicioMinuto].teamWeights.reduce((a, b) => a + b, 0) / (resultsByHourMinute[inicioHora][inicioMinuto].teamWeights.length || 1);
                if (avgTeamWeight > 0.5) {
                    resultsByHourMinute[inicioHora][inicioMinuto].maximaStarts += 1;
                }
            } else {
                resultsByHourMinute[inicioHora][inicioMinuto].maximaStarts += 1;
            }
        }

        // Calcula a probabilidade de máxima para os próximos jogos
        const nextGamesProbabilities = [];
        nextGames.forEach(game => {
            const [hour, minute] = game.time.split(":");
            const hora = String(hour).padStart(2, "0");
            const minuto = String(minute).padStart(2, "0");

            const timeA = game.team_home;
            const timeB = game.team_visit;

            const timeAStats = teamStats[timeA] || { games: 0, markets: { [selectedMercado]: 0 }, oppositeMarkets: { [oppositeMercado]: 0 } };
            const timeBStats = teamStats[timeB] || { games: 0, markets: { [selectedMercado]: 0 }, oppositeMarkets: { [oppositeMercado]: 0 } };

            const timeAFailRate = timeAStats.games > 0 ? 1 - (timeAStats.markets[selectedMercado] / timeAStats.games) : 0;
            const timeBFailRate = timeBStats.games > 0 ? 1 - (timeBStats.markets[selectedMercado] / timeBStats.games) : 0;
            const timeAOppositeRate = timeAStats.games > 0 ? (timeAStats.oppositeMarkets[oppositeMercado] / timeAStats.games) : 0;
            const timeBOppositeRate = timeBStats.games > 0 ? (timeBStats.oppositeMarkets[oppositeMercado] / timeBStats.games) : 0;

            const teamWeight = (timeAFailRate + timeBFailRate + timeAOppositeRate + timeBOppositeRate) / 4;

            if (resultsByHourMinute[hora] && resultsByHourMinute[hora][minuto]) {
                resultsByHourMinute[hora][minuto].nextGameWeight = teamWeight;
            }

            nextGamesProbabilities.push({
                time: game.time,
                teamWeight: teamWeight
            });
        });

        const tableHeader = document.getElementById("maxima-hora-minuto-header");
        const currentHourHeader = document.getElementById("current-hour-header");
        const now = new Date();
        const currentHour = String(now.getHours()).padStart(2, "0");
        const currentMinute = String(now.getMinutes()).padStart(2, "0");

        // Reconstrói a tabela toda vez que a liga muda para refletir os minutos únicos
        let headerRow = "<th>H</th>";
        uniqueMinutes.forEach(minute => {
            const minuteStr = String(minute).padStart(2, "0");
            headerRow += `<th>${minuteStr}</th>`;
        });
        tableHeader.innerHTML = headerRow;
        currentHourHeader.innerHTML = headerRow;

        const currentHourBody = document.getElementById("current-hour-resultados");
        currentHourBody.innerHTML = "";
        const currentRow = document.createElement("tr");
        const currentHourCell = document.createElement("td");
        currentHourCell.textContent = currentHour;
        currentRow.appendChild(currentHourCell);

        currentHourCells = {};
        uniqueMinutes.forEach(minute => {
            const minuteStr = String(minute).padStart(2, "0");
            const cell = document.createElement("td");
            cell.style.height = "30px"; // Altura reduzida das células
            cell.setAttribute("data-tooltip", `${currentHour}:${minuteStr}`);
            currentRow.appendChild(cell);
            currentHourCells[minuteStr] = cell;
        });
        currentHourBody.appendChild(currentRow);

        const resultsBody = document.getElementById("maxima-hora-minuto-resultados");
        resultsBody.innerHTML = "";
        tableCells = {};
        for (let h = 23; h >= 0; h--) {
            const hour = String(h).padStart(2, "0");
            const row = document.createElement("tr");
            const hourCell = document.createElement("td");
            hourCell.textContent = hour;
            row.appendChild(hourCell);

            tableCells[hour] = {};
            uniqueMinutes.forEach(minute => {
                const minuteStr = String(minute).padStart(2, "0");
                const cell = document.createElement("td");
                cell.style.height = "30px"; // Altura reduzida das células
                cell.setAttribute("data-tooltip", `${hour}:${minuteStr}`);
                row.appendChild(cell);
                tableCells[hour][minuteStr] = cell;
            });
            resultsBody.appendChild(row);
        }

        // Atualiza os dados
        let hasMaximaChance = false;
        let maximaMinutes = [];

        // Atualiza a hora atual (linha destacada)
        currentHourBody.querySelector("td").textContent = currentHour;

        uniqueMinutes.forEach(minute => {
            const minuteStr = String(minute).padStart(2, "0");
            const data = resultsByHourMinute[currentHour][minuteStr];
            const percentage = data.totalGames > 0
                ? ((data.maximaStarts / data.totalGames) * 100).toFixed(2)
                : "0.00";

            const cell = currentHourCells[minuteStr];
            if (cell) {
                cell.textContent = "";
                if (percentage == 100) {
                    cell.className = "percent-maxima";
                    hasMaximaChance = true;
                    maximaMinutes.push(minuteStr);
                } else if (percentage == 0) {
                    cell.className = "percent-0";
                } else {
                    cell.className = "percent-low";
                    hasMaximaChance = true;
                    maximaMinutes.push(minuteStr);
                }
                cell.setAttribute("data-tooltip", `${currentHour}:${minuteStr}`);
            }
        });

        // Atualiza todas as horas na tabela principal
        let nextGameMessage = "";
        for (let h = 23; h >= 0; h--) {
            const hour = String(h).padStart(2, "0");
            uniqueMinutes.forEach(minute => {
                const minuteStr = String(minute).padStart(2, "0");
                const data = resultsByHourMinute[hour][minuteStr];
                const percentage = data.totalGames > 0
                    ? ((data.maximaStarts / data.totalGames) * 100).toFixed(2)
                    : "0.00";

                const cell = tableCells[hour][minuteStr];
                if (cell) {
                    cell.textContent = "";
                    if (percentage == 100) {
                        cell.className = "percent-maxima";
                    } else if (percentage == 0) {
                        cell.className = "percent-0";
                    } else {
                        cell.className = "percent-low";
                    }

                    if (data.nextGameWeight !== null) {
                        if (data.nextGameWeight > 0.5) {
                            cell.classList.add("next-game-high");
                            cell.setAttribute("data-tooltip", `${hour}:${minuteStr} - Alta probabilidade de máxima`);
                        } else {
                            cell.classList.add("next-game-low");
                            cell.setAttribute("data-tooltip", `${hour}:${minuteStr} - Baixa probabilidade de máxima`);
                        }
                    }
                }
            });
        }

        // Mensagem de chance de máxima
        const messageDiv = document.getElementById("chance-maxima-message");
        const minutesText = maximaMinutes.length > 0 ? ` nos minutos ${maximaMinutes.join(", ")}` : "";
        if (hasMaximaChance) {
            messageDiv.innerHTML = `Possível chance de máxima às ${currentHour}h para o mercado "${selectedMercado}" ${minutesText}${nextGameMessage || ""}`;
            messageDiv.style.color = "#fff";
        } else {
            messageDiv.innerHTML = `Nenhuma chance de máxima detectada às ${currentHour}h .${nextGameMessage || ""}`;
            messageDiv.style.color = "#e0e0e0";
        }

    } catch (error) {
        console.error("Erro ao buscar os dados:", error);
    }
}

// Chama a função imediatamente ao carregar a página
fetchMaximaPorHoraMinuto();

// Configura a atualização a cada 5 minutos (300000 milissegundos)
setInterval(fetchMaximaPorHoraMinuto, 300000);
    </script>

</body>
</html>
